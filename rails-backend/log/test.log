  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "articles"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "articles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "slug" varchar, "body" text, "description" varchar, "favorites_count" integer, "user_id" integer, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_articles_on_slug" ON "articles" ("slug")[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE  INDEX "index_articles_on_user_id" ON "articles" ("user_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "comments"[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "body" text, "user_id" integer, "article_id" integer, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE  INDEX "index_comments_on_article_id" ON "comments" ("article_id")[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE  INDEX "index_comments_on_user_id" ON "comments" ("user_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "favorites"[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "favorites" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer, "article_id" integer, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE  INDEX "index_favorites_on_article_id" ON "favorites" ("article_id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE  INDEX "index_favorites_on_user_id" ON "favorites" ("user_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "follows"[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "follows" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "followable_type" varchar NOT NULL, "followable_id" integer NOT NULL, "follower_type" varchar NOT NULL, "follower_id" integer NOT NULL, "blocked" boolean DEFAULT 0 NOT NULL, "created_at" datetime, "updated_at" datetime)[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE  INDEX "fk_followables" ON "follows" ("followable_id", "followable_type")[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE  INDEX "fk_follows" ON "follows" ("follower_id", "follower_type")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "taggings"[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "taggings" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "tag_id" integer, "taggable_type" varchar, "taggable_id" integer, "tagger_type" varchar, "tagger_id" integer, "context" varchar(128), "created_at" datetime)[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE  INDEX "index_taggings_on_context" ON "taggings" ("context")[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "taggings_idx" ON "taggings" ("tag_id", "taggable_id", "taggable_type", "context", "tagger_id", "tagger_type")[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE  INDEX "index_taggings_on_tag_id" ON "taggings" ("tag_id")[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE  INDEX "index_taggings_on_taggable_id_and_taggable_type_and_context" ON "taggings" ("taggable_id", "taggable_type", "context")[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE  INDEX "taggings_idy" ON "taggings" ("taggable_id", "taggable_type", "tagger_id", "context")[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE  INDEX "index_taggings_on_taggable_id" ON "taggings" ("taggable_id")[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE  INDEX "index_taggings_on_taggable_type" ON "taggings" ("taggable_type")[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE  INDEX "index_taggings_on_tagger_id_and_tagger_type" ON "taggings" ("tagger_id", "tagger_type")[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE  INDEX "index_taggings_on_tagger_id" ON "taggings" ("tagger_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "tags"[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "tags" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "taggings_count" integer DEFAULT 0)[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_tags_on_name" ON "tags" ("name")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "email" varchar DEFAULT '' NOT NULL, "encrypted_password" varchar DEFAULT '' NOT NULL, "reset_password_token" varchar, "reset_password_sent_at" datetime, "remember_created_at" datetime, "sign_in_count" integer DEFAULT 0 NOT NULL, "current_sign_in_at" datetime, "last_sign_in_at" datetime, "current_sign_in_ip" varchar, "last_sign_in_ip" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "username" varchar, "image" varchar, "bio" text)[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_reset_password_token" ON "users" ("reset_password_token")[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_username" ON "users" ("username")[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20181015165120)[0m
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20160712045707),
(20160712054810),
(20160712061614),
(20160712061113),
(20160712054809),
(20160712054812),
(20160712045739),
(20160712055201),
(20160712052128),
(20160712054813),
(20160712054811);

[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["key", "environment"], ["value", "test"], ["created_at", "2018-11-28 20:10:55.335687"], ["updated_at", "2018-11-28 20:10:55.335687"]]
  [1m[35m (0.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$tyWdvDbIrZTlj7TngMm.sOP6.17SIi9ABJ.qyYm.zV7dbiIDybV.O"], ["created_at", "2018-11-28 20:10:55.677407"], ["updated_at", "2018-11-28 20:10:55.677407"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$rpDX45yzf3ELVHPwk6a0BuBwQZk3QUQYq/hrGhEepv5vnN66O.bsu"], ["created_at", "2018-11-28 20:10:55.720773"], ["updated_at", "2018-11-28 20:10:55.720773"], ["username", "person2"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-28 20:10:55.729899"], ["updated_at", "2018-11-28 20:10:55.729899"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-28 20:10:55.758640"], ["updated_at", "2018-11-28 20:10:55.758640"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-28 21:10:55 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 7ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$iSDmqpk0.0Jep8Hht.41Y.brJ/HS9R0T/shRQNIuvwor0UwgbBKte"], ["created_at", "2018-11-28 20:10:55.884189"], ["updated_at", "2018-11-28 20:10:55.884189"], ["username", "person3"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$T1iYsPyHoUQCNz4iw4mIguSPvLMlF9cHsd0Ma9e45srSbM11Zy1zu"], ["created_at", "2018-11-28 20:10:55.891878"], ["updated_at", "2018-11-28 20:10:55.891878"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-28 20:10:55.894686"], ["updated_at", "2018-11-28 20:10:55.894686"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.9ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-28 20:10:55.900141"], ["updated_at", "2018-11-28 20:10:55.900141"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-28 21:10:55 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$7M5.HgApGG7wwO.rcK4e.eEl5MrQT79mR9i1Xz6SHZ/VL/LjCddeK"], ["created_at", "2018-11-28 20:10:55.930860"], ["updated_at", "2018-11-28 20:10:55.930860"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$lEhJ3syGzhOzAYnOqznFSuEioKAR0LNM/DopXbh/73MT4HNHIDjja"], ["created_at", "2018-11-28 20:10:55.937136"], ["updated_at", "2018-11-28 20:10:55.937136"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$.LUbs/xviCSmq35b8Ir0UeC4ruhXlfrfLZlrnVCBwm03cScfr2o0m"], ["created_at", "2018-11-28 20:10:55.951362"], ["updated_at", "2018-11-28 20:10:55.951362"], ["username", "person7"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-28 20:10:55.958682"], ["updated_at", "2018-11-28 20:10:55.958682"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-28 20:10:55.961574"], ["updated_at", "2018-11-28 20:10:55.961574"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-28 21:10:55 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 2ms (Views: 0.2ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$5fq2xom//5EW8PXdUQn4/uAp2UVBa60QLmq39ThBwj4hYZQy7tuaO"], ["created_at", "2018-11-28 20:10:55.975681"], ["updated_at", "2018-11-28 20:10:55.975681"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-28 20:10:55.979219"], ["updated_at", "2018-11-28 20:10:55.979219"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-28 21:10:55 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.9ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["body", "My comment"], ["article_id", 1], ["created_at", "2018-11-28 20:10:55.991273"], ["updated_at", "2018-11-28 20:10:55.991273"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  Rendered comments/_comment.json.jbuilder (0.7ms)
  Rendered comments/create.json.jbuilder (7.2ms)
Completed 200 OK in 21ms (Views: 11.0ms | ActiveRecord: 1.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$QmZLCZIoCvXJxHGFvYnUP.hv9rvdYo3vYvUh0hB9kBuBiwLeUaoKq"], ["created_at", "2018-11-28 20:10:56.015584"], ["updated_at", "2018-11-28 20:10:56.015584"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$i1OVQPjyVMUAQDnua0OksucKi/.rxsHm3qyV4lYi5pertbx.BikHK"], ["created_at", "2018-11-28 20:10:56.022415"], ["updated_at", "2018-11-28 20:10:56.022415"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-28 20:10:56.024270"], ["updated_at", "2018-11-28 20:10:56.024270"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-28 21:10:56 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-28 20:10:56.039563"], ["updated_at", "2018-11-28 20:10:56.039563"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (6.8ms)
  Rendered comments/_comment.json.jbuilder (8.3ms)
  Rendered comments/create.json.jbuilder (8.8ms)
Completed 200 OK in 22ms (Views: 8.7ms | ActiveRecord: 1.9ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$Ai5g//sc9JtUm3dmZQTGnOWjH/o9Agl5.1ZMY1IKK7gQqItSRllza"], ["created_at", "2018-11-28 20:10:56.060630"], ["updated_at", "2018-11-28 20:10:56.060630"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-28 20:10:56.064067"], ["updated_at", "2018-11-28 20:10:56.064067"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$ptMxxlVD.EaL7teUuWOSQOJ8d89KK6PLQyYsXCi6mUnWzo3YBbAoK"], ["created_at", "2018-11-28 20:10:56.074802"], ["updated_at", "2018-11-28 20:10:56.074802"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-28 20:10:56.076326"], ["updated_at", "2018-11-28 20:10:56.076326"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-28 21:10:56 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.1ms)
  Rendered comments/_comment.json.jbuilder (2.0ms)
  Rendered comments/index.json.jbuilder (4.3ms)
Completed 200 OK in 8ms (Views: 4.4ms | ActiveRecord: 0.3ms)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$6HRXL8q7EQj2ATvJiYKz9ei04lVyFlBVkz9yH2DvNH7h1XSJLeH0y"], ["created_at", "2018-11-28 20:10:56.096612"], ["updated_at", "2018-11-28 20:10:56.096612"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (2.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$9TIlqlGsyWDhsBdmUKSZme.sgiaig0nuBZDo5hgEMun9d7HXA4rHa"], ["created_at", "2018-11-28 20:10:56.117175"], ["updated_at", "2018-11-28 20:10:56.117175"], ["username", "person14"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-28 20:10:56.126093"], ["updated_at", "2018-11-28 20:10:56.126093"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$3SotRpPVjwwVXGmKcrB8GuriDz7nMc8MP.qQIQsQGcQn9iUAhe.7W"], ["created_at", "2018-11-28 20:10:56.142120"], ["updated_at", "2018-11-28 20:10:56.142120"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (1.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$/twbTVgUUmu6gz0rDLOGMeOdUgEYrtT7tP86k1iIN4.34DAN5BNZW"], ["created_at", "2018-11-29 07:26:25.626507"], ["updated_at", "2018-11-29 07:26:25.626507"], ["username", "person1"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.0ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 07:26:25.643104"], ["updated_at", "2018-11-29 07:26:25.643104"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.7ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (1.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$4.MSElVsz.4Ks7GtSIh/tONTSZXjPLEyQnMW7ymEZ8ss4DQzwwxbK"], ["created_at", "2018-11-29 07:26:25.753428"], ["updated_at", "2018-11-29 07:26:25.753428"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (1.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 07:26:25.756761"], ["updated_at", "2018-11-29 07:26:25.756761"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 08:26:25 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.5ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (1.7ms)
  Rendered comments/_comment.json.jbuilder (22.2ms)
  Rendered comments/index.json.jbuilder (37.9ms)
Completed 200 OK in 74ms (Views: 49.4ms | ActiveRecord: 0.9ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$G41LiX0iKRRZcYN8mJtozempW0twzIHa1gEoSxdWdPH/UB9LaPmtm"], ["created_at", "2018-11-29 07:26:25.985062"], ["updated_at", "2018-11-29 07:26:25.985062"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$oAW6/ek0IBQ421qjEjqT8uE3QJGk/iL5jrWnc/G0.7Z/IdHnaonsa"], ["created_at", "2018-11-29 07:26:25.995824"], ["updated_at", "2018-11-29 07:26:25.995824"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$qsVKqbyXAoSEzr/QizP8NO9cgpQm3h/F/bQkhd.RmFpjpbCXi.isy"], ["created_at", "2018-11-29 07:26:26.003277"], ["updated_at", "2018-11-29 07:26:26.003277"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 07:26:26.005905"], ["updated_at", "2018-11-29 07:26:26.005905"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 07:26:26.008567"], ["updated_at", "2018-11-29 07:26:26.008567"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 08:26:26 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.4ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.5ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 7ms (Views: 0.6ms | ActiveRecord: 0.9ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$9Gl9PtRUnnOi2uepFLq2/eV2n8ruubRbZ13L0B9ikyVqPWCkjfYpq"], ["created_at", "2018-11-29 07:26:26.034006"], ["updated_at", "2018-11-29 07:26:26.034006"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 07:26:26.038967"], ["updated_at", "2018-11-29 07:26:26.038967"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 08:26:26 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 13ms (ActiveRecord: 0.1ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (2.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$9OkvdjOmIptrhuaRxcbC5egYuzOth66/uULp5w6tOGJmMzAQjtnN."], ["created_at", "2018-11-29 07:26:26.073811"], ["updated_at", "2018-11-29 07:26:26.073811"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$G7EjmnruCgfd2rhioM0fmuegkNrD9SP.A/ZBu6sbN85pDk5t.4MCK"], ["created_at", "2018-11-29 07:26:26.093169"], ["updated_at", "2018-11-29 07:26:26.093169"], ["username", "person8"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 07:26:26.103258"], ["updated_at", "2018-11-29 07:26:26.103258"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 07:26:26.107869"], ["updated_at", "2018-11-29 07:26:26.107869"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 08:26:26 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (2.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$kA3qdsNNAMfax0e2wIcvLeuI6OnHBWLX28QEXgSS0Gn.gaS58Sys."], ["created_at", "2018-11-29 07:26:26.123683"], ["updated_at", "2018-11-29 07:26:26.123683"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$1WFICEjoq51J9Hyd/qZuBeE/9evwXE92ITOp7MqWxX3sXk2StjvTi"], ["created_at", "2018-11-29 07:26:26.137305"], ["updated_at", "2018-11-29 07:26:26.137305"], ["username", "person10"]]
  [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 07:26:26.141315"], ["updated_at", "2018-11-29 07:26:26.141315"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 07:26:26.144760"], ["updated_at", "2018-11-29 07:26:26.144760"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 08:26:26 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.4ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 2.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$yC1rhX.sX9xWjN85M3oMdubFo2TRhF/REsMEipUkc1QDHO/zjSbpO"], ["created_at", "2018-11-29 07:26:26.170108"], ["updated_at", "2018-11-29 07:26:26.170108"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$HA6mPuESpEsWtE/7c0yGku3AHl2VTInY2Lk/F.shloHJJbS9dPDvK"], ["created_at", "2018-11-29 07:26:26.176862"], ["updated_at", "2018-11-29 07:26:26.176862"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 07:26:26.179725"], ["updated_at", "2018-11-29 07:26:26.179725"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 08:26:26 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 21ms (ActiveRecord: 0.2ms)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$yT1FqyTZYGYNJYMtYs2zNeuNrC8yNcSf87aZcQfHDpDoA6QO8gT9W"], ["created_at", "2018-11-29 07:26:26.222919"], ["updated_at", "2018-11-29 07:26:26.222919"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$2H.m7RiJaMPwa2yFcfqTEuswkkLB3DuqQEOTuNSyKbRGz9uLkxVgK"], ["created_at", "2018-11-29 07:26:26.241262"], ["updated_at", "2018-11-29 07:26:26.241262"], ["username", "person14"]]
  [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 07:26:26.250607"], ["updated_at", "2018-11-29 07:26:26.250607"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (2.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$tvlDUvabqzyuWLzvyZc.Q.Hr7VVcEkR2Wu2jDY8NgBYQCucYc3Wbu"], ["created_at", "2018-11-29 07:26:26.272539"], ["updated_at", "2018-11-29 07:26:26.272539"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$rUypNix7HyRQdo6e8OxkAOwp0GXMKIDYLaMe.68HiXDnzYFfbzw3K"], ["created_at", "2018-11-29 07:27:16.014255"], ["updated_at", "2018-11-29 07:27:16.014255"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 07:27:16.023855"], ["updated_at", "2018-11-29 07:27:16.023855"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 08:27:16 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 400 Bad Request in 9ms (ActiveRecord: 0.2ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$tRQZhW.PmH8WjdF13f0LcOhGnVj6LiHdiYMp04F7m2Q6DsuuRq0pe"], ["created_at", "2018-11-29 07:27:16.118110"], ["updated_at", "2018-11-29 07:27:16.118110"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$hASBivs7P19MCUoSVI09YusnaTXAYZ5NQEwZDSEOv1Oxp8ouD1a92"], ["created_at", "2018-11-29 07:27:16.126199"], ["updated_at", "2018-11-29 07:27:16.126199"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 07:27:16.130351"], ["updated_at", "2018-11-29 07:27:16.130351"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 07:27:16.145855"], ["updated_at", "2018-11-29 07:27:16.145855"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 08:27:16 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$I3x7WtgQ.V6vGktAK4JMNeFuYyMrGbCFsvH10ot5pI2Tu1ikOhaHa"], ["created_at", "2018-11-29 07:27:16.158376"], ["updated_at", "2018-11-29 07:27:16.158376"], ["username", "person4"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$EZvas4pC.2poKMwMYZilT.4ltMAJrMes5jRk3hrLrU/sRTy864bsO"], ["created_at", "2018-11-29 07:27:16.163033"], ["updated_at", "2018-11-29 07:27:16.163033"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.5ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 07:27:16.165558"], ["updated_at", "2018-11-29 07:27:16.165558"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 07:27:16.172099"], ["updated_at", "2018-11-29 07:27:16.172099"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 08:27:16 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$PWCtqr4pvQ31gcXX.NE0J.NfckmFlGPPNtf3XN5dUmx7Zv9vkd6gy"], ["created_at", "2018-11-29 07:27:16.200731"], ["updated_at", "2018-11-29 07:27:16.200731"], ["username", "person6"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$kAg7o1Mt4b3b9W8dWSjnAuLXD.NcFFQT5SAgHT7R1TpkJFYhka1.u"], ["created_at", "2018-11-29 07:27:16.206751"], ["updated_at", "2018-11-29 07:27:16.206751"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$nrZ0IK2wA.1Oww/prGjXXeQasNWUXNG47KZDAEjFGwSbarS/j7oaa"], ["created_at", "2018-11-29 07:27:16.213075"], ["updated_at", "2018-11-29 07:27:16.213075"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 07:27:16.216254"], ["updated_at", "2018-11-29 07:27:16.216254"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (2.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 07:27:16.224209"], ["updated_at", "2018-11-29 07:27:16.224209"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 08:27:16 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 3ms (Views: 0.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$u7VgXP4sI5HrqJRGFDlyAeEXA1T36Tq6u4DKcbpDFRx2aM7SqZYu2"], ["created_at", "2018-11-29 07:27:16.244791"], ["updated_at", "2018-11-29 07:27:16.244791"], ["username", "person9"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$8PwvqMEX3rhwRySTfepmPuKYvVoHlNMEP94PVc4kKuBsxc7xY3W9y"], ["created_at", "2018-11-29 07:27:16.256900"], ["updated_at", "2018-11-29 07:27:16.256900"], ["username", "person10"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 07:27:16.268593"], ["updated_at", "2018-11-29 07:27:16.268593"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 08:27:16 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 07:27:16.282380"], ["updated_at", "2018-11-29 07:27:16.282380"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (9.6ms)
  Rendered comments/_comment.json.jbuilder (11.4ms)
  Rendered comments/create.json.jbuilder (16.6ms)
Completed 200 OK in 31ms (Views: 20.2ms | ActiveRecord: 1.4ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$NxxercQwVtLkoSSnYIe.huV7hN0Gmbd37bG8u9hCRPIMx9G90njYS"], ["created_at", "2018-11-29 07:27:16.321475"], ["updated_at", "2018-11-29 07:27:16.321475"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 07:27:16.324512"], ["updated_at", "2018-11-29 07:27:16.324512"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$dBWuCDPk08i3JZHQUQA.ceEdXQV/eifgJ.IGMB88DIzF76jY2CSJa"], ["created_at", "2018-11-29 07:27:16.329963"], ["updated_at", "2018-11-29 07:27:16.329963"], ["username", "person12"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 07:27:16.331335"], ["updated_at", "2018-11-29 07:27:16.331335"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 08:27:16 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.5ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.2ms)
  Rendered comments/_comment.json.jbuilder (2.9ms)
  Rendered comments/index.json.jbuilder (8.1ms)
Completed 200 OK in 13ms (Views: 8.4ms | ActiveRecord: 0.7ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$Ay8/waMabvAAHU4UmecSEelGT8J1eQKJH82xTMhg.yjN6gYc22uZO"], ["created_at", "2018-11-29 07:27:16.354979"], ["updated_at", "2018-11-29 07:27:16.354979"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$sUduQMLSzXlg0TV1ENxMVOPU63zGnKeG3g4Yafeu9vMflhxlxi1lq"], ["created_at", "2018-11-29 07:27:16.371949"], ["updated_at", "2018-11-29 07:27:16.371949"], ["username", "person14"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 07:27:16.382266"], ["updated_at", "2018-11-29 07:27:16.382266"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$4ctNpNj09V0CTA19J48VmeqRlEwf4m5lWJjz2TZI72bjlaS7ntwLu"], ["created_at", "2018-11-29 07:27:16.399149"], ["updated_at", "2018-11-29 07:27:16.399149"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$96mMPeKUQahKWXvXxnFJfubtYMf1SqnXimqfsY/EEvhrIG9IdDTeq"], ["created_at", "2018-11-29 07:33:20.603784"], ["updated_at", "2018-11-29 07:33:20.603784"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.9ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 07:33:20.615988"], ["updated_at", "2018-11-29 07:33:20.615988"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.5ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 08:33:20 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "captcha"=>{"key"=>"1", "answer"=>"2"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.2ms)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$u3F2ynB931SwTpUCIIJ5Kevkk3CqOVfGAz3iqVOJTluizrq8.w5h2"], ["created_at", "2018-11-29 07:33:20.745953"], ["updated_at", "2018-11-29 07:33:20.745953"], ["username", "person2"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 07:33:20.748797"], ["updated_at", "2018-11-29 07:33:20.748797"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$oakM6LUTw9L5SgG/h3j/veaaIiKrLOL9Cl.Sl8PymGKWDVFuBz1N6"], ["created_at", "2018-11-29 07:33:20.770870"], ["updated_at", "2018-11-29 07:33:20.770870"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.9ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 07:33:20.774243"], ["updated_at", "2018-11-29 07:33:20.774243"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 08:33:20 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.6ms)
  Rendered comments/_comment.json.jbuilder (4.1ms)
  Rendered comments/index.json.jbuilder (11.0ms)
Completed 200 OK in 24ms (Views: 16.6ms | ActiveRecord: 0.4ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$Etivec7GvDSTSCptIovFyuEV4r3q/2QrpbnmCQ48w6qawlK671rW."], ["created_at", "2018-11-29 07:33:20.813313"], ["updated_at", "2018-11-29 07:33:20.813313"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$EhyMPd1T1c0Qua.vR5Os0e7PNLy9Mk5qDf5mWmvBfgkOsQGG8ZaOa"], ["created_at", "2018-11-29 07:33:20.818721"], ["updated_at", "2018-11-29 07:33:20.818721"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 07:33:20.821633"], ["updated_at", "2018-11-29 07:33:20.821633"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 08:33:20 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 07:33:20.835996"], ["updated_at", "2018-11-29 07:33:20.835996"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (14.5ms)
  Rendered comments/_comment.json.jbuilder (15.4ms)
  Rendered comments/create.json.jbuilder (17.0ms)
Completed 200 OK in 27ms (Views: 16.1ms | ActiveRecord: 2.2ms)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$ERS47Grqf4/oFfby9FC6mO/VHL8KqJD7jrEitLtOjyaMsNIjpd2qa"], ["created_at", "2018-11-29 07:33:20.866135"], ["updated_at", "2018-11-29 07:33:20.866135"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$y03zLxFosowOFbhk2R1aiOKjMYYANoh57x10LHXeLc5rxz42YykAG"], ["created_at", "2018-11-29 07:33:20.873840"], ["updated_at", "2018-11-29 07:33:20.873840"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.1ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 07:33:20.880276"], ["updated_at", "2018-11-29 07:33:20.880276"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 07:33:20.885226"], ["updated_at", "2018-11-29 07:33:20.885226"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 08:33:20 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.6ms)
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$NZ3UlAytE6YpTM9etGpb8uNqCC9sYcYh69a7/WPgb4JBMA4OBbfhC"], ["created_at", "2018-11-29 07:33:20.911692"], ["updated_at", "2018-11-29 07:33:20.911692"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$2DdHlT3eMs2lVuESyxIK1e/.ngbQnOzc/9U0gOS.VO9FsQpp/YxUe"], ["created_at", "2018-11-29 07:33:20.920268"], ["updated_at", "2018-11-29 07:33:20.920268"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$HnkyGF820VEJVGhEzsr3h.S3DQyKVyt9Le6UxOv/m149M34V5lwLe"], ["created_at", "2018-11-29 07:33:20.927377"], ["updated_at", "2018-11-29 07:33:20.927377"], ["username", "person10"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 07:33:20.937254"], ["updated_at", "2018-11-29 07:33:20.937254"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 07:33:20.943673"], ["updated_at", "2018-11-29 07:33:20.943673"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 08:33:20 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 3ms (Views: 0.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$0y0TRwqOXcV0Aa.jenFdCuxODlpQcLb.hfEJ62iWU71gUqJ8C/EaS"], ["created_at", "2018-11-29 07:33:20.966415"], ["updated_at", "2018-11-29 07:33:20.966415"], ["username", "person11"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$0Cv.oNtmtD..YMncZ4O9..Hej/xCZy4QYvJboqbt8iv/4fKLVzDsK"], ["created_at", "2018-11-29 07:33:20.973635"], ["updated_at", "2018-11-29 07:33:20.973635"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.5ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 07:33:20.977555"], ["updated_at", "2018-11-29 07:33:20.977555"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 07:33:20.988069"], ["updated_at", "2018-11-29 07:33:20.988069"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 08:33:20 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$QMm2aCZ886djW.4Blej3FOVsgFFePI9O1ihTVYC32xAyH2aByVP5y"], ["created_at", "2018-11-29 07:33:21.006071"], ["updated_at", "2018-11-29 07:33:21.006071"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$6FvWfVxnzWPyHQKGGFEe.u5jbYwZNT1.9JC2nsp52M.UmnkFmUbw6"], ["created_at", "2018-11-29 07:33:21.032018"], ["updated_at", "2018-11-29 07:33:21.032018"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 07:33:21.041738"], ["updated_at", "2018-11-29 07:33:21.041738"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$hMlCqgcehCUBJEiRSsixF.QK9rqT3rtQm9U4B.3nQq2cUU03.H0d6"], ["created_at", "2018-11-29 07:33:21.056843"], ["updated_at", "2018-11-29 07:33:21.056843"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (2.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$nJbQK3pH/eOUEvhu9jwYUufz.Cex4bC34n8Ja4oLZusGslyGKIOaG"], ["created_at", "2018-11-29 07:37:56.357717"], ["updated_at", "2018-11-29 07:37:56.357717"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.9ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 07:37:56.370047"], ["updated_at", "2018-11-29 07:37:56.370047"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.5ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$FcCszaXIAa2xx4OFPx5iQe63ThLoayULHIU8NnrlUXDS1k7n/OzXq"], ["created_at", "2018-11-29 07:37:56.408406"], ["updated_at", "2018-11-29 07:37:56.408406"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$hdlHQOxvewGMv0F3tL.8jOAKnzz09zCEi84RK2OwwFU0PGcSqA4IG"], ["created_at", "2018-11-29 07:37:56.437152"], ["updated_at", "2018-11-29 07:37:56.437152"], ["username", "person3"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$OZeXMimPxSFCArotXfzr7O3gi6LNumJahnggfHlPbQesdtvctdFpe"], ["created_at", "2018-11-29 07:37:56.642704"], ["updated_at", "2018-11-29 07:37:56.642704"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 07:37:56.645065"], ["updated_at", "2018-11-29 07:37:56.645065"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$/Hpg6ecBxrgQNaG.Xr48ReuHk.0PyYVbObuGj8BqxTzMEG6P3mmS6"], ["created_at", "2018-11-29 07:37:56.649979"], ["updated_at", "2018-11-29 07:37:56.649979"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (1.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 07:37:56.651352"], ["updated_at", "2018-11-29 07:37:56.651352"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 08:37:56 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.5ms)
  Rendered comments/_comment.json.jbuilder (3.9ms)
  Rendered comments/index.json.jbuilder (10.5ms)
Completed 200 OK in 28ms (Views: 14.7ms | ActiveRecord: 0.5ms)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$gETK8F2l/CF6735VLGc4NOyXgA88dB0zviM5IFgC03DOvRBvJBNYy"], ["created_at", "2018-11-29 07:37:56.772100"], ["updated_at", "2018-11-29 07:37:56.772100"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.6ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 07:37:56.775303"], ["updated_at", "2018-11-29 07:37:56.775303"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$OIsPDdr/diDe63spxAIAG.ehGgn9ulPIB6l8eAYVckZHtNCzqh.oO"], ["created_at", "2018-11-29 07:37:56.793537"], ["updated_at", "2018-11-29 07:37:56.793537"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$cnZL.1Dos96FenIuW8d6VepPm/bkmAey1MIQ.TtK8X31w3UCtMuHu"], ["created_at", "2018-11-29 07:37:56.798378"], ["updated_at", "2018-11-29 07:37:56.798378"], ["username", "person8"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$jF3X35NvgFdTLwklDifKre7Zu8nizAXw1nkQxBFf1IJPaVqNPDzVG"], ["created_at", "2018-11-29 07:37:56.807519"], ["updated_at", "2018-11-29 07:37:56.807519"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 07:37:56.809724"], ["updated_at", "2018-11-29 07:37:56.809724"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 07:37:56.812324"], ["updated_at", "2018-11-29 07:37:56.812324"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 08:37:56 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 4ms (Views: 0.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$xcWeeaBrsOEpNA2hnhWSOOqtNMahwkTPxk1TsONp1fy2NnxNf3XrK"], ["created_at", "2018-11-29 07:37:56.846908"], ["updated_at", "2018-11-29 07:37:56.846908"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$QQKm6lPCe9UYX.iIEB.HZek03vL.wYOcSUgnZwfdkr5duQXuIshjK"], ["created_at", "2018-11-29 07:37:56.862748"], ["updated_at", "2018-11-29 07:37:56.862748"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.8ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 07:37:56.865963"], ["updated_at", "2018-11-29 07:37:56.865963"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.8ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 07:37:56.869918"], ["updated_at", "2018-11-29 07:37:56.869918"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 08:37:56 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (1.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$RCH9DZEjxr0txFEF9GIIjeJmln5BSxwf9ap8k2brUjmovIl3QTG.."], ["created_at", "2018-11-29 07:37:56.889718"], ["updated_at", "2018-11-29 07:37:56.889718"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$vP1HA1RNCMAwslDc.pAiGuLq.ZwdzOWYVrsqe4N6w1ZA5MRi5FnmW"], ["created_at", "2018-11-29 07:37:56.901786"], ["updated_at", "2018-11-29 07:37:56.901786"], ["username", "person13"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 07:37:56.911452"], ["updated_at", "2018-11-29 07:37:56.911452"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 08:37:56 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 07:37:56.924126"], ["updated_at", "2018-11-29 07:37:56.924126"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (9.3ms)
  Rendered comments/_comment.json.jbuilder (10.5ms)
  Rendered comments/create.json.jbuilder (12.5ms)
Completed 200 OK in 24ms (Views: 12.7ms | ActiveRecord: 1.4ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$EHk.AgNuryK7OIe3oxBqM.hWB4/aiuOlNdaCYdYBq3CFKhb056DrC"], ["created_at", "2018-11-29 07:37:56.955600"], ["updated_at", "2018-11-29 07:37:56.955600"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$i6EbVUAwGnIGxExvkEDgkOJgba6fT8SyREnzFjiIbYxHXLO0fc.r6"], ["created_at", "2018-11-29 07:37:56.961272"], ["updated_at", "2018-11-29 07:37:56.961272"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 07:37:56.963107"], ["updated_at", "2018-11-29 07:37:56.963107"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.7ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 07:37:56.966543"], ["updated_at", "2018-11-29 07:37:56.966543"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 08:37:56 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$hJi1VxqhP0H1Gb.Fpi285ebeTFYh21RrQS5FowLUOkX7s78k6Zha."], ["created_at", "2018-11-29 16:48:38.222638"], ["updated_at", "2018-11-29 16:48:38.222638"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.9ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:48:38.234886"], ["updated_at", "2018-11-29 16:48:38.234886"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.4ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:48:38 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "captcha"=>{"key"=>"1", "answer"=>"2"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.2ms)
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$Usb2qFSERou8Mwi1BDOf9e/xRput9S93UeQuzEfkLieU84GEs7Uqe"], ["created_at", "2018-11-29 16:48:38.365744"], ["updated_at", "2018-11-29 16:48:38.365744"], ["username", "person2"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$P1SUqkbMLGB98zMpnhfflOkta2JAi33mbz/AWI71CDgxeYVPpNrDW"], ["created_at", "2018-11-29 16:48:38.370783"], ["updated_at", "2018-11-29 16:48:38.370783"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:48:38.373496"], ["updated_at", "2018-11-29 16:48:38.373496"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.9ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:48:38.391335"], ["updated_at", "2018-11-29 16:48:38.391335"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:48:38 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.5ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.6ms | ActiveRecord: 1.2ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$tCnpkPq1K8BCYIj3AC8R2.5M7m5Kf01ILjuTL59YyAjMyYE33BYhe"], ["created_at", "2018-11-29 16:48:38.420938"], ["updated_at", "2018-11-29 16:48:38.420938"], ["username", "person4"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$2XznrFqv2xIbBl2lv11ScebywoAXm25r1uP2nrtVY2lpXeIA7AJtq"], ["created_at", "2018-11-29 16:48:38.427976"], ["updated_at", "2018-11-29 16:48:38.427976"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$JFq.2A8Tizk1UERH8pCCAOvbvPtaAupsajl8.p/oHytBIBJoWEP8S"], ["created_at", "2018-11-29 16:48:38.435592"], ["updated_at", "2018-11-29 16:48:38.435592"], ["username", "person6"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 16:48:38.443815"], ["updated_at", "2018-11-29 16:48:38.443815"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:48:38.447468"], ["updated_at", "2018-11-29 16:48:38.447468"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:48:38 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 2ms (Views: 0.3ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$rRC2Nw9OQXZjk5B2/3nDZ.qPmkfM2d6xqzh5onvE/wAo/7M/fD37y"], ["created_at", "2018-11-29 16:48:38.459882"], ["updated_at", "2018-11-29 16:48:38.459882"], ["username", "person7"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.9ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:48:38.463281"], ["updated_at", "2018-11-29 16:48:38.463281"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$AssudRTDz02kOUtgYv7tVeS41RQMNdydFQnqbdBDZgO6JWlNAvl5e"], ["created_at", "2018-11-29 16:48:38.473967"], ["updated_at", "2018-11-29 16:48:38.473967"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:48:38.475574"], ["updated_at", "2018-11-29 16:48:38.475574"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:48:38 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (1.5ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (1.1ms)
  Rendered comments/_comment.json.jbuilder (6.7ms)
  Rendered comments/index.json.jbuilder (22.9ms)
Completed 200 OK in 56ms (Views: 44.7ms | ActiveRecord: 2.6ms)
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.8ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$w8IKU62jn45LiJwXM4UbVebma5Nz5LEy4KRnxo2Mb3xUp2m/xHuSG"], ["created_at", "2018-11-29 16:48:38.565242"], ["updated_at", "2018-11-29 16:48:38.565242"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (4.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$6MZSW4ckkEcOiI/UxZLlQeyeTKbTlDptP9U3pCWjHl82BF2o2WSBK"], ["created_at", "2018-11-29 16:48:38.574502"], ["updated_at", "2018-11-29 16:48:38.574502"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.9ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:48:38.596299"], ["updated_at", "2018-11-29 16:48:38.596299"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:48:38 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.8ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.6ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:48:38.637240"], ["updated_at", "2018-11-29 16:48:38.637240"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (20.3ms)
  Rendered comments/_comment.json.jbuilder (21.5ms)
  Rendered comments/create.json.jbuilder (25.5ms)
Completed 200 OK in 67ms (Views: 25.3ms | ActiveRecord: 5.6ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$e45DsmJkGGmabEgODmpKLeGAie2WfL6KQkn7wZaZ3RNPg/m24xHAa"], ["created_at", "2018-11-29 16:48:38.691105"], ["updated_at", "2018-11-29 16:48:38.691105"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$iFgLPaSGSo/dMbEKCNOyq.f39AaleGxJ7uLUxUBrGdt8EQAvxjKju"], ["created_at", "2018-11-29 16:48:38.703328"], ["updated_at", "2018-11-29 16:48:38.703328"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:48:38.706467"], ["updated_at", "2018-11-29 16:48:38.706467"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:48:38.710660"], ["updated_at", "2018-11-29 16:48:38.710660"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:48:38 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (8.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$DHt72TtTXEG1wNg3nhvl/eN6o4Wmm.RjhJ0YhIMxvYYUO/DdXFQeO"], ["created_at", "2018-11-29 16:48:38.741252"], ["updated_at", "2018-11-29 16:48:38.741252"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:48:38.744416"], ["updated_at", "2018-11-29 16:48:38.744416"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (2.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$hohzacjB/yyKNt57AOeuB.o7bM.DDmXnL9WbNtVGPaiTG.cbGoIeO"], ["created_at", "2018-11-29 16:48:38.757601"], ["updated_at", "2018-11-29 16:48:38.757601"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$hGrdYjgJDB8jutsIjOoQYe1qXSD5i09cwDQDR1sI0BpeVXICC4iNK"], ["created_at", "2018-11-29 16:48:38.795388"], ["updated_at", "2018-11-29 16:48:38.795388"], ["username", "person15"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$UzFi9iVky000wXJuOyrFYOeY0QTY8g4GPBnJCzboKJim0jNItGP92"], ["created_at", "2018-11-29 16:49:46.834450"], ["updated_at", "2018-11-29 16:49:46.834450"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$F8AoxKu9/pxpb/Dvt9Gg8OJW8RgtnZww3wJliFagbcRw8ykjYQDaW"], ["created_at", "2018-11-29 16:49:46.871988"], ["updated_at", "2018-11-29 16:49:46.871988"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$yQul4FnfvlT/JBArGkYj1uYtFn1zQGtiW.MNaCEZuw/L/1Lq3GzKK"], ["created_at", "2018-11-29 16:49:46.904155"], ["updated_at", "2018-11-29 16:49:46.904155"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:49:46.909519"], ["updated_at", "2018-11-29 16:49:46.909519"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$k1moKPMBol0S9sO/2843aO6lrSkkw9AO7f0gshf2fM7SZqBirg7nK"], ["created_at", "2018-11-29 16:49:47.064517"], ["updated_at", "2018-11-29 16:49:47.064517"], ["username", "person4"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:49:47.066725"], ["updated_at", "2018-11-29 16:49:47.066725"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$hZ882lSOxpWytcofowjoHOOVYelmxiKAaNwz5FX4nRrAKVHbPnFFu"], ["created_at", "2018-11-29 16:49:47.071519"], ["updated_at", "2018-11-29 16:49:47.071519"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:49:47.073135"], ["updated_at", "2018-11-29 16:49:47.073135"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:49:47 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.4ms)
  Rendered comments/_comment.json.jbuilder (3.1ms)
  Rendered comments/index.json.jbuilder (8.2ms)
Completed 200 OK in 20ms (Views: 10.7ms | ActiveRecord: 0.5ms)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$x.Ikp4IjuevH3eU0ekMwBO9wHSVYhQzy2l6XJNpgdds1ioaRz3Njm"], ["created_at", "2018-11-29 16:49:47.158964"], ["updated_at", "2018-11-29 16:49:47.158964"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:49:47.162608"], ["updated_at", "2018-11-29 16:49:47.162608"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:49:47 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha"=>{"key"=>"1", "answer"=>"2"}}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 400 Bad Request in 1ms (ActiveRecord: 0.2ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$MU8OuPzeSsoORnuy6rFIvednAx/AfRt5dIsl7Of7aWUNeR8Y62yBy"], ["created_at", "2018-11-29 16:49:47.180441"], ["updated_at", "2018-11-29 16:49:47.180441"], ["username", "person7"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$X6QImT1I3UZhSj7Xap8kQuZsvnd0f6Xo1XUM6.nOp5EdoxCqQEiva"], ["created_at", "2018-11-29 16:49:47.193008"], ["updated_at", "2018-11-29 16:49:47.193008"], ["username", "person8"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$IPz8DAMsnNcqP3uqQrx6ZuCQe134BbJvf4JOfMAPJwn.RfswhPGr6"], ["created_at", "2018-11-29 16:49:47.204754"], ["updated_at", "2018-11-29 16:49:47.204754"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 16:49:47.208017"], ["updated_at", "2018-11-29 16:49:47.208017"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.9ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:49:47.212082"], ["updated_at", "2018-11-29 16:49:47.212082"]]
  [1m[35m (2.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:49:47 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 4ms (Views: 0.7ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$o2xB8m/vYGrj/Fx80iVn6OxhdaKJiue.Bka/2awl.c3lRUkYmMEve"], ["created_at", "2018-11-29 16:49:47.240194"], ["updated_at", "2018-11-29 16:49:47.240194"], ["username", "person10"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$wMqIBR.lQXGqiVFRpXmzvOXpsMhz7N.dcNjQscFQTgQPeCPQrq/aO"], ["created_at", "2018-11-29 16:49:47.251317"], ["updated_at", "2018-11-29 16:49:47.251317"], ["username", "person11"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:49:47.261909"], ["updated_at", "2018-11-29 16:49:47.261909"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:49:47.266289"], ["updated_at", "2018-11-29 16:49:47.266289"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:49:47 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.7ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 0.9ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$siK12EW5o5/NpEvIF75HAu2VLhfcgy8dBzQ1NgFM0BPGEMmjV/C4e"], ["created_at", "2018-11-29 16:49:47.290887"], ["updated_at", "2018-11-29 16:49:47.290887"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$mAijv5wMS4HuECqSnbJATehGcJJmGPkIMpvmzsOyIPzjn6PQ06KC6"], ["created_at", "2018-11-29 16:49:47.300134"], ["updated_at", "2018-11-29 16:49:47.300134"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:49:47.302509"], ["updated_at", "2018-11-29 16:49:47.302509"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:49:47 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:49:47.321471"], ["updated_at", "2018-11-29 16:49:47.321471"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (12.9ms)
  Rendered comments/_comment.json.jbuilder (14.2ms)
  Rendered comments/create.json.jbuilder (15.7ms)
Completed 200 OK in 32ms (Views: 16.0ms | ActiveRecord: 1.7ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$/2dy0j7noGTUVJ8HcUOFJOnhK9n0Im.8pI7nRcHglKrOsBKDLAxbS"], ["created_at", "2018-11-29 16:49:47.351044"], ["updated_at", "2018-11-29 16:49:47.351044"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$9Oaa1iJ16Qy.CFXFiP2Z1elmSZzXWCcWgjFflJtPXldimt9qd2.om"], ["created_at", "2018-11-29 16:49:47.356539"], ["updated_at", "2018-11-29 16:49:47.356539"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:49:47.358598"], ["updated_at", "2018-11-29 16:49:47.358598"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:49:47.361241"], ["updated_at", "2018-11-29 16:49:47.361241"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:49:47 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (1.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$oX5kACOYCdjF9iy7oJu7AukmfaagbXMeyW.bt7tzUMwsXoiftjpua"], ["created_at", "2018-11-29 16:52:05.375125"], ["updated_at", "2018-11-29 16:52:05.375125"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:52:05.384999"], ["updated_at", "2018-11-29 16:52:05.384999"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:52:05 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha"=>{"key"=>"1", "answer"=>"2"}}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 400 Bad Request in 5ms (ActiveRecord: 0.2ms)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$YCTTSCzfmaH0Qw8Hk1bxPOCuls805eS/5.mZ1lCeyb6W2cKGZQYia"], ["created_at", "2018-11-29 16:52:05.475919"], ["updated_at", "2018-11-29 16:52:05.475919"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:52:05.481135"], ["updated_at", "2018-11-29 16:52:05.481135"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$yaiYlDy.i4kfhAz4CQ77N.R4.vrITpsRBjAe1cbfWX6at7pD1rPIO"], ["created_at", "2018-11-29 16:52:05.500307"], ["updated_at", "2018-11-29 16:52:05.500307"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:52:05.503396"], ["updated_at", "2018-11-29 16:52:05.503396"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:52:05 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.6ms)
  Rendered comments/_comment.json.jbuilder (3.2ms)
  Rendered comments/index.json.jbuilder (7.9ms)
Completed 200 OK in 14ms (Views: 10.2ms | ActiveRecord: 0.4ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$xqng/1u3oZYIOCBKcJuX6uzkZCqf0zxcPMd3eoYKLBC.OSvAUzASa"], ["created_at", "2018-11-29 16:52:05.533523"], ["updated_at", "2018-11-29 16:52:05.533523"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$9Ksl8fel7nIlKppeYWWK4.2IPaYqRrh6msZHxwfXlPzkxHtq5ze6S"], ["created_at", "2018-11-29 16:52:05.539144"], ["updated_at", "2018-11-29 16:52:05.539144"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:52:05.541068"], ["updated_at", "2018-11-29 16:52:05.541068"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:52:05 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.8ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:52:05.551644"], ["updated_at", "2018-11-29 16:52:05.551644"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (5.5ms)
  Rendered comments/_comment.json.jbuilder (6.1ms)
  Rendered comments/create.json.jbuilder (7.7ms)
Completed 200 OK in 22ms (Views: 8.4ms | ActiveRecord: 2.0ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$fkbaUwH63gP.fIUx9UVvguO6zHKL03u6KP2iDOLk.DW21nv/G4q3S"], ["created_at", "2018-11-29 16:52:05.577272"], ["updated_at", "2018-11-29 16:52:05.577272"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$LH/3MoRaac/yr1RFVFX1muZ024DHSCLRl3mAW6aiPuorxAi7K0DFm"], ["created_at", "2018-11-29 16:52:05.583198"], ["updated_at", "2018-11-29 16:52:05.583198"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.6ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:52:05.587162"], ["updated_at", "2018-11-29 16:52:05.587162"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.3ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:52:05.595517"], ["updated_at", "2018-11-29 16:52:05.595517"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:52:05 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$Zs5n276rgqVv.s71K2XaQujKg0vp/poDlrK3zLYaHEJ6dGfjlrlSO"], ["created_at", "2018-11-29 16:52:05.609191"], ["updated_at", "2018-11-29 16:52:05.609191"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$fpDOZmyYuTCB0RNjzXUUkuV.z3wqrkfovT30r4w4gE2SPKrlBy4s2"], ["created_at", "2018-11-29 16:52:05.614983"], ["updated_at", "2018-11-29 16:52:05.614983"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$Hy8LncGoJsX6KcDNFQj3xePOMvGSGyKV31nVtbtKS6XaaMMUYDLFK"], ["created_at", "2018-11-29 16:52:05.625478"], ["updated_at", "2018-11-29 16:52:05.625478"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 16:52:05.630137"], ["updated_at", "2018-11-29 16:52:05.630137"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:52:05.634193"], ["updated_at", "2018-11-29 16:52:05.634193"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:52:05 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 3ms (Views: 0.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$ZEr4KmghDwW0d6VtrtYcxOEqbkFE2HJRqZaHcDaOxh.mSsA3CX3Ie"], ["created_at", "2018-11-29 16:52:05.652838"], ["updated_at", "2018-11-29 16:52:05.652838"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$wZwcVg0DcJ0UPuyTvsx/wOlyOf1VdXpkqQF7iy.5esYZyUhFQLg0O"], ["created_at", "2018-11-29 16:52:05.660611"], ["updated_at", "2018-11-29 16:52:05.660611"], ["username", "person12"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:52:05.663144"], ["updated_at", "2018-11-29 16:52:05.663144"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.9ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:52:05.667184"], ["updated_at", "2018-11-29 16:52:05.667184"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:52:05 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.2ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 0.6ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$.Ph8orePShuaPiDv1o.X0uvM0K90lpJuixc0b.DIkhTPrSpNtOQgu"], ["created_at", "2018-11-29 16:52:05.694502"], ["updated_at", "2018-11-29 16:52:05.694502"], ["username", "person13"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:52:05.698788"], ["updated_at", "2018-11-29 16:52:05.698788"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$CYwD8r3zJ/sxvTwp9gqc..grc84sy7vUY//5ooXMLwfb5LJMufzWK"], ["created_at", "2018-11-29 16:52:05.718216"], ["updated_at", "2018-11-29 16:52:05.718216"], ["username", "person14"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$qHixSYST3.GegtyLKgLuoOf7Iff2lK7AMwVATf5GF5jkrQFXwzc8q"], ["created_at", "2018-11-29 16:52:05.749223"], ["updated_at", "2018-11-29 16:52:05.749223"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$9L3/Dq5s6n6RwyrOE5Jqfuex9Ik5JQPRqYoFotK.EPGYHzY.XlqE2"], ["created_at", "2018-11-29 16:53:23.324984"], ["updated_at", "2018-11-29 16:53:23.324984"], ["username", "person1"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$XQvz2YXs2YEl.NPoPR5SWOcm4bRgaiGtCsn3ALaxyn56KkGIAqTOO"], ["created_at", "2018-11-29 16:53:23.372934"], ["updated_at", "2018-11-29 16:53:23.372934"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:53:23.376434"], ["updated_at", "2018-11-29 16:53:23.376434"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$lHG0zGBLpwcx2e4G4xIp5O3j4yocZpBDwAwRX9Yd9Geb4tlqXPLjm"], ["created_at", "2018-11-29 16:53:23.405897"], ["updated_at", "2018-11-29 16:53:23.405897"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$tOYuwwaZq81FBTpUQ3NZzeKQkuOtFrGl.4pK4sx/9hRYS2JdrDB.e"], ["created_at", "2018-11-29 16:53:23.552557"], ["updated_at", "2018-11-29 16:53:23.552557"], ["username", "person4"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:53:23.554837"], ["updated_at", "2018-11-29 16:53:23.554837"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:53:23 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha"=>{"key"=>"1", "answer"=>"2"}}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Unpermitted parameter: :captcha
Completed 500 Internal Server Error in 7ms (ActiveRecord: 0.2ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$/r2iT7bOf5MJBs525I7PUu2Zsb2NT2eft2zC6e51UxNVdaL0pX7Ha"], ["created_at", "2018-11-29 16:53:23.636759"], ["updated_at", "2018-11-29 16:53:23.636759"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$CB.WUeOINOspbsr3kamqEunXLjk21WBb9JCf1pGfanrnZeudfa59y"], ["created_at", "2018-11-29 16:53:23.642279"], ["updated_at", "2018-11-29 16:53:23.642279"], ["username", "person6"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:53:23.644162"], ["updated_at", "2018-11-29 16:53:23.644162"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:53:23 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:53:23.661040"], ["updated_at", "2018-11-29 16:53:23.661040"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (6.1ms)
  Rendered comments/_comment.json.jbuilder (7.5ms)
  Rendered comments/create.json.jbuilder (11.4ms)
Completed 200 OK in 23ms (Views: 14.3ms | ActiveRecord: 1.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$n/sf7xAohFLrX4UnispjZe6pnAMoR2m46hZSTvjgeMTe7Z8JleKAK"], ["created_at", "2018-11-29 16:53:23.693404"], ["updated_at", "2018-11-29 16:53:23.693404"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$GY/zj85mgMmjt4.rRw79K.9grPOC9CBtfOjTWZVMRGAECrV3GmegS"], ["created_at", "2018-11-29 16:53:23.700987"], ["updated_at", "2018-11-29 16:53:23.700987"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:53:23.704366"], ["updated_at", "2018-11-29 16:53:23.704366"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:53:23.708174"], ["updated_at", "2018-11-29 16:53:23.708174"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:53:23 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.5ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.5ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.1ms | ActiveRecord: 1.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (2.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$LPG2nKSHHLGOAai3Ir9VouDBrtpd2mY.Goasv/guXoWeT1qgWjiNq"], ["created_at", "2018-11-29 16:53:23.735607"], ["updated_at", "2018-11-29 16:53:23.735607"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:53:23.739101"], ["updated_at", "2018-11-29 16:53:23.739101"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$qpcltOB6bn5ojQkkkn5Pkeh0YVvZe4g0wRNOWJrJp3wfZ1uBhI/Ea"], ["created_at", "2018-11-29 16:53:23.750808"], ["updated_at", "2018-11-29 16:53:23.750808"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:53:23.755757"], ["updated_at", "2018-11-29 16:53:23.755757"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:53:23 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.1ms)
  Rendered comments/_comment.json.jbuilder (3.3ms)
  Rendered comments/index.json.jbuilder (6.2ms)
Completed 200 OK in 10ms (Views: 6.9ms | ActiveRecord: 0.3ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (1.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$8Y/7ZrC23jDIT7kyid6DFeCiDCz6oAZXwFT52Ik.J3lu7GP.JA2ga"], ["created_at", "2018-11-29 16:53:23.780555"], ["updated_at", "2018-11-29 16:53:23.780555"], ["username", "person11"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$Jb3VU4xuYop19hCifTcy3.Qq9Eu5Rrw0KckgH3iTCLBvRUIHysXhq"], ["created_at", "2018-11-29 16:53:23.790405"], ["updated_at", "2018-11-29 16:53:23.790405"], ["username", "person12"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.7ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:53:23.793059"], ["updated_at", "2018-11-29 16:53:23.793059"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.6ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:53:23.800538"], ["updated_at", "2018-11-29 16:53:23.800538"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:53:23 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$d/kRUoD90VaVy8IclZMc4uchJz6ZKxsupIk1hz2A6UgSZgUx1UDxi"], ["created_at", "2018-11-29 16:53:23.823941"], ["updated_at", "2018-11-29 16:53:23.823941"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$Eb9XcdSQnEFct.XTCfzaYevA6vqJHF2CZ/5BoAOyALnYxQqvmDQH."], ["created_at", "2018-11-29 16:53:23.830375"], ["updated_at", "2018-11-29 16:53:23.830375"], ["username", "person14"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$8tk/IXiYp/L.R3uzy7/FvuxStaZmhC6MOzviZI1miWgjR0Nn5ftm."], ["created_at", "2018-11-29 16:53:23.838860"], ["updated_at", "2018-11-29 16:53:23.838860"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 16:53:23.840772"], ["updated_at", "2018-11-29 16:53:23.840772"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:53:23.843130"], ["updated_at", "2018-11-29 16:53:23.843130"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:53:23 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 2ms (Views: 0.1ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$dHIPJPsm9h8lWF4W/NrhZeZpnwrknqAJ4Q2S6yIqLjldI30IrI7wu"], ["created_at", "2018-11-29 16:54:01.650759"], ["updated_at", "2018-11-29 16:54:01.650759"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (2.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$yQgyVOSOHtMQwubG66BsYeGZadBPmMtwpV2roOtFaAD4RAjDYkqcW"], ["created_at", "2018-11-29 16:54:01.704810"], ["updated_at", "2018-11-29 16:54:01.704810"], ["username", "person2"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:54:01.713526"], ["updated_at", "2018-11-29 16:54:01.713526"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$UXczbqIK5irqZlWCZ/.SVeqVX/qBMfgBDRxk85o8zZpEiq6wX5mdS"], ["created_at", "2018-11-29 16:54:01.742186"], ["updated_at", "2018-11-29 16:54:01.742186"], ["username", "person3"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$kxNj4WctqrR8XklkTpsqHe.NJhj5Wo9WmXM9.Oo0GgZ3chT3CuKDa"], ["created_at", "2018-11-29 16:54:01.916391"], ["updated_at", "2018-11-29 16:54:01.916391"], ["username", "person4"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$jgUL0sth7FY9aYKfeWZnTuSU.npve42oEil.ZzbM/Icut4mfaYM6a"], ["created_at", "2018-11-29 16:54:01.920809"], ["updated_at", "2018-11-29 16:54:01.920809"], ["username", "person5"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$ECXKjQtPHMyvzCx1Wy.aheBLHdU.9HRbj/ercEuPSzi6FZAJ4qL4u"], ["created_at", "2018-11-29 16:54:01.924633"], ["updated_at", "2018-11-29 16:54:01.924633"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 16:54:01.926520"], ["updated_at", "2018-11-29 16:54:01.926520"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:54:01.929099"], ["updated_at", "2018-11-29 16:54:01.929099"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:54:01 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 10ms (Views: 0.3ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$K8rVP0K19TjYghE7uNj.PuoOybePFnkyVLS1czXpKSqPXHu5l1yw2"], ["created_at", "2018-11-29 16:54:02.023665"], ["updated_at", "2018-11-29 16:54:02.023665"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:54:02.028055"], ["updated_at", "2018-11-29 16:54:02.028055"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:54:02 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha"=>{"key"=>"1", "answer"=>"2"}}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (2.4ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Unpermitted parameter: :captcha
Unpermitted parameter: :captcha
Completed 500 Internal Server Error in 11ms (ActiveRecord: 2.4ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$RKyjxLSiqv5jYjtx7q.0MOu3qEBpttGbubwyoQKY3U3R3BVSfVi0K"], ["created_at", "2018-11-29 16:54:02.058555"], ["updated_at", "2018-11-29 16:54:02.058555"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:54:02.064155"], ["updated_at", "2018-11-29 16:54:02.064155"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$NUt487g30yXfSe18hy2kkOVNX8b8QlrqpiUDWZw4OWAm.zq7TBR2."], ["created_at", "2018-11-29 16:54:02.079582"], ["updated_at", "2018-11-29 16:54:02.079582"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:54:02.086391"], ["updated_at", "2018-11-29 16:54:02.086391"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:54:02 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.5ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (1.0ms)
  Rendered comments/_comment.json.jbuilder (9.3ms)
  Rendered comments/index.json.jbuilder (18.4ms)
Completed 200 OK in 27ms (Views: 22.6ms | ActiveRecord: 0.8ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$3VCJW/TEg212nui.vFuecum9twGKiC3S8sHELBWAmzdkziXKTUReK"], ["created_at", "2018-11-29 16:54:02.129618"], ["updated_at", "2018-11-29 16:54:02.129618"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$Nh8o0iTzgJUVd0ra8gmDd.W1DUupUsf1iT3GitALAX5XrZJ8rMt46"], ["created_at", "2018-11-29 16:54:02.150632"], ["updated_at", "2018-11-29 16:54:02.150632"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:54:02.152769"], ["updated_at", "2018-11-29 16:54:02.152769"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:54:02.155438"], ["updated_at", "2018-11-29 16:54:02.155438"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:54:02 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$dCTzP2tTVh43CKZhccvwJetj6nl5SkJwWq2bhxotQ5Suik.5Xy8Uu"], ["created_at", "2018-11-29 16:54:02.168149"], ["updated_at", "2018-11-29 16:54:02.168149"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$HVxnUCCxD/gqq/y4fMRB7.s6gaeTYskuRUpzkZu.8sZ92jHJ68UGK"], ["created_at", "2018-11-29 16:54:02.174096"], ["updated_at", "2018-11-29 16:54:02.174096"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:54:02.176130"], ["updated_at", "2018-11-29 16:54:02.176130"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:54:02 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.8ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:54:02.189041"], ["updated_at", "2018-11-29 16:54:02.189041"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (5.8ms)
  Rendered comments/_comment.json.jbuilder (6.5ms)
  Rendered comments/create.json.jbuilder (7.9ms)
Completed 200 OK in 24ms (Views: 7.9ms | ActiveRecord: 2.4ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$SwiMdZPz8TI1R5VCMNGrI.xJh3AI5DL6JJaYOa17kXRfMI9F4xRSG"], ["created_at", "2018-11-29 16:54:02.214729"], ["updated_at", "2018-11-29 16:54:02.214729"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$Bm1ND7S2FONCYaVz8vJ0Y.iRcif//wqFYm.VuQLPVu3viIDNPx3WS"], ["created_at", "2018-11-29 16:54:02.220713"], ["updated_at", "2018-11-29 16:54:02.220713"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:54:02.222692"], ["updated_at", "2018-11-29 16:54:02.222692"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:54:02.225137"], ["updated_at", "2018-11-29 16:54:02.225137"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:54:02 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.4ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$dvl241EPbKWDT/yxVdi7cOMCjTalDGxCUmc/NxlQjUQwvBlpN.8EW"], ["created_at", "2018-11-29 16:54:26.390348"], ["updated_at", "2018-11-29 16:54:26.390348"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$3Jhs.Ujz.Rwii7qyLA/zuOUMJJ1fgWP98zyguZt0gS1C9QEdsZWYC"], ["created_at", "2018-11-29 16:54:26.428276"], ["updated_at", "2018-11-29 16:54:26.428276"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$nu3i5AhWdQpkKecT8SpFT.aAP684o65UeVxSdTFOo8Aphj4hq0EUu"], ["created_at", "2018-11-29 16:54:26.454396"], ["updated_at", "2018-11-29 16:54:26.454396"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:54:26.457696"], ["updated_at", "2018-11-29 16:54:26.457696"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$Az1fyZwIKPVebjBheGUtMu4sPcZ0NXlcfH1eGxQlHbPtLyDqurDou"], ["created_at", "2018-11-29 16:54:26.633828"], ["updated_at", "2018-11-29 16:54:26.633828"], ["username", "person4"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:54:26.636092"], ["updated_at", "2018-11-29 16:54:26.636092"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:54:26 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha"=>{"key"=>"1", "answer"=>"2"}}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Unpermitted parameter: :captcha
Unpermitted parameter: :captcha
Completed 500 Internal Server Error in 7ms (ActiveRecord: 0.2ms)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$Za9BrMSfmcINeauTznhR0OCj47NhtgyLTEJTH6vB0fEye7UgqCpuG"], ["created_at", "2018-11-29 16:54:26.720939"], ["updated_at", "2018-11-29 16:54:26.720939"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:54:26.724098"], ["updated_at", "2018-11-29 16:54:26.724098"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$AAtVlAr94vfXXGBEEohwhO0TRKiLCuZKuX0DYLIXMu.y.bAu6gf3."], ["created_at", "2018-11-29 16:54:26.735148"], ["updated_at", "2018-11-29 16:54:26.735148"], ["username", "person6"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:54:26.743897"], ["updated_at", "2018-11-29 16:54:26.743897"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:54:26 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.5ms)
  Rendered comments/_comment.json.jbuilder (3.5ms)
  Rendered comments/index.json.jbuilder (11.3ms)
Completed 200 OK in 18ms (Views: 14.2ms | ActiveRecord: 0.4ms)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$bE1YuXXHyVg8.RwNhPrBgOcxCDw.y82Q8eEmEVRAAce9jT.E7RuOe"], ["created_at", "2018-11-29 16:54:26.781822"], ["updated_at", "2018-11-29 16:54:26.781822"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$882ZgG5VQO8YCEC68jIeyePiwF4nis8MSgTG6wPv5OBxHkP7tMD96"], ["created_at", "2018-11-29 16:54:26.789979"], ["updated_at", "2018-11-29 16:54:26.789979"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:54:26.792809"], ["updated_at", "2018-11-29 16:54:26.792809"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:54:26.802567"], ["updated_at", "2018-11-29 16:54:26.802567"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:54:26 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$35za7gdJXaPeDdK.yhd/8uf3jHzuoEqB4Np5w.J6H44ypumDdFRO."], ["created_at", "2018-11-29 16:54:26.819160"], ["updated_at", "2018-11-29 16:54:26.819160"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$ueWRvjcsUUq2lFRI1Z4HQ.deBq1qo6oOXLr2SzIZ403MMHSMTJOs."], ["created_at", "2018-11-29 16:54:26.825837"], ["updated_at", "2018-11-29 16:54:26.825837"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$z4iERwy.fmzl9zGPaDPxoOROJ/4g9sfV97uHIIfUuwCVBn8YJ0qpu"], ["created_at", "2018-11-29 16:54:26.837613"], ["updated_at", "2018-11-29 16:54:26.837613"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 16:54:26.841352"], ["updated_at", "2018-11-29 16:54:26.841352"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:54:26.845679"], ["updated_at", "2018-11-29 16:54:26.845679"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:54:26 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.5ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 3ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$XSXRuJ.CrkdPTWA14r4B0ersDx8O1mV2uI7ZutwfzOmuWY2CmmBcm"], ["created_at", "2018-11-29 16:54:26.864034"], ["updated_at", "2018-11-29 16:54:26.864034"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$gaBm9/wlGyATgT6tbEafIeEjr.oOlVabb3nZtZWFRrJVsnu.eQiUS"], ["created_at", "2018-11-29 16:54:26.872852"], ["updated_at", "2018-11-29 16:54:26.872852"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:54:26.875834"], ["updated_at", "2018-11-29 16:54:26.875834"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:54:26.889817"], ["updated_at", "2018-11-29 16:54:26.889817"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:54:26 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 13ms (Views: 8.5ms | ActiveRecord: 0.6ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$PqSPiBvtIjKxQ6TjTb7JiOgMhJpQy0H3JEfEiGXcDhJCbUo0Fn53u"], ["created_at", "2018-11-29 16:54:26.917411"], ["updated_at", "2018-11-29 16:54:26.917411"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$IHnJaxTnvNav5DbROx4GoemRLWwwnyTAwHAc5Nom9ZPiEKTgq5gxW"], ["created_at", "2018-11-29 16:54:26.922945"], ["updated_at", "2018-11-29 16:54:26.922945"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:54:26.924901"], ["updated_at", "2018-11-29 16:54:26.924901"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:54:26 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.6ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:54:26.942359"], ["updated_at", "2018-11-29 16:54:26.942359"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (5.4ms)
  Rendered comments/_comment.json.jbuilder (6.1ms)
  Rendered comments/create.json.jbuilder (7.7ms)
Completed 200 OK in 21ms (Views: 7.7ms | ActiveRecord: 1.6ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$tijgLnOkvTA8PVPWqtnXw.zB0SLv1GRnm/3YU881DD6BndbF9mt2C"], ["created_at", "2018-11-29 16:58:09.966249"], ["updated_at", "2018-11-29 16:58:09.966249"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$aRUN3tFrsw9JZs4VAlDp2eiwmF2pmDdoscD1aogZHx0Gg3eeiIZ/q"], ["created_at", "2018-11-29 16:58:09.997479"], ["updated_at", "2018-11-29 16:58:09.997479"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:58:10.004999"], ["updated_at", "2018-11-29 16:58:10.004999"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:58:10 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:58:10.102345"], ["updated_at", "2018-11-29 16:58:10.102345"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (5.8ms)
  Rendered comments/_comment.json.jbuilder (7.2ms)
  Rendered comments/create.json.jbuilder (10.8ms)
Completed 200 OK in 36ms (Views: 13.4ms | ActiveRecord: 1.7ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$OMcqgnOkUEcxvRZnr9Rgwe50WlE4QIPoyrQeEQ0TOTfHjwKHQvvkW"], ["created_at", "2018-11-29 16:58:10.132144"], ["updated_at", "2018-11-29 16:58:10.132144"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$QmwTf4/rw1z0I80dgO1A2OtqUzrD1BH/Ldz77y3N4QJOjMjU3AK7O"], ["created_at", "2018-11-29 16:58:10.137417"], ["updated_at", "2018-11-29 16:58:10.137417"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$AD5egWoG/HD7YCv/Jw7dre.4S0JDwLWML1KM.PlSd41.Ya2yqVLxS"], ["created_at", "2018-11-29 16:58:10.145138"], ["updated_at", "2018-11-29 16:58:10.145138"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 16:58:10.147043"], ["updated_at", "2018-11-29 16:58:10.147043"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:58:10.150176"], ["updated_at", "2018-11-29 16:58:10.150176"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:58:10 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.3ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 4ms (Views: 0.2ms | ActiveRecord: 0.4ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$YSv0IKtuG2i/iZfZHa0k9OQt8nFgBVFaq9hBpBzfgbTK5RJ9NOnxK"], ["created_at", "2018-11-29 16:58:10.172141"], ["updated_at", "2018-11-29 16:58:10.172141"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:58:10.175762"], ["updated_at", "2018-11-29 16:58:10.175762"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:58:10 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"2"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.2ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$Gj6P8mkBmfEy49mkypJtQ.buSAJKytBS82C3gsiecctTDRf16McXS"], ["created_at", "2018-11-29 16:58:10.198565"], ["updated_at", "2018-11-29 16:58:10.198565"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$KBbmGOoPeLFs/VD3W8w6ROvFoO260n41YwObSgkpcc77YKWwxms1W"], ["created_at", "2018-11-29 16:58:10.212625"], ["updated_at", "2018-11-29 16:58:10.212625"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:58:10.218646"], ["updated_at", "2018-11-29 16:58:10.218646"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:58:10.221453"], ["updated_at", "2018-11-29 16:58:10.221453"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:58:10 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$yRMGa13/sZ5aC/xRGra8T.Q7iaypS6PlSK8whUR49/6c.eNaFsBfK"], ["created_at", "2018-11-29 16:58:10.237554"], ["updated_at", "2018-11-29 16:58:10.237554"], ["username", "person9"]]
  [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$8bQiDtYUN9/E5GhLlWaZLOH6i6Kc0pL8EcPjQR7Actmo9BFqQ9pmK"], ["created_at", "2018-11-29 16:58:10.250443"], ["updated_at", "2018-11-29 16:58:10.250443"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.9ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:58:10.256179"], ["updated_at", "2018-11-29 16:58:10.256179"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:58:10.263272"], ["updated_at", "2018-11-29 16:58:10.263272"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:58:10 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$u10ItAuimnSjsG0gEKPgrOn8foP1wOtWG8l3EymE.wIKyreZqiULW"], ["created_at", "2018-11-29 16:58:10.279924"], ["updated_at", "2018-11-29 16:58:10.279924"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:58:10.284520"], ["updated_at", "2018-11-29 16:58:10.284520"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.3ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$zeKTvoPWhvFqtka7NoEYBuAzx51JixFgd2SFDPOBOqlDwF3H06hQi"], ["created_at", "2018-11-29 16:58:10.298780"], ["updated_at", "2018-11-29 16:58:10.298780"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:58:10.300995"], ["updated_at", "2018-11-29 16:58:10.300995"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:58:10 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.1ms)
  Rendered comments/_comment.json.jbuilder (3.3ms)
  Rendered comments/index.json.jbuilder (6.6ms)
Completed 200 OK in 11ms (Views: 6.7ms | ActiveRecord: 0.4ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$OrnNDCOFnqykbR1TUbloWe5Qh/GxIYqcWokFpJCCnP3b1eh7X2hKe"], ["created_at", "2018-11-29 16:58:10.326014"], ["updated_at", "2018-11-29 16:58:10.326014"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$CrdZ6sgiSPb4tVMbjGh6au9IoTODrVFqrEZwqOyYzbaLMiubVdtuS"], ["created_at", "2018-11-29 16:58:10.354862"], ["updated_at", "2018-11-29 16:58:10.354862"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$OjH8yzd3TJzsIx1P/bYuhOozMVwXB70FVGsFXsmdc9JT5XFpJ0d0W"], ["created_at", "2018-11-29 16:58:10.368340"], ["updated_at", "2018-11-29 16:58:10.368340"], ["username", "person15"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:58:10.381450"], ["updated_at", "2018-11-29 16:58:10.381450"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$/Q6N.G7IwL2t8CMHSt.Uzua4xFHO8ubtPo0h/6JghxT299IgOS3Ve"], ["created_at", "2018-11-29 16:59:08.251724"], ["updated_at", "2018-11-29 16:59:08.251724"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$M/tlK006ZJ38WgTi4.XfeuPgbFk.pFO6XzbOvq0P2kbqmPdtFf2D6"], ["created_at", "2018-11-29 16:59:08.257563"], ["updated_at", "2018-11-29 16:59:08.257563"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$zI7KbQ1IyA3Yb7TCXmeag.Yz6UYWZKjHPfYDKoQydNgHcLz8E386C"], ["created_at", "2018-11-29 16:59:08.289321"], ["updated_at", "2018-11-29 16:59:08.289321"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 16:59:08.296700"], ["updated_at", "2018-11-29 16:59:08.296700"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:59:08.323597"], ["updated_at", "2018-11-29 16:59:08.323597"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:59:08 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 7ms (Views: 0.3ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$bOpxXKN9OhAQ1fLnV4hgXeIBbki6REFQsOZ29.joNcWKOW8XidrGe"], ["created_at", "2018-11-29 16:59:08.405790"], ["updated_at", "2018-11-29 16:59:08.405790"], ["username", "person4"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$S4./QpAx9VrEgjGdcRo1xO1jyf1jUquxeWZyXZXhlKCY/3jXdfWkO"], ["created_at", "2018-11-29 16:59:08.410560"], ["updated_at", "2018-11-29 16:59:08.410560"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:59:08.412703"], ["updated_at", "2018-11-29 16:59:08.412703"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:59:08.415288"], ["updated_at", "2018-11-29 16:59:08.415288"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:59:08 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$3Ih4Pjt4GQ9HWJw..9SrxuaXeMhADliMZBR39k6qplWsKyjw6izN2"], ["created_at", "2018-11-29 16:59:08.435251"], ["updated_at", "2018-11-29 16:59:08.435251"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$kLx1rTSWaYUppZshZ.Pp5OV01jWu1MHr7RZl68uFfQ7p58xmQQ0qC"], ["created_at", "2018-11-29 16:59:08.441635"], ["updated_at", "2018-11-29 16:59:08.441635"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:59:08.443567"], ["updated_at", "2018-11-29 16:59:08.443567"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:59:08.446562"], ["updated_at", "2018-11-29 16:59:08.446562"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:59:08 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.5ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.5ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 10ms (Views: 0.4ms | ActiveRecord: 1.7ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$nk90cinINM509Z3.PN0ayeez9tYKBtnd1du5aVngpxsUmqjYCKdxy"], ["created_at", "2018-11-29 16:59:08.470068"], ["updated_at", "2018-11-29 16:59:08.470068"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:59:08.473689"], ["updated_at", "2018-11-29 16:59:08.473689"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:59:08 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"2"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.1ms)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$/7E7s7MmPbhMusVmGrdh2eTXZ0wW8qcruejeBvzWKdTMCVaSYTRIK"], ["created_at", "2018-11-29 16:59:08.498627"], ["updated_at", "2018-11-29 16:59:08.498627"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$E3dAfhBb3A0rAbQjK0QC5e8PUKRTVdLseCr3tEDbHChPKjxRDa7SG"], ["created_at", "2018-11-29 16:59:08.514944"], ["updated_at", "2018-11-29 16:59:08.514944"], ["username", "person10"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:59:08.521703"], ["updated_at", "2018-11-29 16:59:08.521703"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:59:08 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:59:08.541276"], ["updated_at", "2018-11-29 16:59:08.541276"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (8.2ms)
  Rendered comments/_comment.json.jbuilder (10.5ms)
  Rendered comments/create.json.jbuilder (15.8ms)
Completed 200 OK in 39ms (Views: 21.0ms | ActiveRecord: 1.7ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$LTqw5z6Od4L8M369GKEK0..aMnnvTEujjUzta6gHVXeqK/L1a.WbG"], ["created_at", "2018-11-29 16:59:08.579410"], ["updated_at", "2018-11-29 16:59:08.579410"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:59:08.582984"], ["updated_at", "2018-11-29 16:59:08.582984"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$Xsa0/DYom4BZP1EiwxovkuGGBmBOXjgL4EPxEyFPKeBYWCuNm0vdm"], ["created_at", "2018-11-29 16:59:08.595490"], ["updated_at", "2018-11-29 16:59:08.595490"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:59:08.597517"], ["updated_at", "2018-11-29 16:59:08.597517"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:59:08 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.1ms)
  Rendered comments/_comment.json.jbuilder (3.1ms)
  Rendered comments/index.json.jbuilder (6.3ms)
Completed 200 OK in 10ms (Views: 6.4ms | ActiveRecord: 0.3ms)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (1.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$bIfs0RYQFT1nXRs/17ifDO9akIWutJPxOM9KeUHytL2dQCTD6MYTO"], ["created_at", "2018-11-29 16:59:08.622137"], ["updated_at", "2018-11-29 16:59:08.622137"], ["username", "person13"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$QZqjoDMt2up5AQq6OoPIIO2DcnxgY7LE5o2N32pxjCDFcUD33Wsb."], ["created_at", "2018-11-29 16:59:08.651022"], ["updated_at", "2018-11-29 16:59:08.651022"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:59:08.654254"], ["updated_at", "2018-11-29 16:59:08.654254"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$tjEDU46ar0KTrd3QGIjIB.EIPUpW5bnwm5qV0oNZfWaU8QGKZl/MS"], ["created_at", "2018-11-29 16:59:08.662209"], ["updated_at", "2018-11-29 16:59:08.662209"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$lnbXyJamqgAFRTJPRfCIL.gHMW0jhVEWgz7t7LIDhnq09PSwB.WZO"], ["created_at", "2018-11-29 16:59:41.735750"], ["updated_at", "2018-11-29 16:59:41.735750"], ["username", "person1"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$kLTpKUxisBImpd9lbUZrVeNBgWzvwK7TxxnNcKAQ1XELmr/1WtgjK"], ["created_at", "2018-11-29 16:59:41.767239"], ["updated_at", "2018-11-29 16:59:41.767239"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:59:41.774424"], ["updated_at", "2018-11-29 16:59:41.774424"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:59:41.805970"], ["updated_at", "2018-11-29 16:59:41.805970"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:59:41 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$StCMIL4YEgW3OBCLedCTF.RSgutUVWTms32JrDZmC8fZSghRBamWS"], ["created_at", "2018-11-29 16:59:41.913385"], ["updated_at", "2018-11-29 16:59:41.913385"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:59:41.916835"], ["updated_at", "2018-11-29 16:59:41.916835"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:59:41 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"2"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.7ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 4ms (ActiveRecord: 0.7ms)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$ePf024npt8ADIUpqs/h2neA7UeRd2PFSnQv5.5HkZ7e.1oGtHGco6"], ["created_at", "2018-11-29 16:59:41.937064"], ["updated_at", "2018-11-29 16:59:41.937064"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$0s2.kcv4RhGwLq1du.jwE.UghBI2nwIFilsZM46jXA5zD5GcyaVUa"], ["created_at", "2018-11-29 16:59:41.946487"], ["updated_at", "2018-11-29 16:59:41.946487"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:59:41.949573"], ["updated_at", "2018-11-29 16:59:41.949573"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.6ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:59:41.954847"], ["updated_at", "2018-11-29 16:59:41.954847"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:59:41 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$7I7AhcUbPIllqzxuYIH4O.pJCOjLbYMlu2CVRDfbNh2tiF1bKLRTS"], ["created_at", "2018-11-29 16:59:41.976756"], ["updated_at", "2018-11-29 16:59:41.976756"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$r9GOs3kzHv5Tj2eELMW/e.MpGXxIwBJzuN7gcAp74hxy/eiTrZMWu"], ["created_at", "2018-11-29 16:59:41.983967"], ["updated_at", "2018-11-29 16:59:41.983967"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$hMqjJgsoLc7SOyqdIAxSoOvBJS0agvGi3/iKW.wOr8kFeMPvaynGG"], ["created_at", "2018-11-29 16:59:41.998676"], ["updated_at", "2018-11-29 16:59:41.998676"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.0ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 16:59:42.004018"], ["updated_at", "2018-11-29 16:59:42.004018"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:59:42.014686"], ["updated_at", "2018-11-29 16:59:42.014686"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 17:59:42 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.5ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 4ms (Views: 0.6ms | ActiveRecord: 0.6ms)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$57XgpfDpwlSoDR.VGECOv.hpG1IVyd5aessxHd.epyIuSf5pvgsbO"], ["created_at", "2018-11-29 16:59:42.036780"], ["updated_at", "2018-11-29 16:59:42.036780"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$LG.8l.qC4J71qXjvBJ7BNu/lpWjZIPq28r58.XvhJVPW9lSkfvPdm"], ["created_at", "2018-11-29 16:59:42.042650"], ["updated_at", "2018-11-29 16:59:42.042650"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 16:59:42.044644"], ["updated_at", "2018-11-29 16:59:42.044644"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:59:42 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (1.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 16:59:42.059299"], ["updated_at", "2018-11-29 16:59:42.059299"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (5.0ms)
  Rendered comments/_comment.json.jbuilder (6.4ms)
  Rendered comments/create.json.jbuilder (10.0ms)
Completed 200 OK in 29ms (Views: 12.3ms | ActiveRecord: 2.6ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$NrZ2w7h6u9i0yb6jNJfscO5R3cdfCVWuQUHsR8AEMHmBxmWGROBsi"], ["created_at", "2018-11-29 16:59:42.088113"], ["updated_at", "2018-11-29 16:59:42.088113"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:59:42.091677"], ["updated_at", "2018-11-29 16:59:42.091677"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$rDzJ1yhI.tIjG6wako.EgeHES.JxTRUHCGUm8qmQnEaKY6ME4XBuC"], ["created_at", "2018-11-29 16:59:42.096755"], ["updated_at", "2018-11-29 16:59:42.096755"], ["username", "person12"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 16:59:42.098146"], ["updated_at", "2018-11-29 16:59:42.098146"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 17:59:42 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.6ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.1ms)
  Rendered comments/_comment.json.jbuilder (2.1ms)
  Rendered comments/index.json.jbuilder (8.7ms)
Completed 200 OK in 14ms (Views: 8.8ms | ActiveRecord: 0.9ms)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$FWTnZisDvArWSQ0y/nk9x.l7voYYHqNzBzQ6ZUaLKrRKQkuFJlVCa"], ["created_at", "2018-11-29 16:59:42.123906"], ["updated_at", "2018-11-29 16:59:42.123906"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$kmiaooZbkCfChHpPNspZQuTEqO6NtPS6cD/2XLGR5qC.6Fg16zHKC"], ["created_at", "2018-11-29 16:59:42.147604"], ["updated_at", "2018-11-29 16:59:42.147604"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$7S.8kwi0amSH7ux9NeRlkuNlsIqNLcAdpmLVsfUyHXa4uSh9B1YXe"], ["created_at", "2018-11-29 16:59:42.161537"], ["updated_at", "2018-11-29 16:59:42.161537"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 16:59:42.164451"], ["updated_at", "2018-11-29 16:59:42.164451"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$jUQtayafNKT.EYu2cLnoZuTO1AVcrngrY3hyUqtRs9faMwzK9uvz."], ["created_at", "2018-11-29 17:00:43.357522"], ["updated_at", "2018-11-29 17:00:43.357522"], ["username", "person1"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$jKxBAwR6flceff.6onKQHeu55FgAhsb10p.xdQdTBB4cZx71VMI0S"], ["created_at", "2018-11-29 17:00:43.389490"], ["updated_at", "2018-11-29 17:00:43.389490"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:00:43.399268"], ["updated_at", "2018-11-29 17:00:43.399268"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:00:43 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:00:43.492765"], ["updated_at", "2018-11-29 17:00:43.492765"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (7.1ms)
  Rendered comments/_comment.json.jbuilder (8.5ms)
  Rendered comments/create.json.jbuilder (12.4ms)
Completed 200 OK in 38ms (Views: 14.6ms | ActiveRecord: 1.5ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$7WiTodoOM3iuf7i12rl7NeYaqwqPDkxdBn4uVMopsOuGI2v1UUGlu"], ["created_at", "2018-11-29 17:00:43.522505"], ["updated_at", "2018-11-29 17:00:43.522505"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$0br7PMvDpix9Je2jPaXBXeVMxHdCFac3F.dICebPhlSo4bqdpZuPS"], ["created_at", "2018-11-29 17:00:43.528936"], ["updated_at", "2018-11-29 17:00:43.528936"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:00:43.531057"], ["updated_at", "2018-11-29 17:00:43.531057"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:00:43.534671"], ["updated_at", "2018-11-29 17:00:43.534671"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:00:43 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$o9irOBQviVuL2/Vud8jq5u8gY221dcJ45XHUxkDN3sg3./mM1U3V2"], ["created_at", "2018-11-29 17:00:43.556500"], ["updated_at", "2018-11-29 17:00:43.556500"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$WjjDG3T.ngG2dxwd/WT2QODRPGKeE5vhyJEB8gtgPi6MEdKXgecKK"], ["created_at", "2018-11-29 17:00:43.564613"], ["updated_at", "2018-11-29 17:00:43.564613"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$NiPQoUtCDUK6zu4DCylQH.pjpZgcQKwWkcjnf86BFBtnSnerOb4B2"], ["created_at", "2018-11-29 17:00:43.571132"], ["updated_at", "2018-11-29 17:00:43.571132"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.7ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:00:43.580273"], ["updated_at", "2018-11-29 17:00:43.580273"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:00:43.587830"], ["updated_at", "2018-11-29 17:00:43.587830"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:00:43 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 3ms (Views: 0.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$Pcfk2522tSCoXHdcnpvipO8PZnMqylOMepDAt6WgzzMqiMFewqMcm"], ["created_at", "2018-11-29 17:00:43.606807"], ["updated_at", "2018-11-29 17:00:43.606807"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:00:43.610539"], ["updated_at", "2018-11-29 17:00:43.610539"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:00:43 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"2"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 403 Forbidden in 2ms (Views: 0.2ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$t2q.oH5WqmKw1EYYONqatuuqBbnaHFQRAuG//c/nxTuyKz/0tnCFi"], ["created_at", "2018-11-29 17:00:43.636644"], ["updated_at", "2018-11-29 17:00:43.636644"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$TcQYyKqwNvhnyrTjPeWDnOtUDwGZcMBxBHwVTa6LU468BCAjkGk9W"], ["created_at", "2018-11-29 17:00:43.645649"], ["updated_at", "2018-11-29 17:00:43.645649"], ["username", "person10"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:00:43.652773"], ["updated_at", "2018-11-29 17:00:43.652773"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (1.0ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:00:43.660826"], ["updated_at", "2018-11-29 17:00:43.660826"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:00:43 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 10ms (Views: 0.1ms | ActiveRecord: 0.6ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$s96nAeCUj1pKq6JI76veXuTRtfaERf5o3QPMTacZvgQi0e/uwZLOe"], ["created_at", "2018-11-29 17:00:43.687324"], ["updated_at", "2018-11-29 17:00:43.687324"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:00:43.690423"], ["updated_at", "2018-11-29 17:00:43.690423"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$ZPHk11rMpz/pPRsLdvvrqOe6liz/bHntW9opzhUnt509o3SYzIgtq"], ["created_at", "2018-11-29 17:00:43.695904"], ["updated_at", "2018-11-29 17:00:43.695904"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:00:43.697345"], ["updated_at", "2018-11-29 17:00:43.697345"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:00:43 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.2ms)
  Rendered comments/_comment.json.jbuilder (4.6ms)
  Rendered comments/index.json.jbuilder (7.5ms)
Completed 200 OK in 11ms (Views: 8.0ms | ActiveRecord: 0.4ms)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$ExRMfz2zp2KIJXOU5KS5quFAykquTjDICqwrYYt4NfoPCou/j7JP6"], ["created_at", "2018-11-29 17:00:43.722261"], ["updated_at", "2018-11-29 17:00:43.722261"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:00:43.725684"], ["updated_at", "2018-11-29 17:00:43.725684"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$uXcHlTK47CytCdQAE7M9/eqK1RxCETyLCKmuOrRNBBvb3FWXEEHZ6"], ["created_at", "2018-11-29 17:00:43.732690"], ["updated_at", "2018-11-29 17:00:43.732690"], ["username", "person14"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$WIa27AZZiXuJftj/rT0SA.XpJdxeiVNzVg6HJbGc4ln0DkpIHLN2q"], ["created_at", "2018-11-29 17:00:43.761393"], ["updated_at", "2018-11-29 17:00:43.761393"], ["username", "person15"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$ScaY4dZQ6aa2Ut3mcEmW7.HBOUGVaBarbTDh5W3YoSAxy0IFE4fo."], ["created_at", "2018-11-29 17:01:53.697623"], ["updated_at", "2018-11-29 17:01:53.697623"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:01:53.706302"], ["updated_at", "2018-11-29 17:01:53.706302"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$JHNx01OaDfQ0BdfvaHC8huR9a9Pc5y26xTCrtzzhNVUjB4qdtUMJe"], ["created_at", "2018-11-29 17:01:53.738215"], ["updated_at", "2018-11-29 17:01:53.738215"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$fcPuwORnWDFEIMGIGx3pNeNp/J2gJrcUXHXBqjzr8SAZHq.e0OsFS"], ["created_at", "2018-11-29 17:01:53.761311"], ["updated_at", "2018-11-29 17:01:53.761311"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$cxzzsvt74yWT1E6IXYR1pOvtOtqiRBJvpgIjRqgug5tuMK8uW0jwG"], ["created_at", "2018-11-29 17:01:53.902474"], ["updated_at", "2018-11-29 17:01:53.902474"], ["username", "person4"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$w.d9NqkJX6q67rylDVXIpeAcxbP3BFBtK8n8CT1MgIR9xzyuMZclC"], ["created_at", "2018-11-29 17:01:53.906789"], ["updated_at", "2018-11-29 17:01:53.906789"], ["username", "person5"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$edvFED8YZTlI0xH4veZo2eZU8ecLcmrPbJHkCqjIXGQmJ1ypxp046"], ["created_at", "2018-11-29 17:01:53.910703"], ["updated_at", "2018-11-29 17:01:53.910703"], ["username", "person6"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:01:53.912461"], ["updated_at", "2018-11-29 17:01:53.912461"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:01:53.915373"], ["updated_at", "2018-11-29 17:01:53.915373"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:01:53 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 7ms (Views: 0.3ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$hZ9kElWT2EHdBdWmSjNzrOLRYPWY6s/0QDw0SqY8dscIYX9ff5/2C"], ["created_at", "2018-11-29 17:01:53.996850"], ["updated_at", "2018-11-29 17:01:53.996850"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:01:54.000107"], ["updated_at", "2018-11-29 17:01:54.000107"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$hGlnqse5bqNwGk/VjpJ0AexcCC4rmvyWcjlpRf5goU.CUDkhXa5x2"], ["created_at", "2018-11-29 17:01:54.006318"], ["updated_at", "2018-11-29 17:01:54.006318"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:01:54.007766"], ["updated_at", "2018-11-29 17:01:54.007766"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:01:54 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.4ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.5ms)
  Rendered comments/_comment.json.jbuilder (3.5ms)
  Rendered comments/index.json.jbuilder (11.4ms)
Completed 200 OK in 22ms (Views: 17.8ms | ActiveRecord: 0.7ms)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$y3VFF0tFzi/gLKcnBiwoHumNKNhm7EakG0oEjqmaLKbOgihNbwDuu"], ["created_at", "2018-11-29 17:01:54.042333"], ["updated_at", "2018-11-29 17:01:54.042333"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$ib9RkCqIkpS.dL5Ri/tlROz8A06.Wztp1IzVdiN2mMtyWnTn2znre"], ["created_at", "2018-11-29 17:01:54.058372"], ["updated_at", "2018-11-29 17:01:54.058372"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:01:54.061405"], ["updated_at", "2018-11-29 17:01:54.061405"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:01:54.066037"], ["updated_at", "2018-11-29 17:01:54.066037"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:01:54 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$De5umQCTACiZOeCwrLuW5.9tycZNjsfk1GWaL3AlHT5MuTa7jFNH2"], ["created_at", "2018-11-29 17:01:54.082686"], ["updated_at", "2018-11-29 17:01:54.082686"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:01:54.087386"], ["updated_at", "2018-11-29 17:01:54.087386"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:01:54 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"2"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 403 Forbidden in 2ms (Views: 0.2ms | ActiveRecord: 0.2ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (2.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$2PuE8fMXTAFsmFEZDuuD2Out7oC2rPM/wytK39xJHuIU/hUp3kLRi"], ["created_at", "2018-11-29 17:01:54.113812"], ["updated_at", "2018-11-29 17:01:54.113812"], ["username", "person12"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$nrAiW5DuNIXR8KYCDsHCXu/3.lJtQof0996zf1Gj7JHIrKJM1eHLi"], ["created_at", "2018-11-29 17:01:54.130602"], ["updated_at", "2018-11-29 17:01:54.130602"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:01:54.133817"], ["updated_at", "2018-11-29 17:01:54.133817"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:01:54 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.7ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.6ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:01:54.147249"], ["updated_at", "2018-11-29 17:01:54.147249"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (12.5ms)
  Rendered comments/_comment.json.jbuilder (13.7ms)
  Rendered comments/create.json.jbuilder (16.0ms)
Completed 200 OK in 31ms (Views: 16.6ms | ActiveRecord: 2.1ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$UN4W/VrnuvxpMe3Ek03L1OnoabPuuOusYcVkrcslY43wMewh06Bry"], ["created_at", "2018-11-29 17:01:54.181156"], ["updated_at", "2018-11-29 17:01:54.181156"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$x.UUev14THDKsJJGdirZIeUOLs/mbfS7is1Af10nrapbYIzm7yu4u"], ["created_at", "2018-11-29 17:01:54.186708"], ["updated_at", "2018-11-29 17:01:54.186708"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:01:54.188684"], ["updated_at", "2018-11-29 17:01:54.188684"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:01:54.191239"], ["updated_at", "2018-11-29 17:01:54.191239"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:01:54 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.5ms)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$RMV.rXmHZQ7BmSFNQDVNZeb409psKuWSdVOhNqctAO2vFYjSMFZX."], ["created_at", "2018-11-29 17:02:19.847499"], ["updated_at", "2018-11-29 17:02:19.847499"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:02:19.858148"], ["updated_at", "2018-11-29 17:02:19.858148"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:02:19 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"abv"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 403 Forbidden in 9ms (Views: 0.4ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$ELMlO6Iso0VaPcrLl56.zObXGZUi/ssHsir27jqaCJWJq3ruAGqbG"], ["created_at", "2018-11-29 17:02:19.953919"], ["updated_at", "2018-11-29 17:02:19.953919"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$jpMzJ5cqcBab3H7ZQ5Rc2OdFfC6VIyykvmFEcqkaQvUEAbudp.2nC"], ["created_at", "2018-11-29 17:02:19.959002"], ["updated_at", "2018-11-29 17:02:19.959002"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$ZTllPzRbG8JC92EKsg3iUOI/F.fVHvttodYYeXGlhhLZjv0nagv7u"], ["created_at", "2018-11-29 17:02:19.967760"], ["updated_at", "2018-11-29 17:02:19.967760"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:02:19.970245"], ["updated_at", "2018-11-29 17:02:19.970245"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:02:19.986874"], ["updated_at", "2018-11-29 17:02:19.986874"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:02:19 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 3ms (Views: 0.4ms | ActiveRecord: 0.3ms)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$rkw8ZONcQRNnw5Oe8YsXPOJd.8/904t6Jw4qfN7Abar5bP/ZgRNwe"], ["created_at", "2018-11-29 17:02:20.006505"], ["updated_at", "2018-11-29 17:02:20.006505"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$m8gxTTranLaxL8z.dLTXPeF.ZOYrHRe1sdFO2OG7CgNvJy1PJGO.y"], ["created_at", "2018-11-29 17:02:20.018733"], ["updated_at", "2018-11-29 17:02:20.018733"], ["username", "person6"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:02:20.026947"], ["updated_at", "2018-11-29 17:02:20.026947"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:02:20.030559"], ["updated_at", "2018-11-29 17:02:20.030559"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:02:20 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$EfsOOLnVTzQNkK4kGtVgJeRWX4EF0x3olS1yclF1NhpnP6Oe1oZ4i"], ["created_at", "2018-11-29 17:02:20.053099"], ["updated_at", "2018-11-29 17:02:20.053099"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$Vd6IDYzGsm/B0pJuKfDjDuhl2LxaCcoOOt6q9A3j8Y31PVjX9KNaC"], ["created_at", "2018-11-29 17:02:20.064404"], ["updated_at", "2018-11-29 17:02:20.064404"], ["username", "person8"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:02:20.071218"], ["updated_at", "2018-11-29 17:02:20.071218"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:02:20.075954"], ["updated_at", "2018-11-29 17:02:20.075954"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:02:20 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.6ms | ActiveRecord: 0.4ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$VrBa0hKnGwvfRO10lN5t7.W6fAL.wwdlrtNTH9sCiYexkuFmBtkBW"], ["created_at", "2018-11-29 17:02:20.094910"], ["updated_at", "2018-11-29 17:02:20.094910"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$/EWI27.N8QZ8UGtAkVJc4ukQbSauxHTC7bSlg/GW/ym8zruMKyAhy"], ["created_at", "2018-11-29 17:02:20.101934"], ["updated_at", "2018-11-29 17:02:20.101934"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:02:20.105096"], ["updated_at", "2018-11-29 17:02:20.105096"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:02:20 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:02:20.125321"], ["updated_at", "2018-11-29 17:02:20.125321"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (8.9ms)
  Rendered comments/_comment.json.jbuilder (10.7ms)
  Rendered comments/create.json.jbuilder (15.6ms)
Completed 200 OK in 31ms (Views: 19.1ms | ActiveRecord: 1.7ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$uetzT6/WXkhhOzlarp5r4uFUaovU.S71TXY2JPPX2.Dyv1tK6NnKm"], ["created_at", "2018-11-29 17:02:20.162975"], ["updated_at", "2018-11-29 17:02:20.162975"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:02:20.166072"], ["updated_at", "2018-11-29 17:02:20.166072"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$XUv0/rneSDuKrX7nwZe/aOjZbchuHKmIgR2AiLBcL62mVbh2IaB/2"], ["created_at", "2018-11-29 17:02:20.171543"], ["updated_at", "2018-11-29 17:02:20.171543"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:02:20.172952"], ["updated_at", "2018-11-29 17:02:20.172952"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:02:20 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.6ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.2ms)
  Rendered comments/_comment.json.jbuilder (2.3ms)
  Rendered comments/index.json.jbuilder (8.0ms)
Completed 200 OK in 15ms (Views: 8.5ms | ActiveRecord: 0.8ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$dPsvLbOhHu7Pudd6FB7AdOxU/S0KaaiW7VvFi/YVMw6kLc.eR.cOa"], ["created_at", "2018-11-29 17:02:20.203820"], ["updated_at", "2018-11-29 17:02:20.203820"], ["username", "person13"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (2.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$8L/1RjyAxOvf8jC7yiIVK.OJc4bzCbrjx8EYncZeqbLR6ojqKwO/S"], ["created_at", "2018-11-29 17:02:20.232327"], ["updated_at", "2018-11-29 17:02:20.232327"], ["username", "person14"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (1.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$njNAAYMv.1YMa.EwZlAGr.jRb6mwOq9WShVwz15CeBocdvSdcyCiC"], ["created_at", "2018-11-29 17:02:20.254534"], ["updated_at", "2018-11-29 17:02:20.254534"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:02:20.260598"], ["updated_at", "2018-11-29 17:02:20.260598"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$VoJYy3Dtz5cZ55.cDTdi9.by6VDBC4ve034H.H984Pgy/ancvUhLK"], ["created_at", "2018-11-29 17:02:46.136308"], ["updated_at", "2018-11-29 17:02:46.136308"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$XWeKQZX/DzChqNZJgpf02eYHj0Z/e6RIrr4s0XwMqpRREvktcxSLK"], ["created_at", "2018-11-29 17:02:46.183529"], ["updated_at", "2018-11-29 17:02:46.183529"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:02:46.186717"], ["updated_at", "2018-11-29 17:02:46.186717"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$ZwBjRZy4N7CoZbtHYTXLg.b2z8s7oIile7WrguZfn4dXiILAjIvVW"], ["created_at", "2018-11-29 17:02:46.217901"], ["updated_at", "2018-11-29 17:02:46.217901"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$DEhoT2xiCREJ5IbOOo2uCu5Ohm5Pu/f9Okm2zTDhcMfaMTjYbCI2i"], ["created_at", "2018-11-29 17:02:46.373516"], ["updated_at", "2018-11-29 17:02:46.373516"], ["username", "person4"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:02:46.375734"], ["updated_at", "2018-11-29 17:02:46.375734"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$2Ho64l.lzTYH5DAV7geZf.NXRz7Zqxy5EMJ1aKFrweKf2McvpICd."], ["created_at", "2018-11-29 17:02:46.380739"], ["updated_at", "2018-11-29 17:02:46.380739"], ["username", "person5"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:02:46.382133"], ["updated_at", "2018-11-29 17:02:46.382133"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:02:46 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.4ms)
  Rendered comments/_comment.json.jbuilder (3.2ms)
  Rendered comments/index.json.jbuilder (7.8ms)
Completed 200 OK in 19ms (Views: 10.6ms | ActiveRecord: 0.5ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$5d5ddBZWc3nzsMYnNMswDeEUpcDojQpGShKG397zw8KxCT3rTWScm"], ["created_at", "2018-11-29 17:02:46.468961"], ["updated_at", "2018-11-29 17:02:46.468961"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:02:46.472697"], ["updated_at", "2018-11-29 17:02:46.472697"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:02:46 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"abv"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 403 Forbidden in 2ms (Views: 0.2ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$k476aSeXFytQazBfYjGrUeO6.s6Xey.Nw.oxBnpOTe2.3o/NYGFzW"], ["created_at", "2018-11-29 17:02:46.490056"], ["updated_at", "2018-11-29 17:02:46.490056"], ["username", "person7"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$gSlXOv3RRKVkQU1EvN3x7ud05rUYa5Q0IkYPTW8yjqOUxff6UYR8C"], ["created_at", "2018-11-29 17:02:46.506819"], ["updated_at", "2018-11-29 17:02:46.506819"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:02:46.511144"], ["updated_at", "2018-11-29 17:02:46.511144"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.5ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:02:46 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.9ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:02:46.531094"], ["updated_at", "2018-11-29 17:02:46.531094"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (9.2ms)
  Rendered comments/_comment.json.jbuilder (10.8ms)
  Rendered comments/create.json.jbuilder (16.0ms)
Completed 200 OK in 37ms (Views: 16.2ms | ActiveRecord: 2.3ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$cO.8PyoR8k.I7JNrNR.j..WwiqTSs/KON3I1Hw.Tf.o29cYZ1oAK."], ["created_at", "2018-11-29 17:02:46.569207"], ["updated_at", "2018-11-29 17:02:46.569207"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$tYi89lym31NQ.ZGQPMIws.2PwlDjIDokXvzDGKeYpes9GwgWLXPlS"], ["created_at", "2018-11-29 17:02:46.578768"], ["updated_at", "2018-11-29 17:02:46.578768"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:02:46.582476"], ["updated_at", "2018-11-29 17:02:46.582476"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:02:46.586165"], ["updated_at", "2018-11-29 17:02:46.586165"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:02:46 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.5ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 10ms (Views: 0.1ms | ActiveRecord: 0.9ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$BuKg9zA1vThcvKr6Zxtkl.Uv1kIRRRJepyRpCtsmIEKguAF5MmoJG"], ["created_at", "2018-11-29 17:02:46.613880"], ["updated_at", "2018-11-29 17:02:46.613880"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$q.LS8dOGGzkL5DCiyh7/.OnAfduFT0g0iKlNEKzWf28NzHg0muVCW"], ["created_at", "2018-11-29 17:02:46.620562"], ["updated_at", "2018-11-29 17:02:46.620562"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.8ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:02:46.625950"], ["updated_at", "2018-11-29 17:02:46.625950"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:02:46.635051"], ["updated_at", "2018-11-29 17:02:46.635051"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:02:46 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$NVWYTprd3vEStgKVCmecB.UCLHLvoX1o..FLix8Y9N.babzm9k4iK"], ["created_at", "2018-11-29 17:02:46.654401"], ["updated_at", "2018-11-29 17:02:46.654401"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$7oOMRTaxccbJGB3tMgSrUeAwGb8QLKGJqdFz3x7PgOlTDg3oRS7ku"], ["created_at", "2018-11-29 17:02:46.659864"], ["updated_at", "2018-11-29 17:02:46.659864"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$6pdoIIx8UY.lJSOYUYWKNev3Yq3WmlugdoxUnGZvA7m9MoSKaY.WO"], ["created_at", "2018-11-29 17:02:46.663925"], ["updated_at", "2018-11-29 17:02:46.663925"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:02:46.665820"], ["updated_at", "2018-11-29 17:02:46.665820"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:02:46.668317"], ["updated_at", "2018-11-29 17:02:46.668317"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:02:46 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.3ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 3ms (Views: 0.2ms | ActiveRecord: 0.4ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$gMp7yTjlh3UBgTqlRq/IN.38U5RDpJoUiIOn.cMeARDEve1mw9dOa"], ["created_at", "2018-11-29 17:02:59.889629"], ["updated_at", "2018-11-29 17:02:59.889629"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$7RVLZvl9s9iPguB5eetG7.CHB82IF1cWX.WlG26HgZ63Y/GpcKbPu"], ["created_at", "2018-11-29 17:02:59.921518"], ["updated_at", "2018-11-29 17:02:59.921518"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:02:59.928505"], ["updated_at", "2018-11-29 17:02:59.928505"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:02:59.954944"], ["updated_at", "2018-11-29 17:02:59.954944"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:02:59 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 6ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$yCJjBrwn8y7RmDfZeeajsOKZ9WBDPweBa9PA.mXc71vF3Ue/n7lhO"], ["created_at", "2018-11-29 17:03:00.033722"], ["updated_at", "2018-11-29 17:03:00.033722"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$S/uFE5gxlNUywxRcBBatMulCj33GmfYDdm7VR9aSP2Ya4w.glBAVa"], ["created_at", "2018-11-29 17:03:00.040379"], ["updated_at", "2018-11-29 17:03:00.040379"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:03:00.042515"], ["updated_at", "2018-11-29 17:03:00.042515"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:03:00.045067"], ["updated_at", "2018-11-29 17:03:00.045067"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:03:00 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (1.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 12ms (Views: 0.2ms | ActiveRecord: 1.5ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$iSqsoyom4J2XQ/o6wJsLzeY1RWzfQMVHzsbEmZBYTbpNuKv6zzmgC"], ["created_at", "2018-11-29 17:03:00.070598"], ["updated_at", "2018-11-29 17:03:00.070598"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$QqFSXrNdw7Es2pYRethG0u116vlMG6QxofGLN8UvkRnhdR3DGOx1G"], ["created_at", "2018-11-29 17:03:00.076445"], ["updated_at", "2018-11-29 17:03:00.076445"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:03:00.078546"], ["updated_at", "2018-11-29 17:03:00.078546"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:03:00 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:03:00.096921"], ["updated_at", "2018-11-29 17:03:00.096921"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (6.7ms)
  Rendered comments/_comment.json.jbuilder (8.2ms)
  Rendered comments/create.json.jbuilder (13.1ms)
Completed 200 OK in 26ms (Views: 15.7ms | ActiveRecord: 1.2ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$Ln2cf2rt2Bnp1hVuMdaeLuBI/5ZBkuEzh/HMbR4ylPOoIR5dNLpda"], ["created_at", "2018-11-29 17:03:00.128700"], ["updated_at", "2018-11-29 17:03:00.128700"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:03:00.133014"], ["updated_at", "2018-11-29 17:03:00.133014"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:03:00 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"2"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.3ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 403 Forbidden in 3ms (Views: 0.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$x4GAPHRwpO8d9rDLtNSdg.p.76fWPiM0zfPzsUvGt59xkV0HquRkG"], ["created_at", "2018-11-29 17:03:00.157564"], ["updated_at", "2018-11-29 17:03:00.157564"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:03:00.166615"], ["updated_at", "2018-11-29 17:03:00.166615"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$4WJn/gpx0uy.Ol6gjVczguo4KSoQSuhjlC8KNPQEomlMruPsYa2i6"], ["created_at", "2018-11-29 17:03:00.179320"], ["updated_at", "2018-11-29 17:03:00.179320"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:03:00.188583"], ["updated_at", "2018-11-29 17:03:00.188583"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:03:00 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.1ms)
  Rendered comments/_comment.json.jbuilder (3.0ms)
  Rendered comments/index.json.jbuilder (6.4ms)
Completed 200 OK in 11ms (Views: 6.5ms | ActiveRecord: 0.5ms)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (2.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$K4D8G3L.zRUGMtXjGfJob.F9eHLuhPYdm0q5PCIcQWCSB7WUZMtai"], ["created_at", "2018-11-29 17:03:00.220038"], ["updated_at", "2018-11-29 17:03:00.220038"], ["username", "person10"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$N7pl8SbzyCp2VUi7GRF2E..oNUa8sa0.aqw9xSVsotFH3fajprZI6"], ["created_at", "2018-11-29 17:03:00.229864"], ["updated_at", "2018-11-29 17:03:00.229864"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$pV6i5kwLoOToW9su8p1ywutoKU8XHRXQmqq1ydgT8gLOd5UeEg4ZC"], ["created_at", "2018-11-29 17:03:00.235399"], ["updated_at", "2018-11-29 17:03:00.235399"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:03:00.238810"], ["updated_at", "2018-11-29 17:03:00.238810"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.6ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.8ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:03:00.243190"], ["updated_at", "2018-11-29 17:03:00.243190"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:03:00 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 8ms (Views: 0.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$4Z5MTCqMI9gDWv.jwAozOu0.iO3KvoqeTQauOz8KvTj.B8xbZswLm"], ["created_at", "2018-11-29 17:03:00.275599"], ["updated_at", "2018-11-29 17:03:00.275599"], ["username", "person13"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$faWvVBBtWNZBQtZ.N3pupevYT9Yz62SeDHpnYsSjp1mmWxxGSph32"], ["created_at", "2018-11-29 17:03:00.290583"], ["updated_at", "2018-11-29 17:03:00.290583"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$BDfqigKLUeH29WJmsr9eLOtpiRPY1JNgqEzIVlwC2R6yHh0P2eqou"], ["created_at", "2018-11-29 17:03:00.309715"], ["updated_at", "2018-11-29 17:03:00.309715"], ["username", "person15"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:03:00.319698"], ["updated_at", "2018-11-29 17:03:00.319698"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$n.Nzr0LYxYZ/412gPDK/Huu9oa/AEqKsDZZd.7lh4I06HNFCAxqFS"], ["created_at", "2018-11-29 17:04:54.608059"], ["updated_at", "2018-11-29 17:04:54.608059"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:04:54.616102"], ["updated_at", "2018-11-29 17:04:54.616102"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:04:54 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"2"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 403 Forbidden in 5ms (Views: 0.3ms | ActiveRecord: 0.1ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$JLdxi1U4voqoaNRQSho0mOPEioXA0s/JB0hSVKewrcRd9Pmb9zI12"], ["created_at", "2018-11-29 17:04:54.707466"], ["updated_at", "2018-11-29 17:04:54.707466"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$29JSLczcMf/H/iEbMMDouOuofkhZXj6gNI/zhyeAyv21FpuPYe91q"], ["created_at", "2018-11-29 17:04:54.715690"], ["updated_at", "2018-11-29 17:04:54.715690"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:04:54.721834"], ["updated_at", "2018-11-29 17:04:54.721834"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.5ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:04:54.734759"], ["updated_at", "2018-11-29 17:04:54.734759"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:04:54 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.2ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.6ms)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$xQTukiagrJMhMKynlkvA9e/SJKYZsUUmfJ6rXBNdAGkmtBrtXtI6i"], ["created_at", "2018-11-29 17:04:54.761531"], ["updated_at", "2018-11-29 17:04:54.761531"], ["username", "person4"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$rcS0LsvrPH/AMcKvotNU3uVSVTknwQjCkpeFclM7lGW5YEKIMjsdG"], ["created_at", "2018-11-29 17:04:54.766027"], ["updated_at", "2018-11-29 17:04:54.766027"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.9ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:04:54.772275"], ["updated_at", "2018-11-29 17:04:54.772275"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.5ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:04:54.783675"], ["updated_at", "2018-11-29 17:04:54.783675"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:04:54 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$V07xKW6AKCZovF.534o21uNIFVvmOoHeJC24eY0.k.d69mCGOWH0a"], ["created_at", "2018-11-29 17:04:54.804533"], ["updated_at", "2018-11-29 17:04:54.804533"], ["username", "person6"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$.JtyuZkSKNCyQwJ2.0LUHOC8RgCKH8JtC4QJyAqJxwA2IuIn5Ujim"], ["created_at", "2018-11-29 17:04:54.809985"], ["updated_at", "2018-11-29 17:04:54.809985"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$328bFoWTYxBd0eYIRUezXOh7bn62ApEVDnRcfCJnGBXlG6XzzNo3i"], ["created_at", "2018-11-29 17:04:54.814313"], ["updated_at", "2018-11-29 17:04:54.814313"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:04:54.816220"], ["updated_at", "2018-11-29 17:04:54.816220"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.7ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:04:54.821890"], ["updated_at", "2018-11-29 17:04:54.821890"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:04:54 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 2ms (Views: 0.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$dyH9FAgGSPreUgZ9nMDs6.rxGOg6Mq9zkBQHSfEoauFdQlA2U/8xq"], ["created_at", "2018-11-29 17:04:54.841925"], ["updated_at", "2018-11-29 17:04:54.841925"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$P7jS1YokITqQ0Sdxof/V2O.E7sYQDDh5oIKVL1qzAReHCp8iLqQXO"], ["created_at", "2018-11-29 17:04:54.849032"], ["updated_at", "2018-11-29 17:04:54.849032"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.8ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:04:54.854036"], ["updated_at", "2018-11-29 17:04:54.854036"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.5ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:04:54 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:04:54.874249"], ["updated_at", "2018-11-29 17:04:54.874249"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (8.8ms)
  Rendered comments/_comment.json.jbuilder (10.7ms)
  Rendered comments/create.json.jbuilder (15.8ms)
Completed 200 OK in 31ms (Views: 20.2ms | ActiveRecord: 1.6ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$edfvmlRSEoIqSjShs1BZ/Oxb5ZnxEaN72/9FtZcV6p.ERhJ7VMeIe"], ["created_at", "2018-11-29 17:04:54.909848"], ["updated_at", "2018-11-29 17:04:54.909848"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:04:54.914244"], ["updated_at", "2018-11-29 17:04:54.914244"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$uJHUbhTu5NaZ9uK3e2x2H.pkh1b.46Ax5fgLGbghPAj/a9XZBes6."], ["created_at", "2018-11-29 17:04:54.928177"], ["updated_at", "2018-11-29 17:04:54.928177"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:04:54.930460"], ["updated_at", "2018-11-29 17:04:54.930460"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:04:54 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.1ms)
  Rendered comments/_comment.json.jbuilder (3.0ms)
  Rendered comments/index.json.jbuilder (5.7ms)
Completed 200 OK in 10ms (Views: 6.3ms | ActiveRecord: 0.3ms)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$ru4MPwfFd9/mSyQIv5i3/.u8/jPVUsDZ9JfnaFUOPFIH3.gu/ZVVO"], ["created_at", "2018-11-29 17:04:54.959195"], ["updated_at", "2018-11-29 17:04:54.959195"], ["username", "person13"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$q2DBV6C1iLdoN6qtcepp9e7T3FcfE2sXWyurId1sI6LE6f/LrX0xC"], ["created_at", "2018-11-29 17:04:54.981392"], ["updated_at", "2018-11-29 17:04:54.981392"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:04:54.985132"], ["updated_at", "2018-11-29 17:04:54.985132"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$Ll2i/nHzTp3EOTDNOYCu5eYUJ/FLYvFWMI9zV69/hgpwQhUWVoeOi"], ["created_at", "2018-11-29 17:04:54.995818"], ["updated_at", "2018-11-29 17:04:54.995818"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$HA3mV1CTjXss9cfOM89OC.oDQfhAj8bDVdd6W4IvjCWl4TzfqawmG"], ["created_at", "2018-11-29 17:06:30.420393"], ["updated_at", "2018-11-29 17:06:30.420393"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:06:30.428604"], ["updated_at", "2018-11-29 17:06:30.428604"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:06:30 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"2"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 403 Forbidden in 5ms (Views: 0.3ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$5888rZXD2lBwbOY6bNTPdO4Dy1UwavydE4Nw0uISgZjQrSdf0kooK"], ["created_at", "2018-11-29 17:06:30.522965"], ["updated_at", "2018-11-29 17:06:30.522965"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$JgHm1Ywg6Dkz./ssD5iuJelwuVJaTkJwMJBr1g3r/f6NnExvh0XLW"], ["created_at", "2018-11-29 17:06:30.531103"], ["updated_at", "2018-11-29 17:06:30.531103"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:06:30.534483"], ["updated_at", "2018-11-29 17:06:30.534483"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:06:30 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:06:30.565614"], ["updated_at", "2018-11-29 17:06:30.565614"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (16.0ms)
  Rendered comments/_comment.json.jbuilder (17.3ms)
  Rendered comments/create.json.jbuilder (21.1ms)
Completed 200 OK in 53ms (Views: 22.9ms | ActiveRecord: 1.9ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$QFs6x2VGc/apDJNtt0nNMOYHt1uQLL.0ZZbkDS/x9KSr17JiIxM/O"], ["created_at", "2018-11-29 17:06:30.603146"], ["updated_at", "2018-11-29 17:06:30.603146"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$OHUPTpAsBqgqTXzZXldtU.s2LTiDqgCrhvM2iG1fNAjV5s396J/nS"], ["created_at", "2018-11-29 17:06:30.608527"], ["updated_at", "2018-11-29 17:06:30.608527"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$IMsuIgw9cp6xbb79DeoXxOOfNsL0ekFQGoJT.gXnxXxbuFhYxFR5i"], ["created_at", "2018-11-29 17:06:30.617319"], ["updated_at", "2018-11-29 17:06:30.617319"], ["username", "person6"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:06:30.622635"], ["updated_at", "2018-11-29 17:06:30.622635"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:06:30.625621"], ["updated_at", "2018-11-29 17:06:30.625621"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:06:30 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 2ms (Views: 0.2ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$gn/8aaaRYBCKLHZHuPsbd.4K110kJxMwxDS9oTDFBHZJSLVJ.1lZ2"], ["created_at", "2018-11-29 17:06:30.640400"], ["updated_at", "2018-11-29 17:06:30.640400"], ["username", "person7"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$D9xrds4sgTVOlF34H.gfMu6UEzDLOKTqzjwY.mEzuc0zyl4gMabMC"], ["created_at", "2018-11-29 17:06:30.648680"], ["updated_at", "2018-11-29 17:06:30.648680"], ["username", "person8"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:06:30.656168"], ["updated_at", "2018-11-29 17:06:30.656168"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:06:30.659172"], ["updated_at", "2018-11-29 17:06:30.659172"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:06:30 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$QOWZW8FLXepNS1mIehCKhe0sDtfvGEUEDLS8xxjvgULw07idZEOZW"], ["created_at", "2018-11-29 17:06:30.675272"], ["updated_at", "2018-11-29 17:06:30.675272"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$JaaGaxwWLD1/Sj3t4HQX8efKzwRZAdwNNjuKowpuUX8RyyWfwhqqG"], ["created_at", "2018-11-29 17:06:30.682941"], ["updated_at", "2018-11-29 17:06:30.682941"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:06:30.686802"], ["updated_at", "2018-11-29 17:06:30.686802"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:06:30.692186"], ["updated_at", "2018-11-29 17:06:30.692186"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:06:30 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$z9AbFnwpuFKAN4RtbK6oXe0iPegV1mnEVWYEJNmgzF65erTlv6qES"], ["created_at", "2018-11-29 17:06:30.714544"], ["updated_at", "2018-11-29 17:06:30.714544"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:06:30.718449"], ["updated_at", "2018-11-29 17:06:30.718449"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$F5XXWBwDyiNgLGyVW8rWr.ncQVaCSKd.kAhPuZkzT9zLKm7TC7B6C"], ["created_at", "2018-11-29 17:06:30.729562"], ["updated_at", "2018-11-29 17:06:30.729562"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:06:30.731584"], ["updated_at", "2018-11-29 17:06:30.731584"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:06:30 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.1ms)
  Rendered comments/_comment.json.jbuilder (2.7ms)
  Rendered comments/index.json.jbuilder (5.3ms)
Completed 200 OK in 9ms (Views: 5.4ms | ActiveRecord: 0.3ms)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$lxmmodn3R62s3YWgRSTQHuyFS8CNKFtiFdstZbxNMjlKMrJz9JLz."], ["created_at", "2018-11-29 17:06:30.768596"], ["updated_at", "2018-11-29 17:06:30.768596"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:06:30.772969"], ["updated_at", "2018-11-29 17:06:30.772969"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$DrqPXZIfpiJD6WzrIKaga.M1IlefA/pypMPMYaBpw0Njg04GjOrn6"], ["created_at", "2018-11-29 17:06:30.789663"], ["updated_at", "2018-11-29 17:06:30.789663"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$Fjw4etTxvAeKnLsSAwtsz.FqsHlX9EcmMgW8ZLuW70umoI4HthpIa"], ["created_at", "2018-11-29 17:06:30.825898"], ["updated_at", "2018-11-29 17:06:30.825898"], ["username", "person15"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$bCYzofvklc5hSWzZ.uqkxuBTc1gX36ZRuNqw5PqOayisgDqvLcIgm"], ["created_at", "2018-11-29 17:08:56.192406"], ["updated_at", "2018-11-29 17:08:56.192406"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$j.tDfOAXSCDflH3OsAHjfehbxORfnpNMiXS44A4gztQme9pK0M7JO"], ["created_at", "2018-11-29 17:08:56.203124"], ["updated_at", "2018-11-29 17:08:56.203124"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$pbb9gaSpf7EVhUKGVffFO.qQiPyZ8DRFYa/3U8dGVP8qFAsoJ2ByO"], ["created_at", "2018-11-29 17:08:56.243739"], ["updated_at", "2018-11-29 17:08:56.243739"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:08:56.251398"], ["updated_at", "2018-11-29 17:08:56.251398"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:08:56.280722"], ["updated_at", "2018-11-29 17:08:56.280722"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:08:56 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 16ms (Views: 0.3ms | ActiveRecord: 0.3ms)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$ZvvcCWKsiRsQYNp65jsopu4K.ppy9WY/Juo/icMK7uH0Sk2SqdWYy"], ["created_at", "2018-11-29 17:08:56.406639"], ["updated_at", "2018-11-29 17:08:56.406639"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$4O3sp9ztinL439HOXyRNrOTDa.MXEULoFkbxkLGKHRreKt5ZWAcue"], ["created_at", "2018-11-29 17:08:56.416063"], ["updated_at", "2018-11-29 17:08:56.416063"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:08:56.418397"], ["updated_at", "2018-11-29 17:08:56.418397"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:08:56.425216"], ["updated_at", "2018-11-29 17:08:56.425216"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:08:56 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$SCH9Zx0h1jotxggtBXg4BO05OgG5Jl9LxtNyVzi8cjzuA/8ZUM4Ku"], ["created_at", "2018-11-29 17:08:56.443355"], ["updated_at", "2018-11-29 17:08:56.443355"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:08:56.449160"], ["updated_at", "2018-11-29 17:08:56.449160"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.6ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$2h3M2yXCNctMOwKHxClzpODCnQi40.YfjE6woJaAn3RPk803c24Ny"], ["created_at", "2018-11-29 17:08:56.462259"], ["updated_at", "2018-11-29 17:08:56.462259"], ["username", "person7"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (1.0ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:08:56.469065"], ["updated_at", "2018-11-29 17:08:56.469065"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:08:56 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.3ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.9ms)
  Rendered comments/_comment.json.jbuilder (4.7ms)
  Rendered comments/index.json.jbuilder (10.6ms)
Completed 200 OK in 20ms (Views: 13.7ms | ActiveRecord: 0.7ms)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$UpWcsyakSHdgkKlFOPw6Qu6YkaAnS/L/xLb7RYg5degGInF/t2diq"], ["created_at", "2018-11-29 17:08:56.505549"], ["updated_at", "2018-11-29 17:08:56.505549"], ["username", "person8"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$sXHj9NIptzlUPSvaGWmCiOfn54aNWHkOb.SVsE1XfVlkVfVaeWRki"], ["created_at", "2018-11-29 17:08:56.515135"], ["updated_at", "2018-11-29 17:08:56.515135"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.7ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:08:56.519129"], ["updated_at", "2018-11-29 17:08:56.519129"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:08:56.523601"], ["updated_at", "2018-11-29 17:08:56.523601"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:08:56 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.3ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (2.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$/J1cBCPOtCBCSxKOQnXghOZSjAp48wlYLkpMjBTQqsHIYG4CbmH5i"], ["created_at", "2018-11-29 17:08:56.551474"], ["updated_at", "2018-11-29 17:08:56.551474"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$KbUDxPmQYlhTnIaRrmVBWO1EFQKVyAeFX.RtN6vi3hpnMxLSb2kda"], ["created_at", "2018-11-29 17:08:56.563852"], ["updated_at", "2018-11-29 17:08:56.563852"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.6ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:08:56.567096"], ["updated_at", "2018-11-29 17:08:56.567096"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:08:56 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:08:56.595295"], ["updated_at", "2018-11-29 17:08:56.595295"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (9.6ms)
  Rendered comments/_comment.json.jbuilder (11.0ms)
  Rendered comments/create.json.jbuilder (13.6ms)
Completed 200 OK in 28ms (Views: 13.4ms | ActiveRecord: 2.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (1.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$jAtRokFP035JN/Y1GW5nxODACazNQPqpkZfP.lc1tK5jFLagMcmPe"], ["created_at", "2018-11-29 17:08:56.624486"], ["updated_at", "2018-11-29 17:08:56.624486"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:08:56.629965"], ["updated_at", "2018-11-29 17:08:56.629965"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:08:56 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"2"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 403 Forbidden in 3ms (Views: 0.2ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$G3nJplVW43zxVYz8pr/AeOdhd/7PLQ65Oxm6usHY38E3msXK4jx3u"], ["created_at", "2018-11-29 17:08:56.662733"], ["updated_at", "2018-11-29 17:08:56.662733"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$TKPSDNiayFnUCjaYT3W8ve87M5.cnxxOUTL2QIrvpMaEhpkI01dwO"], ["created_at", "2018-11-29 17:08:56.690081"], ["updated_at", "2018-11-29 17:08:56.690081"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$L0A0F1Xqm6K4VsaVTQh.ReEibI.HDRk8mSRRcaX.01digrnBLW1G."], ["created_at", "2018-11-29 17:08:56.706463"], ["updated_at", "2018-11-29 17:08:56.706463"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:08:56.712357"], ["updated_at", "2018-11-29 17:08:56.712357"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$ysFwJwH5vTsJ2Vo6HGhUQux.aCne/41JDk056CltVdqeQ5fw49eNC"], ["created_at", "2018-11-29 17:09:47.458890"], ["updated_at", "2018-11-29 17:09:47.458890"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$bJro.TSqt94vb8/lBNYqh.8Xlh/15HWBaSdaPsad0fggrd6smC3YS"], ["created_at", "2018-11-29 17:09:47.514361"], ["updated_at", "2018-11-29 17:09:47.514361"], ["username", "person2"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.8ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:09:47.519300"], ["updated_at", "2018-11-29 17:09:47.519300"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$MIjDnnf.VMbM.jQBmEHZw.CCGDM5BnSKPQ5J8QfAxdNvmBvhoI6dK"], ["created_at", "2018-11-29 17:09:47.549426"], ["updated_at", "2018-11-29 17:09:47.549426"], ["username", "person3"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$0HPTEjyd9Nei2TFaRMNVxOhpatCy.WI6v4SxgD4B44QIjZvk9ZvhS"], ["created_at", "2018-11-29 17:09:47.721423"], ["updated_at", "2018-11-29 17:09:47.721423"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$y3NxVmvaxWPNVYdOQ/Dy5uD30Pwm4bzh9RVVXKTbAxftr2UqWNxe2"], ["created_at", "2018-11-29 17:09:47.727852"], ["updated_at", "2018-11-29 17:09:47.727852"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:09:47.731114"], ["updated_at", "2018-11-29 17:09:47.731114"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:09:47 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:09:47.818671"], ["updated_at", "2018-11-29 17:09:47.818671"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (5.2ms)
  Rendered comments/_comment.json.jbuilder (6.4ms)
  Rendered comments/create.json.jbuilder (10.0ms)
Completed 200 OK in 25ms (Views: 12.2ms | ActiveRecord: 1.1ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$PEqAM4GlRugXJrrMDVU5he2vLNw8NKOl2nAvMkt.IChZ7ovP5oEcG"], ["created_at", "2018-11-29 17:09:47.846009"], ["updated_at", "2018-11-29 17:09:47.846009"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$mfFqCKDGyTyUukkPCyKfa.R7DRaqTl59M18Me1X/fcTj/DADSgDZG"], ["created_at", "2018-11-29 17:09:47.851795"], ["updated_at", "2018-11-29 17:09:47.851795"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:09:47.853650"], ["updated_at", "2018-11-29 17:09:47.853650"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:09:47.856079"], ["updated_at", "2018-11-29 17:09:47.856079"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:09:47 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$tZqrB22qNpwc49nAnrBxTeuE4RbVjpRI8Lu2G4k46SDq.zF.BdmG2"], ["created_at", "2018-11-29 17:09:47.868766"], ["updated_at", "2018-11-29 17:09:47.868766"], ["username", "person8"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:09:47.879507"], ["updated_at", "2018-11-29 17:09:47.879507"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$EY0vHxM30lGrJdqXL/s.wuaNyP6zb/gJaN4GBW4vjoYbRkT5TbMti"], ["created_at", "2018-11-29 17:09:47.887494"], ["updated_at", "2018-11-29 17:09:47.887494"], ["username", "person9"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:09:47.894734"], ["updated_at", "2018-11-29 17:09:47.894734"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:09:47 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.1ms)
  Rendered comments/_comment.json.jbuilder (2.1ms)
  Rendered comments/index.json.jbuilder (4.4ms)
Completed 200 OK in 8ms (Views: 4.5ms | ActiveRecord: 0.3ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$Lq7hXz1eMjC0.vxuJg3MgegDLJB95Zmm4iWIJeCyh39Ff2MSRvE/m"], ["created_at", "2018-11-29 17:09:47.914079"], ["updated_at", "2018-11-29 17:09:47.914079"], ["username", "person10"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$CqceXMcxhf6FWHvrA9OUteCeZuN3dapostL60tQcXxmQfS6zGhHTu"], ["created_at", "2018-11-29 17:09:47.923152"], ["updated_at", "2018-11-29 17:09:47.923152"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:09:47.925126"], ["updated_at", "2018-11-29 17:09:47.925126"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:09:47.927605"], ["updated_at", "2018-11-29 17:09:47.927605"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:09:47 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.2ms | ActiveRecord: 0.5ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$RgH2DkX7YkZKZ6wn/LZbB.jNhKcI.qJYaMJX7HujAFUHVN2Em27fq"], ["created_at", "2018-11-29 17:09:47.950065"], ["updated_at", "2018-11-29 17:09:47.950065"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$pj.USKyoxbHIixSh4r8RkOEdvz4AVAldrhBHCczGVLS9CGyf82tWG"], ["created_at", "2018-11-29 17:09:47.954966"], ["updated_at", "2018-11-29 17:09:47.954966"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$tS7lPZSz/Y1pLQpNwRGTL.VNGY5QwjvvROucLjhKiASIAG/7f28GS"], ["created_at", "2018-11-29 17:09:47.958862"], ["updated_at", "2018-11-29 17:09:47.958862"], ["username", "person14"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:09:47.960871"], ["updated_at", "2018-11-29 17:09:47.960871"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:09:47.963533"], ["updated_at", "2018-11-29 17:09:47.963533"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:09:47 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 3ms (Views: 0.5ms | ActiveRecord: 0.4ms)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$qcYJZoon42Y6UP6YrmiNj.6y9wx5N9qt1RGps/o/o/J4QZ19QYHKy"], ["created_at", "2018-11-29 17:09:47.985310"], ["updated_at", "2018-11-29 17:09:47.985310"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:09:47.989044"], ["updated_at", "2018-11-29 17:09:47.989044"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:09:47 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.1ms)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$a8gSRcnucI1T4kzYdCitMODx7ZsfcljEs.zPQhIYdDBo1vIdCu9La"], ["created_at", "2018-11-29 17:12:15.968894"], ["updated_at", "2018-11-29 17:12:15.968894"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$44vNQJ4eR0HhsxvbrIKpAOrRiYOphrdBa8TkFTTaWEsr..QTpDT3G"], ["created_at", "2018-11-29 17:12:16.000221"], ["updated_at", "2018-11-29 17:12:16.000221"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:12:16.007736"], ["updated_at", "2018-11-29 17:12:16.007736"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:12:16 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:12:16.107403"], ["updated_at", "2018-11-29 17:12:16.107403"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (5.4ms)
  Rendered comments/_comment.json.jbuilder (6.7ms)
  Rendered comments/create.json.jbuilder (10.4ms)
Completed 200 OK in 36ms (Views: 12.9ms | ActiveRecord: 1.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$9gl2pi9WV6eVDGEVy8vw2.vcCxgNGTSoHtuY/KpTl7TbQXkbEJc0y"], ["created_at", "2018-11-29 17:12:16.136114"], ["updated_at", "2018-11-29 17:12:16.136114"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:12:16.139941"], ["updated_at", "2018-11-29 17:12:16.139941"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$krg8dCgZ.IVoLqewm/gWj.F57IzgYc/fasCCrWeOdx5.rUa4CtNW2"], ["created_at", "2018-11-29 17:12:16.145606"], ["updated_at", "2018-11-29 17:12:16.145606"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:12:16.147132"], ["updated_at", "2018-11-29 17:12:16.147132"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:12:16 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.5ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.1ms)
  Rendered comments/_comment.json.jbuilder (2.1ms)
  Rendered comments/index.json.jbuilder (7.1ms)
Completed 200 OK in 14ms (Views: 7.6ms | ActiveRecord: 0.7ms)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$Zu/1g8LRWHJrBKqW0vfur.PDF6P6Tk82AxIacZrdcEg26Fz1iuphu"], ["created_at", "2018-11-29 17:12:16.172459"], ["updated_at", "2018-11-29 17:12:16.172459"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$FO3HJv7dJNRESft/aOaCZOIgrELOFusQL6ZMq.o6bFuoIKE7s5MLa"], ["created_at", "2018-11-29 17:12:16.178111"], ["updated_at", "2018-11-29 17:12:16.178111"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$o1Ld4xaOP/h7bZhltBe3DOZwRrfNRBuvaqF4qJhiD0pJWherf3mwa"], ["created_at", "2018-11-29 17:12:16.183003"], ["updated_at", "2018-11-29 17:12:16.183003"], ["username", "person7"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:12:16.191689"], ["updated_at", "2018-11-29 17:12:16.191689"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:12:16.197102"], ["updated_at", "2018-11-29 17:12:16.197102"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:12:16 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 3ms (Views: 0.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$GTqfQzX4ZEm1IAGW7tJ0.OSp0uEUJ4ORmyFBf3Xou.SEIrbWqSyO."], ["created_at", "2018-11-29 17:12:16.217364"], ["updated_at", "2018-11-29 17:12:16.217364"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:12:16.221533"], ["updated_at", "2018-11-29 17:12:16.221533"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.6ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:12:16 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.7ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.7ms)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.7ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$Tc9CjlllqKASroOLu4EksuD0S4NK3P8ihQdRo0ScXOJtEXfvpUjgi"], ["created_at", "2018-11-29 17:12:16.245747"], ["updated_at", "2018-11-29 17:12:16.245747"], ["username", "person9"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$18TB/wIH5H36bHTS51fNI.9eR6TWlDqmoCcAfkNvuVHERdWo2uWY2"], ["created_at", "2018-11-29 17:12:16.257001"], ["updated_at", "2018-11-29 17:12:16.257001"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:12:16.259708"], ["updated_at", "2018-11-29 17:12:16.259708"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:12:16.263455"], ["updated_at", "2018-11-29 17:12:16.263455"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:12:16 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$f0A19ByQrjh2KHXbbbciT.GxoVGVoDZzXfH3wtypYMmGdUcHT28Vq"], ["created_at", "2018-11-29 17:12:16.287799"], ["updated_at", "2018-11-29 17:12:16.287799"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$CB7nQUdKC2qJ9lGVRFdNWexMZbOop15TzECXYRZfJTfKjjNXBCFnq"], ["created_at", "2018-11-29 17:12:16.296287"], ["updated_at", "2018-11-29 17:12:16.296287"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.1ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:12:16.302925"], ["updated_at", "2018-11-29 17:12:16.302925"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:12:16.316974"], ["updated_at", "2018-11-29 17:12:16.316974"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:12:16 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 0.5ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$JeSAvYAh3smYgzDC5j4D.ujwol6rQlBg2Qh5lFbmZGpuM5tudUtZW"], ["created_at", "2018-11-29 17:12:16.346255"], ["updated_at", "2018-11-29 17:12:16.346255"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:12:16.351054"], ["updated_at", "2018-11-29 17:12:16.351054"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$MkaRA9.wc.A2cAAn3xTZ3eo84m9yVzMlzdYrzpeA./t33kwLOvwC2"], ["created_at", "2018-11-29 17:12:16.361525"], ["updated_at", "2018-11-29 17:12:16.361525"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$EwGr2zohjEfsUuWrRKUVg.6GdkNbPYrMBUhkgrBCJ9CMHFab1pF32"], ["created_at", "2018-11-29 17:12:16.383985"], ["updated_at", "2018-11-29 17:12:16.383985"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$6OfhN67hi8m3paQSwQvOaOTf1E1AjlHf84Gc/UK1ttp6teJhvG1eC"], ["created_at", "2018-11-29 17:12:42.487224"], ["updated_at", "2018-11-29 17:12:42.487224"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$BKQVGDtYYD.W/e/eS2OE7eRpmgm44wvRsbFy/z/lq2yb09/JYrQ7S"], ["created_at", "2018-11-29 17:12:42.540104"], ["updated_at", "2018-11-29 17:12:42.540104"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:12:42.544164"], ["updated_at", "2018-11-29 17:12:42.544164"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$AVtDxlPAmTxZvA7DSVRdlOHB0CdnJMOeYvBZlaDnbk8KJBIKDRjF2"], ["created_at", "2018-11-29 17:12:42.588459"], ["updated_at", "2018-11-29 17:12:42.588459"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$wzfaniUY7m.zksUKBkybGuhzTv.IXtoohTWlij9/jGgbhJwSpa/bq"], ["created_at", "2018-11-29 17:12:42.741409"], ["updated_at", "2018-11-29 17:12:42.741409"], ["username", "person4"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$fPEBnIuidmVJVtoPN23yJuSLd2Xxfqb9My.HyygccZPt6HV9b8NVu"], ["created_at", "2018-11-29 17:12:42.745851"], ["updated_at", "2018-11-29 17:12:42.745851"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:12:42.747800"], ["updated_at", "2018-11-29 17:12:42.747800"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:12:42.750163"], ["updated_at", "2018-11-29 17:12:42.750163"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:12:42 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 3ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$PYoP6BjCY4M4fcq4RGSWzuyLneWPOD3PxYaZBKwArW9O2P1mJ8CTq"], ["created_at", "2018-11-29 17:12:42.828099"], ["updated_at", "2018-11-29 17:12:42.828099"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:12:42.831538"], ["updated_at", "2018-11-29 17:12:42.831538"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$49qcTo4AmlPS5bvTZznEkO1bv89GgtV9DKiwBKidA4FRwq3OUBkdy"], ["created_at", "2018-11-29 17:12:42.837480"], ["updated_at", "2018-11-29 17:12:42.837480"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:12:42.839074"], ["updated_at", "2018-11-29 17:12:42.839074"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:12:42 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.7ms)
  Rendered comments/_comment.json.jbuilder (4.2ms)
  Rendered comments/index.json.jbuilder (11.0ms)
Completed 200 OK in 24ms (Views: 17.2ms | ActiveRecord: 0.5ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$aA8uT.HgWgQBx8o507y2d.BgZBPABvXl9qSkiL2x/lZKpJHTkc5Ai"], ["created_at", "2018-11-29 17:12:42.871976"], ["updated_at", "2018-11-29 17:12:42.871976"], ["username", "person8"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$5ehvepAF4w/9a6FkHAGtTuvFlAYeANUvaYH6jNSOB082cAB89QvgS"], ["created_at", "2018-11-29 17:12:42.882003"], ["updated_at", "2018-11-29 17:12:42.882003"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:12:42.886409"], ["updated_at", "2018-11-29 17:12:42.886409"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:12:42.890184"], ["updated_at", "2018-11-29 17:12:42.890184"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:12:42 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.5ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.3ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.1ms | ActiveRecord: 1.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$NU3IE2x5laIiLAW/nAOWceUFc96mjnXnEXXf5I.mL4pIg/6k0F5z."], ["created_at", "2018-11-29 17:12:42.917825"], ["updated_at", "2018-11-29 17:12:42.917825"], ["username", "person10"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$KnLLLPkbvTDaf2Yw1pEniuCyzml6zKj8r5jolE6C6WCi4Fj6DfyCy"], ["created_at", "2018-11-29 17:12:42.924598"], ["updated_at", "2018-11-29 17:12:42.924598"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.7ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:12:42.928629"], ["updated_at", "2018-11-29 17:12:42.928629"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:12:42 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:12:42.948185"], ["updated_at", "2018-11-29 17:12:42.948185"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (8.5ms)
  Rendered comments/_comment.json.jbuilder (9.6ms)
  Rendered comments/create.json.jbuilder (11.1ms)
Completed 200 OK in 22ms (Views: 11.0ms | ActiveRecord: 1.5ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$o00LYeF6F/D9cNro56ZYGu.rbMJ33.9fO.heptcIZ/Poh/8JT1uMC"], ["created_at", "2018-11-29 17:12:42.975292"], ["updated_at", "2018-11-29 17:12:42.975292"], ["username", "person12"]]
  [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.8ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:12:42.981284"], ["updated_at", "2018-11-29 17:12:42.981284"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:12:42 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.2ms)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$cbrDpkf2YzxgPlLCffiWyeRXNAn0MYVwl38fi6pcBa8uyUWVAoo9e"], ["created_at", "2018-11-29 17:12:43.011702"], ["updated_at", "2018-11-29 17:12:43.011702"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$GIcTBtSm594gnfwgl3ViP.TBKzbm.GdkKzDHrxc6DYzFgujmEUy5K"], ["created_at", "2018-11-29 17:12:43.018786"], ["updated_at", "2018-11-29 17:12:43.018786"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$OpO3OI/ksB3U5kE0XtszXu83EXRjUu/JzqkyVRiqu9toW3f8V9cIW"], ["created_at", "2018-11-29 17:12:43.023074"], ["updated_at", "2018-11-29 17:12:43.023074"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:12:43.027865"], ["updated_at", "2018-11-29 17:12:43.027865"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.5ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (1.1ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:12:43.041618"], ["updated_at", "2018-11-29 17:12:43.041618"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:12:43 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 2ms (Views: 0.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$xUaoEnWfFyzfaeMGrEuLsOD4TcZ3JXKc6GxfPORCRb7clWniwcMNS"], ["created_at", "2018-11-29 17:14:15.832995"], ["updated_at", "2018-11-29 17:14:15.832995"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$twvuVvR.6hwcRj7kxdyH7.6o63agavXZdewki7hm4djbS0JsietSa"], ["created_at", "2018-11-29 17:14:15.864373"], ["updated_at", "2018-11-29 17:14:15.864373"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:14:15.874969"], ["updated_at", "2018-11-29 17:14:15.874969"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:14:15 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 27ms (Views: 0.3ms | ActiveRecord: 0.7ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$9lO5J2OhiBMJk8jGafXbYOcAThxz74vAU18NPEBpG9i9.qyGPgWd6"], ["created_at", "2018-11-29 17:14:15.984800"], ["updated_at", "2018-11-29 17:14:15.984800"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$PuqaI2APivmHaUJhb/aTPeK0obKc2R3yEKOAliboZE94pkH041/zK"], ["created_at", "2018-11-29 17:14:15.989507"], ["updated_at", "2018-11-29 17:14:15.989507"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$OrT3np6x4c6X6hRq4XhWEexHKIkdcjT4noqu0DRyjt127RY/6B2Qy"], ["created_at", "2018-11-29 17:14:15.997590"], ["updated_at", "2018-11-29 17:14:15.997590"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:14:16.000982"], ["updated_at", "2018-11-29 17:14:16.000982"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:14:16.004605"], ["updated_at", "2018-11-29 17:14:16.004605"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:14:16 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 4ms (Views: 0.6ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (1.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$OWKri9ysyjuiZWTIeD.1dehp2VEX4xVUGYakrNIWT1bYtFMnVDOgK"], ["created_at", "2018-11-29 17:14:16.023996"], ["updated_at", "2018-11-29 17:14:16.023996"], ["username", "person6"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$oNwOS20i03OCVL3lQ5vyK.LSl7VTrk0zqXc5aQGRaqxzn32Py4rla"], ["created_at", "2018-11-29 17:14:16.038713"], ["updated_at", "2018-11-29 17:14:16.038713"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.8ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:14:16.042057"], ["updated_at", "2018-11-29 17:14:16.042057"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:14:16.045963"], ["updated_at", "2018-11-29 17:14:16.045963"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:14:16 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.3ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 10ms (Views: 0.6ms | ActiveRecord: 1.3ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$WwOG76U2THQhAZTGWsoAk.wul82XOMh69ok59lXyPUKI4CHWPsMlO"], ["created_at", "2018-11-29 17:14:16.075177"], ["updated_at", "2018-11-29 17:14:16.075177"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:14:16.079316"], ["updated_at", "2018-11-29 17:14:16.079316"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$jCWZIu1DbW7KDe5nTc8AIenhd4y257V5osi/KI3sfqUiZ4DFhaR3O"], ["created_at", "2018-11-29 17:14:16.087620"], ["updated_at", "2018-11-29 17:14:16.087620"], ["username", "person9"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.5ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:14:16.095223"], ["updated_at", "2018-11-29 17:14:16.095223"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:14:16 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.9ms)
  Rendered comments/_comment.json.jbuilder (4.0ms)
  Rendered comments/index.json.jbuilder (10.3ms)
Completed 200 OK in 19ms (Views: 14.6ms | ActiveRecord: 0.3ms)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$Hj2WUFbOu.FsW72JhsP7d.4uftQgfKoT55xEDfPcpTtfq2wCiIvCS"], ["created_at", "2018-11-29 17:14:16.127506"], ["updated_at", "2018-11-29 17:14:16.127506"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:14:16.138874"], ["updated_at", "2018-11-29 17:14:16.138874"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:14:16 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.1ms)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$ONRlUTXi8D4aALu0hfmOYe5HYk8jmx8ZHSmpclI1wwzFv3UJd3xEe"], ["created_at", "2018-11-29 17:14:16.152053"], ["updated_at", "2018-11-29 17:14:16.152053"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$scwASdBBm2MQeReFkuM3QehvgyNLIomwJ0RWlStfZDl.s2ZpUDPHy"], ["created_at", "2018-11-29 17:14:16.164274"], ["updated_at", "2018-11-29 17:14:16.164274"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:14:16.166787"], ["updated_at", "2018-11-29 17:14:16.166787"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.3ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:14:16.174122"], ["updated_at", "2018-11-29 17:14:16.174122"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:14:16 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$jyVwf5cEviH3lNp1Chrl7eHZwSwjJd3iydIZGh8M2XGc181UrrRMO"], ["created_at", "2018-11-29 17:14:16.192977"], ["updated_at", "2018-11-29 17:14:16.192977"], ["username", "person13"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$K1q9c3Gg7tCLstXw/iXz9.7syiexatxfxmzlFckgfVEEr.gZDpxq6"], ["created_at", "2018-11-29 17:14:16.212217"], ["updated_at", "2018-11-29 17:14:16.212217"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$6Yjejkpj32twpb3TeBsO7uoBBQx4dXVuOMbTo7zHnfGrEuMZB9jf6"], ["created_at", "2018-11-29 17:14:16.222838"], ["updated_at", "2018-11-29 17:14:16.222838"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:14:16.226664"], ["updated_at", "2018-11-29 17:14:16.226664"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$MmS/hb0gsxuXpTIjArSVJOTVtWYfjO13KAujiXv/vf4NDvRZYg6sC"], ["created_at", "2018-11-29 17:15:37.385838"], ["updated_at", "2018-11-29 17:15:37.385838"], ["username", "person1"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:15:37.394902"], ["updated_at", "2018-11-29 17:15:37.394902"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:15:37 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 11ms (ActiveRecord: 0.4ms)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$j2QhIwXfpY19rxKpdXQ.4eyZJWQF7ZL3/RHO/qrx3t6AsgpI7qxGO"], ["created_at", "2018-11-29 17:15:37.520276"], ["updated_at", "2018-11-29 17:15:37.520276"], ["username", "person2"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$djGQGXcy7ot1Dzo89dkGOeNbCUYqoi98axSK/wsPKOCqBQREAmWwq"], ["created_at", "2018-11-29 17:15:37.526590"], ["updated_at", "2018-11-29 17:15:37.526590"], ["username", "person3"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:15:37.528492"], ["updated_at", "2018-11-29 17:15:37.528492"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:15:37.532063"], ["updated_at", "2018-11-29 17:15:37.532063"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:15:37 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.8ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.7ms | ActiveRecord: 1.6ms)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$MBlF42FGiJ9EoYH.G1BT0Oe9YJs3hiXmCXyW2n0P5GtqbC7OAM9WG"], ["created_at", "2018-11-29 17:15:37.559754"], ["updated_at", "2018-11-29 17:15:37.559754"], ["username", "person4"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$6HRRV6UaNu1yyOOUm9pppetk7sCgXGk8FYRCG56j6r580F6ux47C6"], ["created_at", "2018-11-29 17:15:37.567650"], ["updated_at", "2018-11-29 17:15:37.567650"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:15:37.569760"], ["updated_at", "2018-11-29 17:15:37.569760"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.8ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:15:37.576049"], ["updated_at", "2018-11-29 17:15:37.576049"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:15:37 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$5tk23bYERyJQdoYk3b63ZOBHeLUZp6em79VZjYJ1UcGcKHV6622lC"], ["created_at", "2018-11-29 17:15:37.603626"], ["updated_at", "2018-11-29 17:15:37.603626"], ["username", "person6"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$QPFov11soQv4yKLeYiXBGOzKb1YvaEPwuuqlAwS3cXN7lW203ywzS"], ["created_at", "2018-11-29 17:15:37.611689"], ["updated_at", "2018-11-29 17:15:37.611689"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:15:37.613635"], ["updated_at", "2018-11-29 17:15:37.613635"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:15:37 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.9ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:15:37.630362"], ["updated_at", "2018-11-29 17:15:37.630362"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (5.1ms)
  Rendered comments/_comment.json.jbuilder (6.4ms)
  Rendered comments/create.json.jbuilder (10.0ms)
Completed 200 OK in 31ms (Views: 12.3ms | ActiveRecord: 2.4ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$1tyUuEeixuP5cqaSLjYsYuFqfxzqcasUkBao/6fwwsvcfG6fNjJSu"], ["created_at", "2018-11-29 17:15:37.659001"], ["updated_at", "2018-11-29 17:15:37.659001"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$V7F8vyV8RXG0GmG80xOsFuhsQWVSpbrwdN2TxfxTXIZ.b.8PT2U.G"], ["created_at", "2018-11-29 17:15:37.664557"], ["updated_at", "2018-11-29 17:15:37.664557"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$tQQEoLpIJdU6muD0nnl7VOVRs6kpLnDQAeG0GmP1YBzW/HrGK/R1W"], ["created_at", "2018-11-29 17:15:37.668497"], ["updated_at", "2018-11-29 17:15:37.668497"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.5ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:15:37.670956"], ["updated_at", "2018-11-29 17:15:37.670956"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.3ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:15:37.680337"], ["updated_at", "2018-11-29 17:15:37.680337"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:15:37 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 2ms (Views: 0.3ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$OxrztFIKBVpv.QVdpBxP8eN.gVkrj2Y3QsJ8x87tgeCpdcaGJOGWa"], ["created_at", "2018-11-29 17:15:37.694250"], ["updated_at", "2018-11-29 17:15:37.694250"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.5ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:15:37.699772"], ["updated_at", "2018-11-29 17:15:37.699772"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$rs8v9DGlKdJC857i2gGk6uem4VLtSDivFTBNfXnr.bwdmvBl39pJO"], ["created_at", "2018-11-29 17:15:37.711556"], ["updated_at", "2018-11-29 17:15:37.711556"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:15:37.715090"], ["updated_at", "2018-11-29 17:15:37.715090"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:15:37 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.1ms)
  Rendered comments/_comment.json.jbuilder (1.9ms)
  Rendered comments/index.json.jbuilder (4.4ms)
Completed 200 OK in 8ms (Views: 4.5ms | ActiveRecord: 0.3ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$VwzYW/lk3HnMXy5dO8FQouv.cHL2IyYlRv3RTb2F8JdJkt41hSfX."], ["created_at", "2018-11-29 17:15:37.734254"], ["updated_at", "2018-11-29 17:15:37.734254"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:15:37.737401"], ["updated_at", "2018-11-29 17:15:37.737401"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$PX.GWaGujJmO3989PPk.xuyejH32Vl6u8/08mZBOVdhIpPYv8ofz."], ["created_at", "2018-11-29 17:15:37.747679"], ["updated_at", "2018-11-29 17:15:37.747679"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$Exz3Do1R5JB6lcQBY2qFC.pKl23MPGQ85Zdwlm6.1JgbTpCmKeele"], ["created_at", "2018-11-29 17:15:37.770282"], ["updated_at", "2018-11-29 17:15:37.770282"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$BdiW0xXMwuuTlwzCN5hEiOBr1zCFXCljcIHgBKQiXUQKoT2220kIS"], ["created_at", "2018-11-29 17:26:19.898413"], ["updated_at", "2018-11-29 17:26:19.898413"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:26:19.913399"], ["updated_at", "2018-11-29 17:26:19.913399"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.3ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$AnWKgT3V17xfFE/j5ovS.u1coMqL/1cfuoNFgdyiFTFHKXMmW6P/e"], ["created_at", "2018-11-29 17:26:19.990128"], ["updated_at", "2018-11-29 17:26:19.990128"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (1.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$A7IV.8xCKkmrWIqUZ6E35.Fi1SYxcwK/gp1KMtgkkh275RnvdVPdW"], ["created_at", "2018-11-29 17:26:20.013499"], ["updated_at", "2018-11-29 17:26:20.013499"], ["username", "person3"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$X1hUb/reu4pYN7ejN5Rp0eU1Xj73p7GIV7dAtvq5jkP5hCSQ30fAG"], ["created_at", "2018-11-29 17:26:20.216907"], ["updated_at", "2018-11-29 17:26:20.216907"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$WN.nm04GSS/At7L1ogpqwOGX7hHBnf6ryYC8OFP12TEixaNhiDbFG"], ["created_at", "2018-11-29 17:26:20.221891"], ["updated_at", "2018-11-29 17:26:20.221891"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$jmtHYrwV5xUyYmSCKkWQ3.OwBLFdFkUqjuDnwRyTzjtITiO0zrEf2"], ["created_at", "2018-11-29 17:26:20.227024"], ["updated_at", "2018-11-29 17:26:20.227024"], ["username", "person6"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:26:20.232876"], ["updated_at", "2018-11-29 17:26:20.232876"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:26:20.235747"], ["updated_at", "2018-11-29 17:26:20.235747"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:26:20 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 11ms (Views: 0.5ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$GQTN./T3NPw5NuYqjtU7sepT5CkXEEIB.8gHyDUvoNAjxSZRhEfNW"], ["created_at", "2018-11-29 17:26:20.367212"], ["updated_at", "2018-11-29 17:26:20.367212"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$EJaJtkuy5kBOglUZzN3czeZw.c9O9uAZglilXslZvGjIiQiHXXxP."], ["created_at", "2018-11-29 17:26:20.372988"], ["updated_at", "2018-11-29 17:26:20.372988"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:26:20.375395"], ["updated_at", "2018-11-29 17:26:20.375395"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:26:20.378710"], ["updated_at", "2018-11-29 17:26:20.378710"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:26:20 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.8ms | ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$PHjeravoOw02WLR0U/KQCOTqVvY1JvHnGjipCXPrJZ8q0ie//q9Aa"], ["created_at", "2018-11-29 17:26:20.408805"], ["updated_at", "2018-11-29 17:26:20.408805"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$da.FjHFElgONSN8sCAyDke/XWMFGPlGWV/q7cLChvoIPZH6bxmOZG"], ["created_at", "2018-11-29 17:26:20.425283"], ["updated_at", "2018-11-29 17:26:20.425283"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:26:20.429857"], ["updated_at", "2018-11-29 17:26:20.429857"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:26:20.435388"], ["updated_at", "2018-11-29 17:26:20.435388"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:26:20 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$9HQWdhN6p5.mhm/WxkqVR.cigjzsSsCNeAOyWDfnu9CxqtdgA4Rfi"], ["created_at", "2018-11-29 17:26:20.457019"], ["updated_at", "2018-11-29 17:26:20.457019"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:26:20.461960"], ["updated_at", "2018-11-29 17:26:20.461960"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:26:20 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 27ms (ActiveRecord: 0.2ms)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$yT8IX85DjzYob98bu91iR.0Adp84XKDWdUb.zKtMLxGCeIoLyW2QG"], ["created_at", "2018-11-29 17:26:20.521987"], ["updated_at", "2018-11-29 17:26:20.521987"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$6l8.BcG6jx9gIBqxOJzsFunww8FfENRRk9OmliNMZ0AQ5aoIEQjU2"], ["created_at", "2018-11-29 17:26:20.528604"], ["updated_at", "2018-11-29 17:26:20.528604"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:26:20.544828"], ["updated_at", "2018-11-29 17:26:20.544828"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:26:20 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 24ms (ActiveRecord: 0.2ms)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$Pc3VjI/oLXhdRv3umrdvwelZ7kdbcvy50ubMDnYzxjAoD35HZsVl6"], ["created_at", "2018-11-29 17:26:20.611262"], ["updated_at", "2018-11-29 17:26:20.611262"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (9.7ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:26:20.617774"], ["updated_at", "2018-11-29 17:26:20.617774"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.6ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$ggWbqopG.TXBJE43qf0dOeb/tN9HSqKAWUUOKIveZqnT8AFVlLqPS"], ["created_at", "2018-11-29 17:26:20.660096"], ["updated_at", "2018-11-29 17:26:20.660096"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:26:20.668532"], ["updated_at", "2018-11-29 17:26:20.668532"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:26:20 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.4ms)
  Rendered comments/_comment.json.jbuilder (9.8ms)
  Rendered comments/index.json.jbuilder (15.6ms)
Completed 200 OK in 25ms (Views: 20.6ms | ActiveRecord: 0.4ms)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$Fu1uQEZeM9B9GZSUsMc/ouR0LbEWsuFSnBKFdNMs7N/pilXDLssN."], ["created_at", "2018-11-29 17:27:51.474992"], ["updated_at", "2018-11-29 17:27:51.474992"], ["username", "person1"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$/OyKUfpyQI2j/FwZjGJD4OE9U3rfWwKV1pJpgbWNp1HdkEXkgdZti"], ["created_at", "2018-11-29 17:27:51.513563"], ["updated_at", "2018-11-29 17:27:51.513563"], ["username", "person2"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$HN.Sd1/EUR1H8wG88w2wa.drcls9Z.sipEkGTVaJGLI3GIz8U0mTm"], ["created_at", "2018-11-29 17:27:51.546558"], ["updated_at", "2018-11-29 17:27:51.546558"], ["username", "person3"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.1ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:27:51.555077"], ["updated_at", "2018-11-29 17:27:51.555077"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$jZZXc24EklkB8/.MrW3EHOKvWGhFNkOGLw3Zfbu1oNppim3JEd/Ze"], ["created_at", "2018-11-29 17:27:51.732445"], ["updated_at", "2018-11-29 17:27:51.732445"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$tsV68BI4eiik4uRsyKasMOi/szZ0wt55JVkRQfFpf5pXNpXQosv2S"], ["created_at", "2018-11-29 17:27:51.737501"], ["updated_at", "2018-11-29 17:27:51.737501"], ["username", "person5"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:27:51.739380"], ["updated_at", "2018-11-29 17:27:51.739380"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:27:51.741958"], ["updated_at", "2018-11-29 17:27:51.741958"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:27:51 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 6ms (ActiveRecord: 0.0ms)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.7ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$R982QecPJOobrGwNanUmPOBPrbJlCZSCa2SgnpPfxXOd8Q4cmu.gC"], ["created_at", "2018-11-29 17:27:51.839192"], ["updated_at", "2018-11-29 17:27:51.839192"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$Wy/Tgaw3.IVxMtzw0jgGje8eD/v9NhomFJuSFugnB9tmfXWppRAYi"], ["created_at", "2018-11-29 17:27:51.844574"], ["updated_at", "2018-11-29 17:27:51.844574"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:27:51.847062"], ["updated_at", "2018-11-29 17:27:51.847062"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:27:51 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 17ms (Views: 0.3ms | ActiveRecord: 1.1ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (1.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$.UthaZYEtp6897KkOgscGOqrsFcrXiKiJbuzAv1nCkKB1b6DR44zC"], ["created_at", "2018-11-29 17:27:51.892043"], ["updated_at", "2018-11-29 17:27:51.892043"], ["username", "person8"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$kUBUvD/n3DUHoM604oF0TOFfwimK7GvZYgu8zfvUrxM8ALOpH2aLe"], ["created_at", "2018-11-29 17:27:51.906452"], ["updated_at", "2018-11-29 17:27:51.906452"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.9ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:27:51.911410"], ["updated_at", "2018-11-29 17:27:51.911410"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:27:51.924046"], ["updated_at", "2018-11-29 17:27:51.924046"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:27:51 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.5ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 13ms (Views: 0.6ms | ActiveRecord: 1.4ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$avspfmiyUjXf43QpvtkL7uYLbuMLOEBqpb5LMtgixkuIPPcr4Rizy"], ["created_at", "2018-11-29 17:27:51.960315"], ["updated_at", "2018-11-29 17:27:51.960315"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:27:51.963691"], ["updated_at", "2018-11-29 17:27:51.963691"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$JaY7O//FXht27F8YoYwPC.SZPKR98MiifPcwOcQTIyLHpEq.S71tW"], ["created_at", "2018-11-29 17:27:51.981329"], ["updated_at", "2018-11-29 17:27:51.981329"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:27:51.985964"], ["updated_at", "2018-11-29 17:27:51.985964"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:27:51 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.6ms)
  Rendered comments/_comment.json.jbuilder (6.1ms)
  Rendered comments/index.json.jbuilder (19.5ms)
Completed 200 OK in 30ms (Views: 24.8ms | ActiveRecord: 0.4ms)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$3x71rbLePULXxcJZWMb/vebkX8HXDAP6Db9yjAo7fIr59Ra7dYygC"], ["created_at", "2018-11-29 17:27:52.025911"], ["updated_at", "2018-11-29 17:27:52.025911"], ["username", "person12"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$XVNZ.xreYaEH97QhiqiFM.P5Yimjwj/2cYrrFxxMBqCJ7WKqZg3sW"], ["created_at", "2018-11-29 17:27:52.029920"], ["updated_at", "2018-11-29 17:27:52.029920"], ["username", "person13"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$HmTJiFIHYpHfgWWGtYf23OT3X/F1yn4fvXBHJqD9WPf2W1p1aXFye"], ["created_at", "2018-11-29 17:27:52.037587"], ["updated_at", "2018-11-29 17:27:52.037587"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:27:52.040593"], ["updated_at", "2018-11-29 17:27:52.040593"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.3ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:27:52.052045"], ["updated_at", "2018-11-29 17:27:52.052045"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:27:52 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 2ms (Views: 0.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$rKKAd7Q.pEdc9tED1ZONM.ajRJqT9kiR5XBwIMvrB8ZMUdVT/gCXG"], ["created_at", "2018-11-29 17:27:52.063479"], ["updated_at", "2018-11-29 17:27:52.063479"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:27:52.069500"], ["updated_at", "2018-11-29 17:27:52.069500"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:27:52 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 11ms (ActiveRecord: 0.1ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$L4B852JZAxVp/POvbVENmuTrdgVkQnVKQjCy8Mwfd47X8iUjs5.wK"], ["created_at", "2018-11-29 17:28:18.373520"], ["updated_at", "2018-11-29 17:28:18.373520"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:28:18.381407"], ["updated_at", "2018-11-29 17:28:18.381407"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$I5U4x/4kVGehnTCNaspok..L6QICPgdwdT24UAh9Jc7/FWuhNJvx6"], ["created_at", "2018-11-29 17:28:18.412526"], ["updated_at", "2018-11-29 17:28:18.412526"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$316n6eJXeUbnwRbx5cGgR.U3ZgYDtaxCHlt6gINx.C9Rh0sPBR7pu"], ["created_at", "2018-11-29 17:28:18.436139"], ["updated_at", "2018-11-29 17:28:18.436139"], ["username", "person3"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$R4rWUXPMMBSCayHYahPxieP19CZCejFC/EzuBEPwhCUEHgQpo2ZfG"], ["created_at", "2018-11-29 17:28:18.583704"], ["updated_at", "2018-11-29 17:28:18.583704"], ["username", "person4"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:28:18.586060"], ["updated_at", "2018-11-29 17:28:18.586060"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$Egwtk634VplqUUhIVOKF8uljaeludUXHjK1ytsARD5CzZ3kdnQ3Mu"], ["created_at", "2018-11-29 17:28:18.590873"], ["updated_at", "2018-11-29 17:28:18.590873"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:28:18.592349"], ["updated_at", "2018-11-29 17:28:18.592349"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:28:18 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.4ms)
  Rendered comments/_comment.json.jbuilder (3.2ms)
  Rendered comments/index.json.jbuilder (7.9ms)
Completed 200 OK in 20ms (Views: 10.2ms | ActiveRecord: 0.5ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$H4VMyYft/d.wBKryYNSpKeuBXRwXUegj28TtMlNkOvMhWMEd9hcyi"], ["created_at", "2018-11-29 17:28:18.678229"], ["updated_at", "2018-11-29 17:28:18.678229"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:28:18.680647"], ["updated_at", "2018-11-29 17:28:18.680647"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.3ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:28:18 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 19ms (ActiveRecord: 0.2ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$6LUzQ0aQvM9Hw/sOHWhg/eGaLogbQsC/ehXz/SE58WNkFjvUcHxUy"], ["created_at", "2018-11-29 17:28:18.726374"], ["updated_at", "2018-11-29 17:28:18.726374"], ["username", "person7"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$MaenoyOMV1hR4RKZi64rJenWQNXd992U.W0uDcRnIhm5bo0buuriS"], ["created_at", "2018-11-29 17:28:18.737529"], ["updated_at", "2018-11-29 17:28:18.737529"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:28:18.740335"], ["updated_at", "2018-11-29 17:28:18.740335"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:28:18.744806"], ["updated_at", "2018-11-29 17:28:18.744806"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:28:18 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$AnrwO46qTB2yb4R8yGQj5.S2j58uqsErpr4PNY6.vRDeIUMfXRniS"], ["created_at", "2018-11-29 17:28:18.770330"], ["updated_at", "2018-11-29 17:28:18.770330"], ["username", "person9"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$QD/cGKUWR7blYF7Q7Cps8OxMNFE6XHy2DY59/8UYTY9GS46E08/72"], ["created_at", "2018-11-29 17:28:18.780728"], ["updated_at", "2018-11-29 17:28:18.780728"], ["username", "person10"]]
  [1m[35m (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.0ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:28:18.788987"], ["updated_at", "2018-11-29 17:28:18.788987"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.8ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (1.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:28:18.800745"], ["updated_at", "2018-11-29 17:28:18.800745"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:28:18 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.8ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.9ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 13ms (Views: 0.1ms | ActiveRecord: 1.9ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$RuKTSLyzoNS.Gjb7gdRovOZ9A5OysB1eBtwjn5ICPCgNyPSZQJxzW"], ["created_at", "2018-11-29 17:28:18.844641"], ["updated_at", "2018-11-29 17:28:18.844641"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$iGaCKmEfSKefxhBWGvkXl..QEq4v3OMV3DPHkz1zhk6lKhTGFqTYq"], ["created_at", "2018-11-29 17:28:18.853574"], ["updated_at", "2018-11-29 17:28:18.853574"], ["username", "person12"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$cu5OEq7wCaSaW.RhyfxtVeAFgG7620Fs2/o3ZqFUqWYmF0PGJoEAy"], ["created_at", "2018-11-29 17:28:18.864660"], ["updated_at", "2018-11-29 17:28:18.864660"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:28:18.867868"], ["updated_at", "2018-11-29 17:28:18.867868"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:28:18.871485"], ["updated_at", "2018-11-29 17:28:18.871485"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:28:18 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 2ms (Views: 0.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$fs0ZkfgP66P7VYDY1CDbqO3gpbWe2Mh7e7.LXgVpIVfykhpYRyTZe"], ["created_at", "2018-11-29 17:28:18.891140"], ["updated_at", "2018-11-29 17:28:18.891140"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$KBIVdmLnVmgV6ilR1TZIzOtTPGQ1svUFJSbsvMu.xkxZXAYGTGFXa"], ["created_at", "2018-11-29 17:28:18.896668"], ["updated_at", "2018-11-29 17:28:18.896668"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:28:18.899396"], ["updated_at", "2018-11-29 17:28:18.899396"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:28:18 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 12ms (ActiveRecord: 0.2ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$erL0BrWAkARib1D6eblW3.iM3MMWNy1fedHltSb3ValHQxrM4j1QW"], ["created_at", "2018-11-29 17:28:27.469700"], ["updated_at", "2018-11-29 17:28:27.469700"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$AXPg59JTgVePxICS0wQVr.nwfiO88o3L4mYFjMJ/uhQld4S4wvmhS"], ["created_at", "2018-11-29 17:28:27.501060"], ["updated_at", "2018-11-29 17:28:27.501060"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:28:27.511606"], ["updated_at", "2018-11-29 17:28:27.511606"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:28:27 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 21ms (ActiveRecord: 0.2ms)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$S.5yT9Yn0fqzfs6gsCgr3uLvqPmce5cBeQa5G5HkbP0JjQ1EJM9xi"], ["created_at", "2018-11-29 17:28:27.617912"], ["updated_at", "2018-11-29 17:28:27.617912"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$B5.hlcwkJ9EeDPV0W9NxIOsUTA4jD5pIDlUr5J5pi1AwhETecLvrS"], ["created_at", "2018-11-29 17:28:27.627362"], ["updated_at", "2018-11-29 17:28:27.627362"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$Ea1WXHZq36sGIYYkLOG52uKjiYZLid4RzQePO0/U.lN52s/av.owO"], ["created_at", "2018-11-29 17:28:27.638294"], ["updated_at", "2018-11-29 17:28:27.638294"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:28:27.640565"], ["updated_at", "2018-11-29 17:28:27.640565"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:28:27.656054"], ["updated_at", "2018-11-29 17:28:27.656054"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:28:27 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 3ms (Views: 0.3ms | ActiveRecord: 0.3ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$k42QSO4K6PuG3uEFeqKwNe83sxi8rRtFSz3OB20Wt4dmk9W3OXKoS"], ["created_at", "2018-11-29 17:28:27.677782"], ["updated_at", "2018-11-29 17:28:27.677782"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$Z0DH3TRcO/rzIYcEDu6ksuGRWMscplYjeh/GNb88v0gTixZCRX3Fq"], ["created_at", "2018-11-29 17:28:27.685121"], ["updated_at", "2018-11-29 17:28:27.685121"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:28:27.688536"], ["updated_at", "2018-11-29 17:28:27.688536"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:28:27.692591"], ["updated_at", "2018-11-29 17:28:27.692591"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:28:27 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$fndAS.Pc2b6kZkn2a1KHNO1BB.l21mh0ASFYND0O/fMZxYrbwCmZm"], ["created_at", "2018-11-29 17:28:27.718672"], ["updated_at", "2018-11-29 17:28:27.718672"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:28:27.723374"], ["updated_at", "2018-11-29 17:28:27.723374"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:28:27 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.5ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 19ms (ActiveRecord: 0.5ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$IwFCLe/T.vi3CQ0z9Ww25.JKpXNVy7JplJ2KcPAOesfB07Cmpnnem"], ["created_at", "2018-11-29 17:28:27.764902"], ["updated_at", "2018-11-29 17:28:27.764902"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$myHjemNjwOEpE9l.yK8THespEV5Mo3wmii0N.IP5kfXYTLxENA2YG"], ["created_at", "2018-11-29 17:28:27.771839"], ["updated_at", "2018-11-29 17:28:27.771839"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (14.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:28:27.774494"], ["updated_at", "2018-11-29 17:28:27.774494"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:28:27.794371"], ["updated_at", "2018-11-29 17:28:27.794371"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:28:27 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (3.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$aMZj89qyuJrJjeHi8wE1l.LY3Q4qbYkS6SLRIX.Pd.vimar3OGJeW"], ["created_at", "2018-11-29 17:28:27.822701"], ["updated_at", "2018-11-29 17:28:27.822701"], ["username", "person11"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.8ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:28:27.837250"], ["updated_at", "2018-11-29 17:28:27.837250"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.5ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$odcg/PGcDh.I4fhjqBthBu2Ocqbx1crsl8MS0BzzL3mHwUENCILli"], ["created_at", "2018-11-29 17:28:27.863948"], ["updated_at", "2018-11-29 17:28:27.863948"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:28:27.866082"], ["updated_at", "2018-11-29 17:28:27.866082"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:28:27 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.4ms)
  Rendered comments/_comment.json.jbuilder (3.2ms)
  Rendered comments/index.json.jbuilder (7.7ms)
Completed 200 OK in 14ms (Views: 10.1ms | ActiveRecord: 0.4ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$ND2xe4EkC73s/RwttC98x.WMHWQdp266m4lxBa2f2aTB/DLUC5/ne"], ["created_at", "2018-11-29 17:28:27.893150"], ["updated_at", "2018-11-29 17:28:27.893150"], ["username", "person13"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:28:27.896836"], ["updated_at", "2018-11-29 17:28:27.896836"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$fuG0K2PI77V/uNL2P4e4buaJN3uRheu7ywBBVrNd/DnBfA0qWhNsi"], ["created_at", "2018-11-29 17:28:27.906543"], ["updated_at", "2018-11-29 17:28:27.906543"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$eWnwjluSWU4R.eFVPnXQWOWTXrY/Q6s8cWUjIGLu4EmosgNdzK.fK"], ["created_at", "2018-11-29 17:28:27.930930"], ["updated_at", "2018-11-29 17:28:27.930930"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$tFZSfn6Ymu0SLu9Qh/FaRueEmM0rOLBv5O1i7MFRsAMfXJ5An/r0O"], ["created_at", "2018-11-29 17:29:48.394272"], ["updated_at", "2018-11-29 17:29:48.394272"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:29:48.403189"], ["updated_at", "2018-11-29 17:29:48.403189"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$8Bzn6jC56Hj/6yItZCqjte5X6JYW9ufTx7MkUt9nmvHCaP6CyovK2"], ["created_at", "2018-11-29 17:29:48.434956"], ["updated_at", "2018-11-29 17:29:48.434956"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$Bsy7nJ65CAMaW8IoJsjv9.GzUUWrGNf2TjkLSGZaBsfpAIkKsH2Wy"], ["created_at", "2018-11-29 17:29:48.459264"], ["updated_at", "2018-11-29 17:29:48.459264"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$YOW2oUpiG1dWGqVtl5snS.q.6lCtovtEsFgKOPoBxj2VcpCG/zc/O"], ["created_at", "2018-11-29 17:29:48.620813"], ["updated_at", "2018-11-29 17:29:48.620813"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$ao5Wp5gSrunAEsFHEUtbE.UmcwYnHJGLG0vOiZLRXkYwzdkfkMSSq"], ["created_at", "2018-11-29 17:29:48.625449"], ["updated_at", "2018-11-29 17:29:48.625449"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$P7CS6SsoFTeTw5POc15u1OmS.OR8DXwxxXOMEe45TjJbs3emOf4ma"], ["created_at", "2018-11-29 17:29:48.630356"], ["updated_at", "2018-11-29 17:29:48.630356"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:29:48.632271"], ["updated_at", "2018-11-29 17:29:48.632271"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:29:48.635200"], ["updated_at", "2018-11-29 17:29:48.635200"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:29:48 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 10ms (Views: 0.4ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$VQgCpojMOtMSVnwTua5au.5mZVzwHiKy7bRdOXgVPXeTjKhSJnosi"], ["created_at", "2018-11-29 17:29:48.721821"], ["updated_at", "2018-11-29 17:29:48.721821"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:29:48.726120"], ["updated_at", "2018-11-29 17:29:48.726120"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.3ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$ijbdZC/gOKKQZqWr38WYpegoHJF0WyK8xHrBzRmMGp.ZPCc9RP2Yy"], ["created_at", "2018-11-29 17:29:48.738675"], ["updated_at", "2018-11-29 17:29:48.738675"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:29:48.740315"], ["updated_at", "2018-11-29 17:29:48.740315"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:29:48 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.4ms)
  Rendered comments/_comment.json.jbuilder (3.3ms)
  Rendered comments/index.json.jbuilder (8.3ms)
Completed 200 OK in 15ms (Views: 10.8ms | ActiveRecord: 0.5ms)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$LzK1aJHlXtZeMnG7s7BOSOOPWWixOoIhSk47XwfK39amfto2H0X26"], ["created_at", "2018-11-29 17:29:48.765225"], ["updated_at", "2018-11-29 17:29:48.765225"], ["username", "person9"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$zJXDjN7Bw71nuIJcHca6xe/auktvcnVTzaFvilZ7ZAOumh7lSqsoC"], ["created_at", "2018-11-29 17:29:48.770290"], ["updated_at", "2018-11-29 17:29:48.770290"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:29:48.772462"], ["updated_at", "2018-11-29 17:29:48.772462"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:29:48 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.3ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 7ms (Views: 0.2ms | ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$P9rUceFvzlH.DhQ2nnqAF.WkO8EoEShGtckKcwyd3EhbuPKzi.m5e"], ["created_at", "2018-11-29 17:29:48.803503"], ["updated_at", "2018-11-29 17:29:48.803503"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:29:48.808773"], ["updated_at", "2018-11-29 17:29:48.808773"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:29:48 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.2ms)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$jHfYawq0sjH2Yn/vWV0QOOycon1eQQpJ7YnPseC/7KwmMBqTyUMKy"], ["created_at", "2018-11-29 17:29:48.837293"], ["updated_at", "2018-11-29 17:29:48.837293"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$VigYfKIOdJSHTvNPtoi11OwkHumtiC/Ekp3Zm7I.rY7d9rJrhRYhG"], ["created_at", "2018-11-29 17:29:48.847911"], ["updated_at", "2018-11-29 17:29:48.847911"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:29:48.853677"], ["updated_at", "2018-11-29 17:29:48.853677"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:29:48.858811"], ["updated_at", "2018-11-29 17:29:48.858811"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:29:48 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (1.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$UEoK0lKr4ws7tLRaRIu59eHT6abMsUrwxfDRCnJkbbvY99BjxAlJO"], ["created_at", "2018-11-29 17:29:48.889062"], ["updated_at", "2018-11-29 17:29:48.889062"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (1.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$ecC3.pcGpU9qlnecCPJAhexrgjcODpBiau66eYdfegIFb2kOAC0he"], ["created_at", "2018-11-29 17:29:48.904991"], ["updated_at", "2018-11-29 17:29:48.904991"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.9ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:29:48.915077"], ["updated_at", "2018-11-29 17:29:48.915077"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:29:48.926407"], ["updated_at", "2018-11-29 17:29:48.926407"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:29:48 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 0.4ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$1ObH2wXjksZP0.GtPdZOAOrwpeqgzMRMCquZfZjClE1/j81Mx0j2O"], ["created_at", "2018-11-29 17:32:49.851876"], ["updated_at", "2018-11-29 17:32:49.851876"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:32:49.866156"], ["updated_at", "2018-11-29 17:32:49.866156"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$aQgDJxmI1yAm/UA3fVs4rOTp9sUwHAnpopsftqSVH/MkynkbzU1Zm"], ["created_at", "2018-11-29 17:32:49.902022"], ["updated_at", "2018-11-29 17:32:49.902022"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (2.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$X5b7FklEj1JrIKZs1xEwyOWY7TH7tO8DH3u.m2fSR46hAPtUPUpF6"], ["created_at", "2018-11-29 17:32:49.923274"], ["updated_at", "2018-11-29 17:32:49.923274"], ["username", "person3"]]
  [1m[35m (1.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$oRXDj5fwRuK1bk94xFpHqO/E9Ekbuyk37hQfwYyi/Wko/LkO1TAGm"], ["created_at", "2018-11-29 17:32:50.092637"], ["updated_at", "2018-11-29 17:32:50.092637"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$bDVD7E/YTRVLGHpcsNN0Nu5802Lyth3jVHt57OKBz1p5V/EsYx7b2"], ["created_at", "2018-11-29 17:32:50.097107"], ["updated_at", "2018-11-29 17:32:50.097107"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:32:50.098954"], ["updated_at", "2018-11-29 17:32:50.098954"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:32:50 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 15ms (Views: 0.3ms | ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$aJMGY9GCQhS0xN.8eV9zeuH2zBakYPayctWwsMEyClBN0ZAzdxPmq"], ["created_at", "2018-11-29 17:32:50.181311"], ["updated_at", "2018-11-29 17:32:50.181311"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:32:50.186815"], ["updated_at", "2018-11-29 17:32:50.186815"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$HECmQE2wyEldkJsZq3/lauXFbI54Bxy2HgaFtonYGY3.JROPtkfeW"], ["created_at", "2018-11-29 17:32:50.192339"], ["updated_at", "2018-11-29 17:32:50.192339"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:32:50.193763"], ["updated_at", "2018-11-29 17:32:50.193763"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:32:50 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.3ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.6ms)
  Rendered comments/_comment.json.jbuilder (9.3ms)
  Rendered comments/index.json.jbuilder (14.4ms)
Completed 200 OK in 20ms (Views: 16.8ms | ActiveRecord: 0.6ms)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$cn.BKljikktex0LKWH5BjuTB6ZF7ET2nV16/o521NYpN88PoX7hy6"], ["created_at", "2018-11-29 17:32:50.226766"], ["updated_at", "2018-11-29 17:32:50.226766"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:32:50.230428"], ["updated_at", "2018-11-29 17:32:50.230428"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:32:50 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.1ms)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$RylqSekjk/slvGmcnJqvAu02KiRyQgBqEazSae17UpAllRbnSDs8m"], ["created_at", "2018-11-29 17:32:50.253938"], ["updated_at", "2018-11-29 17:32:50.253938"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$2/ijRZjtSVDGDd43y4.T/enWt8JxHQAAigxpbKWLZTRbv6wX8qDiW"], ["created_at", "2018-11-29 17:32:50.261088"], ["updated_at", "2018-11-29 17:32:50.261088"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:32:50.264788"], ["updated_at", "2018-11-29 17:32:50.264788"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:32:50.282344"], ["updated_at", "2018-11-29 17:32:50.282344"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:32:50 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$2nKuDhQhCYI8HlrtO/E4.eBEFDkitMdWoqQ26wjFhQH/NqycoenUq"], ["created_at", "2018-11-29 17:32:50.316557"], ["updated_at", "2018-11-29 17:32:50.316557"], ["username", "person11"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$ZnHho6rOyhVkkWjru.SDGuB0fQCMLzrTqmrervqaaL1ZIkcQ0YSVi"], ["created_at", "2018-11-29 17:32:50.336087"], ["updated_at", "2018-11-29 17:32:50.336087"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$ellN/YBK.XQ8RwZnDOh66uVoypVlDw7zzmtcSWtduSWNAoHDQDGYu"], ["created_at", "2018-11-29 17:32:50.342670"], ["updated_at", "2018-11-29 17:32:50.342670"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:32:50.346040"], ["updated_at", "2018-11-29 17:32:50.346040"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:32:50.349643"], ["updated_at", "2018-11-29 17:32:50.349643"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:32:50 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 3ms (Views: 0.7ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$V0OvnDqzZJvRBwEigcG3k.BEmESisouXMpHsoI5nq9CHOc4IZfb1G"], ["created_at", "2018-11-29 17:32:50.368489"], ["updated_at", "2018-11-29 17:32:50.368489"], ["username", "person14"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$IDbppkelB3jVvIoS0y4Es.urTHkQ4EvD2P1TqCxPRWDOt4MDVqOke"], ["created_at", "2018-11-29 17:32:50.379608"], ["updated_at", "2018-11-29 17:32:50.379608"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:32:50.381914"], ["updated_at", "2018-11-29 17:32:50.381914"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (1.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:32:50.385573"], ["updated_at", "2018-11-29 17:32:50.385573"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:32:50 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 0.5ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$MWcsdqSbNWYucNuXuEzrIu4G9Cq1vDEfG2Xn0J.IMnqwMSEKrwNVa"], ["created_at", "2018-11-29 17:36:08.531729"], ["updated_at", "2018-11-29 17:36:08.531729"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$MAlb/IU0dp7rMs8zcireW..Jsn3aqP7kS0ToRmUtDmGgzcKNZMTIy"], ["created_at", "2018-11-29 17:36:08.536981"], ["updated_at", "2018-11-29 17:36:08.536981"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$VBf0y/VOrAKxBEo5GRJW9.W005boWteIEDEVtYx4ZaXRrI1ZFYm1O"], ["created_at", "2018-11-29 17:36:08.571265"], ["updated_at", "2018-11-29 17:36:08.571265"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:36:08.578832"], ["updated_at", "2018-11-29 17:36:08.578832"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:36:08.607963"], ["updated_at", "2018-11-29 17:36:08.607963"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:36:08 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 7ms (Views: 0.3ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$7or9jabSrkdUH2Eb4PMeJOkp31RlU.NXXy0LZ4K5v.37XF/Xjr6Le"], ["created_at", "2018-11-29 17:36:08.687477"], ["updated_at", "2018-11-29 17:36:08.687477"], ["username", "person4"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$ruwgZKlvVLvueqI6ktcLru3bcYPfafrwtW2kmfDcFCqGW7dbpAS/6"], ["created_at", "2018-11-29 17:36:08.698935"], ["updated_at", "2018-11-29 17:36:08.698935"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:36:08.701524"], ["updated_at", "2018-11-29 17:36:08.701524"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:36:08.710984"], ["updated_at", "2018-11-29 17:36:08.710984"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:36:08 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$iU6Og4h/2gjNdNGX0NEOieqNuS2RT7Gwsa9sZGzYzsh4paiCpaGJ2"], ["created_at", "2018-11-29 17:36:08.723093"], ["updated_at", "2018-11-29 17:36:08.723093"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$UFpqiWTLsCd1mZ7QxrHJnulaxXrbHTYDtlQ.oMJDUvejUmlIODRI6"], ["created_at", "2018-11-29 17:36:08.730670"], ["updated_at", "2018-11-29 17:36:08.730670"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:36:08.733038"], ["updated_at", "2018-11-29 17:36:08.733038"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (1.1ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:36:08.740705"], ["updated_at", "2018-11-29 17:36:08.740705"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:36:08 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$.DR0aXFarprzukgNthlLO.qVRpV3jRhvhimc.1N.o35TAygn.c6lm"], ["created_at", "2018-11-29 17:36:08.761598"], ["updated_at", "2018-11-29 17:36:08.761598"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:36:08.765299"], ["updated_at", "2018-11-29 17:36:08.765299"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:36:08 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.6ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.6ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$K7vyok8sXNC3OjxM9moQce3q2Ug1hNMWjvLeqyMUCdxXX64Kra6Ua"], ["created_at", "2018-11-29 17:36:08.787801"], ["updated_at", "2018-11-29 17:36:08.787801"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$zxvmaTzWQX6ubODuync8rehHlN5JjjWeEAAYjj/M9I2dGrvf3sLaK"], ["created_at", "2018-11-29 17:36:08.796790"], ["updated_at", "2018-11-29 17:36:08.796790"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:36:08.799884"], ["updated_at", "2018-11-29 17:36:08.799884"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:36:08 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 20ms (Views: 0.2ms | ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$I6Vj7N.sNJ/DTrZiwbosh.yWaqVOeHfRh/gpfZqxAxq6G/RBBZHca"], ["created_at", "2018-11-29 17:36:08.841913"], ["updated_at", "2018-11-29 17:36:08.841913"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:36:08.845105"], ["updated_at", "2018-11-29 17:36:08.845105"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$VOp8IVWkUrug0.p/1ImqhejLJrbMi2O9gx0U/AsueFOZ430U9KGUe"], ["created_at", "2018-11-29 17:36:08.858834"], ["updated_at", "2018-11-29 17:36:08.858834"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:36:08.861294"], ["updated_at", "2018-11-29 17:36:08.861294"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:36:08 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.6ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (1.0ms)
  Rendered comments/_comment.json.jbuilder (7.2ms)
  Rendered comments/index.json.jbuilder (19.7ms)
Completed 200 OK in 38ms (Views: 26.0ms | ActiveRecord: 0.9ms)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$uOak0eOJw/AkS8qvhPFamuFt4qrngepogBE2et1u0rHYpvySgaXzW"], ["created_at", "2018-11-29 17:36:08.917762"], ["updated_at", "2018-11-29 17:36:08.917762"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$mbCJc0fu6WKwG55B8m8AWuVYsJksA8gSKuQqxwxepG5qwoTNnSHzm"], ["created_at", "2018-11-29 17:36:08.933664"], ["updated_at", "2018-11-29 17:36:08.933664"], ["username", "person14"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:36:08.948850"], ["updated_at", "2018-11-29 17:36:08.948850"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$mqRsVayAaikakPoq8rWSC.cpvlM/Ax4VX99DDs4CV/pbAujleJn2a"], ["created_at", "2018-11-29 17:36:08.966310"], ["updated_at", "2018-11-29 17:36:08.966310"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$C.zCjHtCRc2j8IPHBXVVUOnoaIy1N08pnkB6oSYgR.w4exKaMc3Hm"], ["created_at", "2018-11-29 17:37:56.918363"], ["updated_at", "2018-11-29 17:37:56.918363"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$kwp6s6F2XzGnCSQYxilQKuXKtYvycNZp5kVHD7i4cNzZsvi3Gn6Wq"], ["created_at", "2018-11-29 17:37:56.950396"], ["updated_at", "2018-11-29 17:37:56.950396"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:37:56.957327"], ["updated_at", "2018-11-29 17:37:56.957327"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:37:56.985150"], ["updated_at", "2018-11-29 17:37:56.985150"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:37:56 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 3ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$DdyZKXI5ZKbCr9qGoBPKZugg9q3khpYSIzmSfPLKbd4dn1z2Unkii"], ["created_at", "2018-11-29 17:37:57.091385"], ["updated_at", "2018-11-29 17:37:57.091385"], ["username", "person3"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$viocthNEa/TMrhu5URzsbeI9AkoL/diXxqrA1CmFrGw22C2l1sxz6"], ["created_at", "2018-11-29 17:37:57.096957"], ["updated_at", "2018-11-29 17:37:57.096957"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:37:57.098954"], ["updated_at", "2018-11-29 17:37:57.098954"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.5ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:37:57.101573"], ["updated_at", "2018-11-29 17:37:57.101573"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:37:57 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.6ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$iIMK4RqEBwTMHHMBavWoW.igvfrX/arAn5G1e47c7GyDr8jPiUAu6"], ["created_at", "2018-11-29 17:37:57.125720"], ["updated_at", "2018-11-29 17:37:57.125720"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$WRMEhJafj5JZJuXStfR4a.QvPG13oqYC6Bmx3M1y7lieGGpWgclRC"], ["created_at", "2018-11-29 17:37:57.132650"], ["updated_at", "2018-11-29 17:37:57.132650"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:37:57.134597"], ["updated_at", "2018-11-29 17:37:57.134597"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:37:57 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.8ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:37:57.151042"], ["updated_at", "2018-11-29 17:37:57.151042"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (5.0ms)
  Rendered comments/_comment.json.jbuilder (6.2ms)
  Rendered comments/create.json.jbuilder (10.1ms)
Completed 200 OK in 24ms (Views: 12.8ms | ActiveRecord: 1.7ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$/f4kmmuMvxfmKbQQteTH/OxCEg1EYRZf4itlg0GrIJD6eUB//Mdue"], ["created_at", "2018-11-29 17:37:57.177015"], ["updated_at", "2018-11-29 17:37:57.177015"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:37:57.180255"], ["updated_at", "2018-11-29 17:37:57.180255"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$tomoCM0EvkiMXgLExFtwCu2r9N4F3CcApRsj0efVD3Kzh0lk316oO"], ["created_at", "2018-11-29 17:37:57.186218"], ["updated_at", "2018-11-29 17:37:57.186218"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.6ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:37:57.188795"], ["updated_at", "2018-11-29 17:37:57.188795"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:37:57 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.1ms)
  Rendered comments/_comment.json.jbuilder (2.0ms)
  Rendered comments/index.json.jbuilder (4.2ms)
Completed 200 OK in 8ms (Views: 4.3ms | ActiveRecord: 0.3ms)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$ueg2PzIbqeyOsJ35UOMKi.yEHUnJ4/qjQWmJ1AuYKQzD9pVXIiy7a"], ["created_at", "2018-11-29 17:37:57.212986"], ["updated_at", "2018-11-29 17:37:57.212986"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:37:57.216862"], ["updated_at", "2018-11-29 17:37:57.216862"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:37:57 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.6ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Unpermitted parameter: :body
Unpermitted parameters: :captcha_key, :captcha_answer
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.5ms)[0m  [1m[32mINSERT INTO "comments" ("body", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["body", "My comment"], ["article_id", 1], ["created_at", "2018-11-29 17:37:57.229967"], ["updated_at", "2018-11-29 17:37:57.229967"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  Rendered comments/_comment.json.jbuilder (0.2ms)
  Rendered comments/create.json.jbuilder (0.8ms)
Completed 200 OK in 13ms (Views: 1.5ms | ActiveRecord: 1.7ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$rinFYC8Hhw4oW4kngRtThu2huQmy2flSkm0.hlfbkbzMFQr38DNB2"], ["created_at", "2018-11-29 17:37:57.242209"], ["updated_at", "2018-11-29 17:37:57.242209"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$1Z/eL8RsVwHnYmGPL4.bUOVAREMNpqrWExcDTACZLYXAenh1TnDw6"], ["created_at", "2018-11-29 17:37:57.246440"], ["updated_at", "2018-11-29 17:37:57.246440"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$DEnHek8jo/Hy7bWBZsvhyOZFK9tQFl/h2bF.rBpfzaWEeX1h77D7W"], ["created_at", "2018-11-29 17:37:57.250862"], ["updated_at", "2018-11-29 17:37:57.250862"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:37:57.252938"], ["updated_at", "2018-11-29 17:37:57.252938"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.4ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (1.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:37:57.262554"], ["updated_at", "2018-11-29 17:37:57.262554"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:37:57 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.5ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 4ms (Views: 0.5ms | ActiveRecord: 0.7ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$WdOUwg0vmWT4fLaBnZ6FBejFw42S9m3sIO8wfYB85jnzaYxAILS1W"], ["created_at", "2018-11-29 17:37:57.288810"], ["updated_at", "2018-11-29 17:37:57.288810"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:37:57.292310"], ["updated_at", "2018-11-29 17:37:57.292310"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$QmEAMck4t6vVbB/5jOCJzuKUWvx2znXQwf8fj0rMsoSgbEhoZTd4."], ["created_at", "2018-11-29 17:37:57.299323"], ["updated_at", "2018-11-29 17:37:57.299323"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$emUYMDn8Q/BEaXMWgeF1/uo8Q19HoBANeLtwoZlNtKb/h6MIiCJrK"], ["created_at", "2018-11-29 17:37:57.334269"], ["updated_at", "2018-11-29 17:37:57.334269"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$tplhPrG0S9GXGJCiR2IPSunEYVRFNCQRXV9WW3j.27ICE8LQYH2zi"], ["created_at", "2018-11-29 17:39:11.038194"], ["updated_at", "2018-11-29 17:39:11.038194"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:39:11.049268"], ["updated_at", "2018-11-29 17:39:11.049268"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:39:11 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Unpermitted parameter: :body
Unpermitted parameters: :captcha_key, :captcha_answer
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["body", "My comment"], ["article_id", 1], ["created_at", "2018-11-29 17:39:11.143740"], ["updated_at", "2018-11-29 17:39:11.143740"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  Rendered comments/_comment.json.jbuilder (1.3ms)
  Rendered comments/create.json.jbuilder (5.3ms)
Completed 200 OK in 28ms (Views: 8.2ms | ActiveRecord: 0.8ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (2.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_invalid_captcha
-------------------------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$.hN09cewJWDMC88f7wFJbeOEizke9TPmSFtwEuaFh/Yw22BbiC65y"], ["created_at", "2018-11-29 17:39:11.174289"], ["updated_at", "2018-11-29 17:39:11.174289"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:39:11.177978"], ["updated_at", "2018-11-29 17:39:11.177978"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:39:11 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"2"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Unpermitted parameter: :body
Completed 403 Forbidden in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$.6qxhPafMy40Bqbpy6hhq.zhyz/W/OUw5AbIWwBdrOcaL/LICdTXi"], ["created_at", "2018-11-29 17:39:11.193967"], ["updated_at", "2018-11-29 17:39:11.193967"], ["username", "person3"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:39:11.202568"], ["updated_at", "2018-11-29 17:39:11.202568"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$TsBQGD3iFZW1SzXzit01Re3juTS1w8l1AjZHcttWdHpSrvXYDvVVu"], ["created_at", "2018-11-29 17:39:11.214544"], ["updated_at", "2018-11-29 17:39:11.214544"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.5ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:39:11.218774"], ["updated_at", "2018-11-29 17:39:11.218774"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:39:11 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.3ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (2.7ms)
  Rendered comments/_comment.json.jbuilder (9.3ms)
  Rendered comments/index.json.jbuilder (13.3ms)
Completed 200 OK in 23ms (Views: 13.7ms | ActiveRecord: 0.9ms)
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$XM.RGYgZ4GFK.Ch296tkYuMDW/2/eKgpQX.sBGjBpEXUbkQjEHgfC"], ["created_at", "2018-11-29 17:39:11.265861"], ["updated_at", "2018-11-29 17:39:11.265861"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$JA.Xzin5N1clv/ffGFqSouZG/GMG7uL0ql84X6nQpE1QKNNV0Zz2C"], ["created_at", "2018-11-29 17:39:11.273264"], ["updated_at", "2018-11-29 17:39:11.273264"], ["username", "person6"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.0ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:39:11.282502"], ["updated_at", "2018-11-29 17:39:11.282502"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:39:11.289110"], ["updated_at", "2018-11-29 17:39:11.289110"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:39:11 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (1.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$lTk8EndopqgJ2MrA8rLawOuaDuOqqzIJH7vBw2gAYjPn74EhrtnX."], ["created_at", "2018-11-29 17:39:11.304619"], ["updated_at", "2018-11-29 17:39:11.304619"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$7tYVXDtn.gTO4DUooWwRP.gj7iPOiZYdSazXiEZTDY6HgX6ImSGBS"], ["created_at", "2018-11-29 17:39:11.311778"], ["updated_at", "2018-11-29 17:39:11.311778"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.7ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:39:11.314974"], ["updated_at", "2018-11-29 17:39:11.314974"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:39:11.318647"], ["updated_at", "2018-11-29 17:39:11.318647"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:39:11 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.7ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.3ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.8ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 12ms (Views: 0.2ms | ActiveRecord: 2.4ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$TF0HslLvsxAINRJKMARSxewPpKgPqxLqd1LOnhMPvMcqhjoUoymLa"], ["created_at", "2018-11-29 17:39:11.351260"], ["updated_at", "2018-11-29 17:39:11.351260"], ["username", "person9"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$H0AxkONmzA7/fIUFIHBDFOAalyL.v2330y4MDAQkz9zothr.I26va"], ["created_at", "2018-11-29 17:39:11.355780"], ["updated_at", "2018-11-29 17:39:11.355780"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.5ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:39:11.358309"], ["updated_at", "2018-11-29 17:39:11.358309"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.4ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:39:11 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:39:11.375693"], ["updated_at", "2018-11-29 17:39:11.375693"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (4.9ms)
  Rendered comments/_comment.json.jbuilder (5.2ms)
  Rendered comments/create.json.jbuilder (5.6ms)
Completed 200 OK in 12ms (Views: 5.6ms | ActiveRecord: 0.9ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$hD2WiEnn..uXn7ZgY5cdF.nPOWZ/QzmO.v/AqWqxA2E.hRl7dY31."], ["created_at", "2018-11-29 17:39:11.392453"], ["updated_at", "2018-11-29 17:39:11.392453"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$BNO1T3uZKPkfWMB/OAtAQuf/P2hR/Ib6f4PD2pMFRpK9MNauqguna"], ["created_at", "2018-11-29 17:39:11.397930"], ["updated_at", "2018-11-29 17:39:11.397930"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$WYDDneo9kt2.MizRwuOZCuaHV8DVFWp6AC8XimgmUZvwDWEiDmAm2"], ["created_at", "2018-11-29 17:39:11.401813"], ["updated_at", "2018-11-29 17:39:11.401813"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:39:11.403769"], ["updated_at", "2018-11-29 17:39:11.403769"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.9ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:39:11.407037"], ["updated_at", "2018-11-29 17:39:11.407037"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:39:11 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.3ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.3ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 3ms (Views: 0.3ms | ActiveRecord: 0.5ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$Q7A7P/NNIaU2P5XRRUh6p.l7mmmLkchQUAbGnGgJeC2kmrwVmYWAO"], ["created_at", "2018-11-29 17:39:11.436115"], ["updated_at", "2018-11-29 17:39:11.436115"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:39:11.439808"], ["updated_at", "2018-11-29 17:39:11.439808"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.3ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$0RWGEX90nSfzWQ1Is9Hmf.1jHp/TIDbxCKePu9HHGRlVygHPobXL."], ["created_at", "2018-11-29 17:39:11.456852"], ["updated_at", "2018-11-29 17:39:11.456852"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person16@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person16"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person16@example.com"], ["encrypted_password", "$2a$04$.EAQdjkxk0/ZBodVhxtuO.7HC4bVAUrh46VfYLk4.Kb3bwTtKYKia"], ["created_at", "2018-11-29 17:39:11.474146"], ["updated_at", "2018-11-29 17:39:11.474146"], ["username", "person16"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$hoQ/36jGKx/ky5OQbupOLOLVkWN9DWmGsbWlXvNXTnrm0J3fMxJay"], ["created_at", "2018-11-29 17:40:09.225998"], ["updated_at", "2018-11-29 17:40:09.225998"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:40:09.234339"], ["updated_at", "2018-11-29 17:40:09.234339"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$ffmptg7zM8WbGz6n2PLq7OmcH2cMezMLP1xkd3fAtr3FMtGpmS9dS"], ["created_at", "2018-11-29 17:40:09.266129"], ["updated_at", "2018-11-29 17:40:09.266129"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$JDmWNLODJs5RCx5HYuUtGuugQ.He1O1CKFwmc6qwWqf0ZlBI5Bb.O"], ["created_at", "2018-11-29 17:40:09.291430"], ["updated_at", "2018-11-29 17:40:09.291430"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$jQr8YJFhBFOPi6rlrAITFeflTDQcSMFEz5n5o/h6/32cgR2oXkFJ."], ["created_at", "2018-11-29 17:40:09.434687"], ["updated_at", "2018-11-29 17:40:09.434687"], ["username", "person4"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:40:09.436980"], ["updated_at", "2018-11-29 17:40:09.436980"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:40:09 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Unpermitted parameter: :body
Unpermitted parameters: :captcha_key, :captcha_answer
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("body", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["body", "My comment"], ["article_id", 1], ["created_at", "2018-11-29 17:40:09.510110"], ["updated_at", "2018-11-29 17:40:09.510110"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  Rendered comments/_comment.json.jbuilder (0.5ms)
  Rendered comments/create.json.jbuilder (4.6ms)
Completed 200 OK in 20ms (Views: 7.5ms | ActiveRecord: 0.7ms)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$0I/QyGOMQ3iO8/0Gaj/0lunNo0HnrWF1zrCRNezsnMTUEN0YUpcK2"], ["created_at", "2018-11-29 17:40:09.535544"], ["updated_at", "2018-11-29 17:40:09.535544"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$kg.IzNDgi4VXSwHyVxMgLOqpWG8eoi9K1vAi4ssyl1mXe3l1bcweW"], ["created_at", "2018-11-29 17:40:09.539886"], ["updated_at", "2018-11-29 17:40:09.539886"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$fcsFqDQ8BnAzMOZm1mgdiO7rRB0OnShU6AN0TDFmoaEzWi6rykNW6"], ["created_at", "2018-11-29 17:40:09.554318"], ["updated_at", "2018-11-29 17:40:09.554318"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:40:09.559985"], ["updated_at", "2018-11-29 17:40:09.559985"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:40:09.564115"], ["updated_at", "2018-11-29 17:40:09.564115"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:40:09 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 2ms (Views: 0.2ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$toZr.NBAZ/iNpglMo7v9p.l.bawDCwVJW9uooaGZvaj1ZXRT8G0zG"], ["created_at", "2018-11-29 17:40:09.586047"], ["updated_at", "2018-11-29 17:40:09.586047"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$viXv.P8BOUUyQPJXqen3iObnvhMG8LefbIRGVxDibwIz67pXwrrwi"], ["created_at", "2018-11-29 17:40:09.596428"], ["updated_at", "2018-11-29 17:40:09.596428"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:40:09.599607"], ["updated_at", "2018-11-29 17:40:09.599607"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:40:09.603573"], ["updated_at", "2018-11-29 17:40:09.603573"]]
  [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:40:09 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.4ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.7ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 1.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$kTdt5si1cFAteuTrGyu4Me1t5DLVBi0wxQUjAZCqxbm0hpxK4R632"], ["created_at", "2018-11-29 17:40:09.632581"], ["updated_at", "2018-11-29 17:40:09.632581"], ["username", "person10"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$R90fSU4Wb2epLZ8vGZMrre2H07ghoeTN9qNxg6JlR6BZrhpYMd3.6"], ["created_at", "2018-11-29 17:40:09.640261"], ["updated_at", "2018-11-29 17:40:09.640261"], ["username", "person11"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:40:09.649258"], ["updated_at", "2018-11-29 17:40:09.649258"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:40:09.655134"], ["updated_at", "2018-11-29 17:40:09.655134"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:40:09 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$1LLiGyqPeHMMgyMTfo7j7OMbdNVISEWVSmbK4jc0yqeR0sRBYic0q"], ["created_at", "2018-11-29 17:40:09.670269"], ["updated_at", "2018-11-29 17:40:09.670269"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:40:09.674387"], ["updated_at", "2018-11-29 17:40:09.674387"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$LiSpyx1b31ONTxZ1cdopEu2XRD1xywK4643FBp2IXvHvZrCxgt0ry"], ["created_at", "2018-11-29 17:40:09.688179"], ["updated_at", "2018-11-29 17:40:09.688179"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:40:09.690340"], ["updated_at", "2018-11-29 17:40:09.690340"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:40:09 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.9ms)
  Rendered comments/_comment.json.jbuilder (5.2ms)
  Rendered comments/index.json.jbuilder (7.9ms)
Completed 200 OK in 18ms (Views: 13.6ms | ActiveRecord: 0.5ms)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_invalid_captcha
-------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$3WPzYk8CJ9umKRWETAMdQuR86Tmg0VihBTqaL9ERLlppi7sIQzNOe"], ["created_at", "2018-11-29 17:40:09.720422"], ["updated_at", "2018-11-29 17:40:09.720422"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:40:09.724312"], ["updated_at", "2018-11-29 17:40:09.724312"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:40:09 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"2"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Unpermitted parameter: :body
Completed 403 Forbidden in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$R8g.I5k10dWmJ6SfI.T/e.TEKVY9/Caqc.GDpfiQF5mMsQVOhbvDm"], ["created_at", "2018-11-29 17:40:09.735064"], ["updated_at", "2018-11-29 17:40:09.735064"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person16@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person16"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person16@example.com"], ["encrypted_password", "$2a$04$dMyGUbUPr2uWBi.UreVyc.wAFrRvT.8I8Jc1ysfeY0eXB7mFsmidW"], ["created_at", "2018-11-29 17:40:09.741806"], ["updated_at", "2018-11-29 17:40:09.741806"], ["username", "person16"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:40:09.754731"], ["updated_at", "2018-11-29 17:40:09.754731"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:40:09 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:40:09.771163"], ["updated_at", "2018-11-29 17:40:09.771163"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (12.3ms)
  Rendered comments/_comment.json.jbuilder (12.9ms)
  Rendered comments/create.json.jbuilder (13.6ms)
Completed 200 OK in 21ms (Views: 12.4ms | ActiveRecord: 2.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$xK2SeovnZOI44Ad6HFLgH.72K5akzSbXxdvo4AC5kAhxi0QwVRxeu"], ["created_at", "2018-11-29 17:40:49.409314"], ["updated_at", "2018-11-29 17:40:49.409314"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:40:49.417704"], ["updated_at", "2018-11-29 17:40:49.417704"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$ffMBAb/.bv..wTGimiiTVOC5G/XPbs5RBjuTGNgjzwOk70r09kCIq"], ["created_at", "2018-11-29 17:40:49.449767"], ["updated_at", "2018-11-29 17:40:49.449767"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$aMkf7yPGjwPROcQzAKGXjeSg6x0Iv993/lkeU37iSRmuaI9zPTjgW"], ["created_at", "2018-11-29 17:40:49.466528"], ["updated_at", "2018-11-29 17:40:49.466528"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$Evba4E7eLEiI3vzPR8uIN.KKHamgX6sE9WIiZWS0p2Y6tgyMbMCU."], ["created_at", "2018-11-29 17:40:49.612709"], ["updated_at", "2018-11-29 17:40:49.612709"], ["username", "person4"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:40:49.615119"], ["updated_at", "2018-11-29 17:40:49.615119"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:40:49 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Unpermitted parameter: :body
Unpermitted parameters: :captcha_key, :captcha_answer
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["body", "My comment"], ["article_id", 1], ["created_at", "2018-11-29 17:40:49.684948"], ["updated_at", "2018-11-29 17:40:49.684948"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  Rendered comments/_comment.json.jbuilder (0.4ms)
  Rendered comments/create.json.jbuilder (4.2ms)
Completed 200 OK in 17ms (Views: 7.0ms | ActiveRecord: 0.5ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$2uoJlIcSlsObn/6T13c/nO3.tx0aI9zjD.KEx4L3Unj1QfygAcSZm"], ["created_at", "2018-11-29 17:40:49.706600"], ["updated_at", "2018-11-29 17:40:49.706600"], ["username", "person5"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:40:49.710191"], ["updated_at", "2018-11-29 17:40:49.710191"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$RiKxAmXQUnV788wQiCVDyewtddKJl1DOjFiFSQa6jqYlBy18/XOH6"], ["created_at", "2018-11-29 17:40:49.716175"], ["updated_at", "2018-11-29 17:40:49.716175"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:40:49.717676"], ["updated_at", "2018-11-29 17:40:49.717676"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:40:49 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.4ms)
  Rendered comments/_comment.json.jbuilder (3.4ms)
  Rendered comments/index.json.jbuilder (6.9ms)
Completed 200 OK in 16ms (Views: 7.9ms | ActiveRecord: 0.5ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$mgDREVqsn0wLdvxMTHZipO7FwA2ikAuRvPPssP92qCGBiFIhlbR.."], ["created_at", "2018-11-29 17:40:49.745745"], ["updated_at", "2018-11-29 17:40:49.745745"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$7Puy26OvADAN7aIHlKHlyeLEb9XE6wjcyp9kxH9AEdOeucp02PQWS"], ["created_at", "2018-11-29 17:40:49.752446"], ["updated_at", "2018-11-29 17:40:49.752446"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$XLSLKojfB2IKhXFAMfcYUufKlFRg0O0DJVmzqYe1AtDooGvQtT85."], ["created_at", "2018-11-29 17:40:49.765295"], ["updated_at", "2018-11-29 17:40:49.765295"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 17:40:49.768786"], ["updated_at", "2018-11-29 17:40:49.768786"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 17:40:49.772732"], ["updated_at", "2018-11-29 17:40:49.772732"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:40:49 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 4ms (Views: 0.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_invalid_captcha
-------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$lGlSAB0tgObvl3wv9ISyUuVL9VkyFddcbPQ7OD9FBYW8Bm1xIP6gq"], ["created_at", "2018-11-29 17:40:49.796431"], ["updated_at", "2018-11-29 17:40:49.796431"], ["username", "person10"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 17:40:49.800615"], ["updated_at", "2018-11-29 17:40:49.800615"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:40:49 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"2"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Unpermitted parameter: :body
Completed 403 Forbidden in 2ms (Views: 0.2ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$F6vnnm0Lbz.HtkwGqBuM5uo4mCipvirHqXCpjG0pJzY4Db3GMqAgq"], ["created_at", "2018-11-29 17:40:49.825795"], ["updated_at", "2018-11-29 17:40:49.825795"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$owWrli/0SgWB0OzZVrvc0uqfX1CVjsGOsNvuswvPx/4E3hlP5yI2u"], ["created_at", "2018-11-29 17:40:49.832610"], ["updated_at", "2018-11-29 17:40:49.832610"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:40:49.835715"], ["updated_at", "2018-11-29 17:40:49.835715"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.3ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (1.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:40:49.844394"], ["updated_at", "2018-11-29 17:40:49.844394"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:40:49 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (8.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$kr/66VeW.a/qsV9udDxrMOK1KQ4dCnSoJdL/o5LDxiCiQPetO/cB."], ["created_at", "2018-11-29 17:40:49.861620"], ["updated_at", "2018-11-29 17:40:49.861620"], ["username", "person13"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$4sPMQkLeSPd/fLDGPvotFeZqQ9IMZYaKY/VZB1REnDd0IWNS10q.."], ["created_at", "2018-11-29 17:40:49.884160"], ["updated_at", "2018-11-29 17:40:49.884160"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:40:49.888594"], ["updated_at", "2018-11-29 17:40:49.888594"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 18:40:49 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:40:49.905031"], ["updated_at", "2018-11-29 17:40:49.905031"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (6.2ms)
  Rendered comments/_comment.json.jbuilder (6.5ms)
  Rendered comments/create.json.jbuilder (7.1ms)
Completed 200 OK in 14ms (Views: 6.9ms | ActiveRecord: 1.1ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$VzH/7dYzR6MjfzdN2ftwZeaUOhsV/.FDN2anf8cR0g3KEDpWqy3ba"], ["created_at", "2018-11-29 17:40:49.923036"], ["updated_at", "2018-11-29 17:40:49.923036"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person16@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person16"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person16@example.com"], ["encrypted_password", "$2a$04$aUhfnpVekw5/x9OTkyFZC.aS/Sh8W.gpa3S1TX6FWTHn2egsXxPme"], ["created_at", "2018-11-29 17:40:49.930361"], ["updated_at", "2018-11-29 17:40:49.930361"], ["username", "person16"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 17:40:49.933026"], ["updated_at", "2018-11-29 17:40:49.933026"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 17:40:49.936553"], ["updated_at", "2018-11-29 17:40:49.936553"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 18:40:49 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.3ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 0.7ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$ZYV3KztJNUqif6XIOCSp.O5Evgkezs1hCXIHJgxVDYsQS1/97AaMi"], ["created_at", "2018-11-29 19:14:47.932575"], ["updated_at", "2018-11-29 19:14:47.932575"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$TJhsXz.B.hmFdbHc8jep4uSzFbg/Q7f5/u6cV12e5b9EOzddz1PXi"], ["created_at", "2018-11-29 19:14:47.999374"], ["updated_at", "2018-11-29 19:14:47.999374"], ["username", "person2"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.1ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 19:14:48.003876"], ["updated_at", "2018-11-29 19:14:48.003876"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.4ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$BLMEY5QYQOaHbiNLvTTzdukocdu8LjYsgpO0skanzgiWZ7z3eZ0IO"], ["created_at", "2018-11-29 19:14:48.039292"], ["updated_at", "2018-11-29 19:14:48.039292"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_invalid_captcha
-------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$8oO1qNtnShDmdOig5B7Qh.1FERdvTN7ZDAOg0L.ifXHvCBi7jitfC"], ["created_at", "2018-11-29 19:14:48.277990"], ["updated_at", "2018-11-29 19:14:48.277990"], ["username", "person4"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 19:14:48.280244"], ["updated_at", "2018-11-29 19:14:48.280244"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 20:14:48 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"2"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Unpermitted parameter: :body
Completed 403 Forbidden in 7ms (Views: 0.4ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$UOkUq58tz41jdslt88R37eEOdxoo7Chm4UBaZ/qqaHb9gb1kaBkCW"], ["created_at", "2018-11-29 19:14:48.385679"], ["updated_at", "2018-11-29 19:14:48.385679"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$baifm7k.sEpJdnCEXdfiyOMOkZmCVt5PuWjY9q7DjCkfMbNz1s2MO"], ["created_at", "2018-11-29 19:14:48.391646"], ["updated_at", "2018-11-29 19:14:48.391646"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 19:14:48.393838"], ["updated_at", "2018-11-29 19:14:48.393838"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (1.0ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 19:14:48.396388"], ["updated_at", "2018-11-29 19:14:48.396388"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 20:14:48 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.5ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 1.1ms | ActiveRecord: 1.1ms)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$V8sEO2YpQxCv.H03gcfoNOllKppHaLhUVWCnfkmMO9SKr4EaB1Djq"], ["created_at", "2018-11-29 19:14:48.423728"], ["updated_at", "2018-11-29 19:14:48.423728"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 19:14:48.427826"], ["updated_at", "2018-11-29 19:14:48.427826"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$nS1UNAbylFraxMgfBx7rBe9/xhHTrm4FF6zlKgbleX1jlDZlSugJW"], ["created_at", "2018-11-29 19:14:48.432984"], ["updated_at", "2018-11-29 19:14:48.432984"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 19:14:48.434424"], ["updated_at", "2018-11-29 19:14:48.434424"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 20:14:48 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.6ms)
  Rendered comments/_comment.json.jbuilder (4.3ms)
  Rendered comments/index.json.jbuilder (11.5ms)
Completed 200 OK in 26ms (Views: 16.8ms | ActiveRecord: 0.5ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$u5ZpA09TkbAOupvvDdY63ONd5fDqyO93/CeTc/SrmaZnHwJJr4XNC"], ["created_at", "2018-11-29 19:14:48.471780"], ["updated_at", "2018-11-29 19:14:48.471780"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-29 19:14:48.475502"], ["updated_at", "2018-11-29 19:14:48.475502"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 20:14:48 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Unpermitted parameter: :body
Unpermitted parameters: :captcha_key, :captcha_answer
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["body", "My comment"], ["article_id", 1], ["created_at", "2018-11-29 19:14:48.481484"], ["updated_at", "2018-11-29 19:14:48.481484"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  Rendered comments/_comment.json.jbuilder (0.5ms)
  Rendered comments/create.json.jbuilder (2.1ms)
Completed 200 OK in 8ms (Views: 2.5ms | ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$rn92ZocA.p/JBTJGB6WFYustimzQGxb5Xq10iSh9Yw2wfyY8HjllK"], ["created_at", "2018-11-29 19:14:48.502546"], ["updated_at", "2018-11-29 19:14:48.502546"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$WDPpQrIx0PLAymxZV3dbtOLh6ZRiSrFd4zXrOJKqT2EyAOUMiQ8Fq"], ["created_at", "2018-11-29 19:14:48.508024"], ["updated_at", "2018-11-29 19:14:48.508024"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 19:14:48.510059"], ["updated_at", "2018-11-29 19:14:48.510059"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 19:14:48.512455"], ["updated_at", "2018-11-29 19:14:48.512455"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 20:14:48 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (1.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$t4MzslaBZK6Tk2KANhLRe.fsuzxth5kRtK5jmqPJzXNszudkxn8i."], ["created_at", "2018-11-29 19:14:48.526880"], ["updated_at", "2018-11-29 19:14:48.526880"], ["username", "person12"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$4UvDlwJZZkW5sPiltXodGu1iAkbfgCHg.M5lsNwr8uoypz2D9i0g."], ["created_at", "2018-11-29 19:14:48.537490"], ["updated_at", "2018-11-29 19:14:48.537490"], ["username", "person13"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.0ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-29 19:14:48.544978"], ["updated_at", "2018-11-29 19:14:48.544978"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-29 20:14:48 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-29 19:14:48.557215"], ["updated_at", "2018-11-29 19:14:48.557215"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (6.9ms)
  Rendered comments/_comment.json.jbuilder (7.3ms)
  Rendered comments/create.json.jbuilder (7.7ms)
Completed 200 OK in 14ms (Views: 7.3ms | ActiveRecord: 1.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$o5Jj1W/IwnN/vcwGRRYY5u5y4RjhRx7ks9CjSL.zLTcELHMhgj9We"], ["created_at", "2018-11-29 19:14:48.575354"], ["updated_at", "2018-11-29 19:14:48.575354"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$bKr1pgy7YW7Q4g1zgYbYWeqX3G3mfD.c/enoK9qy8vIHc.CP0ZpMK"], ["created_at", "2018-11-29 19:14:48.580819"], ["updated_at", "2018-11-29 19:14:48.580819"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person16@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person16"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person16@example.com"], ["encrypted_password", "$2a$04$.sdK0qOFIiG/gy1yTibYZOVi7xldWIBZetow6wgowV16RFNRJ5ILK"], ["created_at", "2018-11-29 19:14:48.585254"], ["updated_at", "2018-11-29 19:14:48.585254"], ["username", "person16"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-29 19:14:48.587699"], ["updated_at", "2018-11-29 19:14:48.587699"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-29 19:14:48.596678"], ["updated_at", "2018-11-29 19:14:48.596678"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-29 20:14:48 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 2ms (Views: 0.3ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (1.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$TIWIW/kkio8QimMCaTKpee4EK7t5PKc1yRdgsTe0Decg/4ihako7C"], ["created_at", "2018-11-30 16:04:41.532752"], ["updated_at", "2018-11-30 16:04:41.532752"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$S7gyDWtyzt9gmk7oY/tQzu/yJmEVBglu5t6WV.KaMmJ2xt11VwQI."], ["created_at", "2018-11-30 16:04:41.595949"], ["updated_at", "2018-11-30 16:04:41.595949"], ["username", "person2"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.1ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-30 16:04:41.611494"], ["updated_at", "2018-11-30 16:04:41.611494"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.5ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$dh6RsEAe9wvW3NPOZWBv6.G2k6JOtQ5JNA5k.U3lsfX/MP/7H9Pju"], ["created_at", "2018-11-30 16:04:41.643406"], ["updated_at", "2018-11-30 16:04:41.643406"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$46HI4VUC3xnkbZJ.VXZoO.i5mrm.j.OM7.4iTD3HXNPCVOGC1AY9i"], ["created_at", "2018-11-30 16:04:41.861124"], ["updated_at", "2018-11-30 16:04:41.861124"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-30 16:04:41.865259"], ["updated_at", "2018-11-30 16:04:41.865259"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-30 17:04:41 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Unpermitted parameter: :body
Unpermitted parameters: :captcha_key, :captcha_answer
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.9ms)[0m  [1m[32mINSERT INTO "comments" ("body", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["body", "My comment"], ["article_id", 1], ["created_at", "2018-11-30 16:04:41.991225"], ["updated_at", "2018-11-30 16:04:41.991225"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  Rendered comments/_comment.json.jbuilder (0.6ms)
  Rendered comments/create.json.jbuilder (6.6ms)
Completed 200 OK in 25ms (Views: 11.4ms | ActiveRecord: 1.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$GKbVBAt3YuhU3J8gTME11.9B7hyTtMu5ICG253cIznVIJPEAFHxlK"], ["created_at", "2018-11-30 16:04:42.021875"], ["updated_at", "2018-11-30 16:04:42.021875"], ["username", "person5"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$b5ZCitH6e9h7dCNYZ9g/OeaK6zz3YVLIHeeSbT1plrEQ4xpybiCky"], ["created_at", "2018-11-30 16:04:42.028244"], ["updated_at", "2018-11-30 16:04:42.028244"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.6ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-30 16:04:42.034128"], ["updated_at", "2018-11-30 16:04:42.034128"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-30 17:04:42 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-30 16:04:42.049488"], ["updated_at", "2018-11-30 16:04:42.049488"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (7.7ms)
  Rendered comments/_comment.json.jbuilder (9.3ms)
  Rendered comments/create.json.jbuilder (9.8ms)
Completed 200 OK in 16ms (Views: 9.3ms | ActiveRecord: 1.4ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_invalid_captcha
-------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$oaEHWXWlP83s.VPkK7ao5Obq6bnAMGAVKo6dBn8S8weyAHUZ5TVLa"], ["created_at", "2018-11-30 16:04:42.070334"], ["updated_at", "2018-11-30 16:04:42.070334"], ["username", "person7"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-30 16:04:42.073890"], ["updated_at", "2018-11-30 16:04:42.073890"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-30 17:04:42 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"2"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Unpermitted parameter: :body
Completed 403 Forbidden in 1ms (Views: 0.2ms | ActiveRecord: 0.2ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$t0qE6Ypj.tbNMaZ2JesfwOTMMp8Y.CgqjrHgX/CyJu5cXa5SASS9S"], ["created_at", "2018-11-30 16:04:42.096591"], ["updated_at", "2018-11-30 16:04:42.096591"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$BdN9Z1YmqAoB2ZFSPdUc2.sgMcXmQjKTr316FpEsr6OP3FdGIlCm."], ["created_at", "2018-11-30 16:04:42.101664"], ["updated_at", "2018-11-30 16:04:42.101664"], ["username", "person9"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$R2NusEF7J/hrmEhC7k4HJuH3PKWXOdfGdSPsymb/Joj8S58U.IUgu"], ["created_at", "2018-11-30 16:04:42.105748"], ["updated_at", "2018-11-30 16:04:42.105748"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.9ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-30 16:04:42.107920"], ["updated_at", "2018-11-30 16:04:42.107920"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (1.1ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-30 16:04:42.115286"], ["updated_at", "2018-11-30 16:04:42.115286"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-30 17:04:42 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 2ms (Views: 0.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (1.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$rg0daPlBbE4qnHjEmXc6NefAhDbLEzAELndtIIIpGX4POUPeTPzEe"], ["created_at", "2018-11-30 16:04:42.138454"], ["updated_at", "2018-11-30 16:04:42.138454"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$zoiOaYv0GWfM8kDPYeP5YOW9x8vzWCOaxF/TYdgLjC/DUriwqIGsW"], ["created_at", "2018-11-30 16:04:42.144593"], ["updated_at", "2018-11-30 16:04:42.144593"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (1.5ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-30 16:04:42.149011"], ["updated_at", "2018-11-30 16:04:42.149011"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-30 16:04:42.157031"], ["updated_at", "2018-11-30 16:04:42.157031"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-30 17:04:42 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$MH56dcxcSipJRrt8w4.ScO2HmdyrSkyYSP09b5x59PRsLT8m8fkQ."], ["created_at", "2018-11-30 16:04:42.171233"], ["updated_at", "2018-11-30 16:04:42.171233"], ["username", "person13"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$OFoVaeovC7XujC.QJvHL/uC5eF/jB5/xFVxsPJZgwdRyxV1ainCJ2"], ["created_at", "2018-11-30 16:04:42.177308"], ["updated_at", "2018-11-30 16:04:42.177308"], ["username", "person14"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.5ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-30 16:04:42.180188"], ["updated_at", "2018-11-30 16:04:42.180188"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.4ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-30 16:04:42.190122"], ["updated_at", "2018-11-30 16:04:42.190122"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-30 17:04:42 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$XBYXJdlX91er5A9JpZ7mE.0dU27gJeoLT.Dsgq1/a7m2k.7SZKaYe"], ["created_at", "2018-11-30 16:04:42.207819"], ["updated_at", "2018-11-30 16:04:42.207819"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-30 16:04:42.211267"], ["updated_at", "2018-11-30 16:04:42.211267"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person16@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person16"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person16@example.com"], ["encrypted_password", "$2a$04$q93BlBp7uiIjubDt1WJf/ujRyijm1peMnt8xbdeREa3YuEQsinYUK"], ["created_at", "2018-11-30 16:04:42.223081"], ["updated_at", "2018-11-30 16:04:42.223081"], ["username", "person16"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-30 16:04:42.225440"], ["updated_at", "2018-11-30 16:04:42.225440"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-30 17:04:42 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.1ms)
  Rendered comments/_comment.json.jbuilder (1.9ms)
  Rendered comments/index.json.jbuilder (4.3ms)
Completed 200 OK in 8ms (Views: 4.4ms | ActiveRecord: 0.3ms)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_authorized_user
-----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person1"], ["LIMIT", 1]]
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person1@example.com"], ["encrypted_password", "$2a$04$Gv6XroMSVwnqF004ibTPheEM2xn2qUywTwdmXD/dFo/3kgR1rjG8S"], ["created_at", "2018-11-30 16:40:53.575462"], ["updated_at", "2018-11-30 16:40:53.575462"], ["username", "person1"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person2"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person2@example.com"], ["encrypted_password", "$2a$04$ljO2fwaCjudQDLO4d1Zr9.QtzoTjmN7iOw76l5QHRv7IOyYHFEXdy"], ["created_at", "2018-11-30 16:40:53.618373"], ["updated_at", "2018-11-30 16:40:53.618373"], ["username", "person2"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.9ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-30 16:40:53.629764"], ["updated_at", "2018-11-30 16:40:53.629764"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.5ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-30 17:40:53 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (1.0ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "My comment"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-30 16:40:53.813272"], ["updated_at", "2018-11-30 16:40:53.813272"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "follows" WHERE "follows"."blocked" = ? AND "follows"."follower_id" = ? AND "follows"."follower_type" = ? AND "follows"."followable_id" = ? AND "follows"."followable_type" = ?[0m  [["blocked", 0], ["follower_id", 1], ["follower_type", "ApplicationRecord"], ["followable_id", 1], ["followable_type", "ApplicationRecord"]]
  Rendered profiles/_profile.json.jbuilder (7.3ms)
  Rendered comments/_comment.json.jbuilder (9.9ms)
  Rendered comments/create.json.jbuilder (16.0ms)
Completed 200 OK in 59ms (Views: 19.8ms | ActiveRecord: 2.7ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."user_id" = ?[0m  [["user_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_own_comment_succeeds_for_authorized_user
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person3@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person3"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person3@example.com"], ["encrypted_password", "$2a$04$UgA9qfkSApmsEeQy8ZBDiuN9stx30SxKKhw1U4xgTai6bqkYm/Fs."], ["created_at", "2018-11-30 16:40:53.849830"], ["updated_at", "2018-11-30 16:40:53.849830"], ["username", "person3"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person4@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person4"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person4@example.com"], ["encrypted_password", "$2a$04$0VwiTIaWGQSH1VvjEnoABul7jgNR0kyMcJUtbLYazav0tArHdJjfO"], ["created_at", "2018-11-30 16:40:53.854993"], ["updated_at", "2018-11-30 16:40:53.854993"], ["username", "person4"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-30 16:40:53.858268"], ["updated_at", "2018-11-30 16:40:53.858268"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.2ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-30 16:40:53.863521"], ["updated_at", "2018-11-30 16:40:53.863521"]]
  [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-30 17:40:53 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.3ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.3ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Destroy (0.3ms)[0m  [1m[31mDELETE FROM "comments" WHERE "comments"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.1ms | ActiveRecord: 1.2ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_invalid_captcha
-------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person5"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person5@example.com"], ["encrypted_password", "$2a$04$C7dcPJpgQDpTIPC9EsvBl.ACwJ.kEqsXdtNJAOot6Vk4S5FKMlpe6"], ["created_at", "2018-11-30 16:40:53.883453"], ["updated_at", "2018-11-30 16:40:53.883453"], ["username", "person5"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-30 16:40:53.885908"], ["updated_at", "2018-11-30 16:40:53.885908"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-30 17:40:53 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"2"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Unpermitted parameter: :body
Completed 403 Forbidden in 1ms (Views: 0.2ms | ActiveRecord: 0.2ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------------------------------
CommentsControllerTest: test_creating_new_comment_succeeds_as_anonymous_user_with_valid_captcha
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person6"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person6@example.com"], ["encrypted_password", "$2a$04$OY3qYohqL142l8Ai/ITze.eQIHbAvPm5YDRc7sS31dk.zFE.84gQe"], ["created_at", "2018-11-30 16:40:53.898922"], ["updated_at", "2018-11-30 16:40:53.898922"], ["username", "person6"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-30 16:40:53.903208"], ["updated_at", "2018-11-30 16:40:53.903208"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started POST "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-30 17:40:53 +0100
Processing by CommentsController#create as JSON
  Parameters: {"comment"=>{"body"=>"My comment", "captcha_key"=>"1", "captcha_answer"=>"red"}, "article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
Unpermitted parameter: :body
Unpermitted parameters: :captcha_key, :captcha_answer
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["body", "My comment"], ["article_id", 1], ["created_at", "2018-11-30 16:40:53.910641"], ["updated_at", "2018-11-30 16:40:53.910641"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering comments/create.json.jbuilder
  Rendered comments/_comment.json.jbuilder (0.1ms)
  Rendered comments/create.json.jbuilder (0.5ms)
Completed 200 OK in 4ms (Views: 0.9ms | ActiveRecord: 0.5ms)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------------
CommentsControllerTest: test_getting_comments_of_article
--------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person7"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person7@example.com"], ["encrypted_password", "$2a$04$udFvzby/KF4tBvf5PITj.eAKnMvUYQdlAbd/cWn0mJiDHiIXO1iva"], ["created_at", "2018-11-30 16:40:53.919863"], ["updated_at", "2018-11-30 16:40:53.919863"], ["username", "person7"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.4ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-30 16:40:53.927413"], ["updated_at", "2018-11-30 16:40:53.927413"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.1ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person8"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person8@example.com"], ["encrypted_password", "$2a$04$5wXfkMNZawKNtvtCGVBOa.OjG/lkyGoLEHf1PCCX8D9AHSFByU6JO"], ["created_at", "2018-11-30 16:40:53.934474"], ["updated_at", "2018-11-30 16:40:53.934474"], ["username", "person8"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.5ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some comment"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-30 16:40:53.936332"], ["updated_at", "2018-11-30 16:40:53.936332"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/articles/some-slug/comments" for 127.0.0.1 at 2018-11-30 17:40:53 +0100
Processing by CommentsController#index as JSON
  Parameters: {"article_slug"=>"some-slug"}
  [1m[36mArticle Load (0.1ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  Rendering comments/index.json.jbuilder
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."article_id" = ? ORDER BY "comments"."created_at" DESC[0m  [["article_id", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered profiles/_profile.json.jbuilder (0.1ms)
  Rendered comments/_comment.json.jbuilder (1.8ms)
  Rendered comments/index.json.jbuilder (4.3ms)
Completed 200 OK in 10ms (Views: 4.6ms | ActiveRecord: 0.3ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------------------------
CommentsControllerTest: test_deleting_other_user's_comment_is_forbidden_as_authorized_user
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person9"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person9@example.com"], ["encrypted_password", "$2a$04$wP6mAHdrHrLQdjKS6D78TedKUhInSNpn.4tBiuCoujWPLyWPS/6KS"], ["created_at", "2018-11-30 16:40:53.955334"], ["updated_at", "2018-11-30 16:40:53.955334"], ["username", "person9"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person10"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person10@example.com"], ["encrypted_password", "$2a$04$1zHnbO3lTAuV0iEiN2cEbuxtSOvC4yZ.s3L0T8DXR68wV54jPEBHW"], ["created_at", "2018-11-30 16:40:53.960863"], ["updated_at", "2018-11-30 16:40:53.960863"], ["username", "person10"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person11"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person11@example.com"], ["encrypted_password", "$2a$04$6ViIql/qLqqXsHED12MT9epvC7/h..yUEdXEJjkfW7HaoGqFak34K"], ["created_at", "2018-11-30 16:40:53.967067"], ["updated_at", "2018-11-30 16:40:53.967067"], ["username", "person11"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.3ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 3], ["created_at", "2018-11-30 16:40:53.969438"], ["updated_at", "2018-11-30 16:40:53.969438"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.3ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 2], ["article_id", 1], ["created_at", "2018-11-30 16:40:53.974448"], ["updated_at", "2018-11-30 16:40:53.974448"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-30 17:40:53 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
  [1m[36mArticle Load (0.2ms)[0m  [1m[34mSELECT  "articles".* FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT  "comments".* FROM "comments" WHERE "comments"."article_id" = ? AND "comments"."id" = ? LIMIT ?[0m  [["article_id", 1], ["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 2ms (Views: 0.1ms | ActiveRecord: 0.4ms)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
CommentsControllerTest: test_deleting_comments_requires_authorization
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person12"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person12@example.com"], ["encrypted_password", "$2a$04$uaqpoNissSu5Nh0W/SJWnO0WupMaLFb.HBeVoOyYXNWPwOmJm9Fv."], ["created_at", "2018-11-30 16:40:53.986870"], ["updated_at", "2018-11-30 16:40:53.986870"], ["username", "person12"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person13@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person13"], ["LIMIT", 1]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person13@example.com"], ["encrypted_password", "$2a$04$EyfsicJmdncBmuxYLfIwk.dwpzDeaqIGiMn87m7a8rxngnZEhUuqm"], ["created_at", "2018-11-30 16:40:53.991580"], ["updated_at", "2018-11-30 16:40:53.991580"], ["username", "person13"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "some-slug"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "some-slug"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 2], ["created_at", "2018-11-30 16:40:53.994570"], ["updated_at", "2018-11-30 16:40:53.994570"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mComment Create (0.2ms)[0m  [1m[32mINSERT INTO "comments" ("body", "user_id", "article_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Some text"], ["user_id", 1], ["article_id", 1], ["created_at", "2018-11-30 16:40:53.997231"], ["updated_at", "2018-11-30 16:40:53.997231"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
Started DELETE "/api/articles/some-slug/comments/1" for 127.0.0.1 at 2018-11-30 17:40:53 +0100
Processing by CommentsController#destroy as JSON
  Parameters: {"article_slug"=>"some-slug", "id"=>"1"}
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "comments" WHERE "comments"."article_id" = ?[0m  [["article_id", 1]]
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
CommentTest: test_is_invalid_if_article_is_blank
------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person14@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person14"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person14@example.com"], ["encrypted_password", "$2a$04$MXLQ1G3EjVRrfgEXguqK/ewkXlqETHqwXmoyhUyOC.Rz0Pwv8OCuq"], ["created_at", "2018-11-30 16:40:54.011326"], ["updated_at", "2018-11-30 16:40:54.011326"], ["username", "person14"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
CommentTest: test_allows_user_to_be_blank
-----------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person15"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person15@example.com"], ["encrypted_password", "$2a$04$0/XeGG8kEWig8yqCj8pRHeP0ENI/5Zq4MfyECB11MwgaRNDisOpVC"], ["created_at", "2018-11-30 16:40:54.032890"], ["updated_at", "2018-11-30 16:40:54.032890"], ["username", "person15"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mArticle Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "articles" WHERE "articles"."slug" = ? LIMIT ?[0m  [["slug", "slug-1"], ["LIMIT", 1]]
  [1m[36mArticle Create (0.2ms)[0m  [1m[32mINSERT INTO "articles" ("title", "slug", "body", "description", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["title", "Some Article"], ["slug", "slug-1"], ["body", "This is the text of the article"], ["description", "This is the description of the article"], ["user_id", 1], ["created_at", "2018-11-30 16:40:54.036186"], ["updated_at", "2018-11-30 16:40:54.036186"]]
  [1m[36mActsAsTaggableOn::Tagging Load (0.0ms)[0m  [1m[34mSELECT "taggings".* FROM "taggings" WHERE "taggings"."taggable_id" = ? AND "taggings"."taggable_type" = ?[0m  [["taggable_id", 1], ["taggable_type", "Article"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
CommentTest: test_is_invalid_if_body_is_blank
---------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "person16@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."username" = ? LIMIT ?[0m  [["username", "person16"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "username") VALUES (?, ?, ?, ?, ?)[0m  [["email", "person16@example.com"], ["encrypted_password", "$2a$04$ew92rJsa4MxlEWmoNkcg/OakV0fWBvG2KIHPrWaby33bZa9BqNLOO"], ["created_at", "2018-11-30 16:40:54.048217"], ["updated_at", "2018-11-30 16:40:54.048217"], ["username", "person16"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------
TextCaptchaTest: test_#get_returns_question_and_key
---------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_answer
-------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_true_for_correct_answer_and_key
----------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
TextCaptchaTest: test_#valid_answer?_returns_false_for_wrong_key
----------------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
